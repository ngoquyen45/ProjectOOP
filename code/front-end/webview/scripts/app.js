(function(){"use strict";angular.module("app",["ui.router","ngAnimate","ngResource","ui.bootstrap","easypiechart","mgo-angular-wizard","textAngular","ui.tree","ngMap","ngTagsInput","pascalprecht.translate","fcsa-number","ui.select","angular-confirm","ngIdle","app.config","app.state","app.token","app.toast","app.filter","app.push","app.directives","app.directives.file.image"]).config(["$tokenProvider","$translateProvider","$provide","ADDRESS_BACKEND","ADDRESS_OAUTH",function($tokenProvider,$translateProvider,$provide,ADDRESS_BACKEND,ADDRESS_OAUTH,DEFAULT_LANGUAGE){var defaultParams;return defaultParams={client_id:"dmsplus",authorizationEndpoint:ADDRESS_OAUTH+"oauth/authorize",scope:"read",revokeTokenEndpoint:ADDRESS_OAUTH+"oauth/revoke",verifyTokenEndpoint:ADDRESS_OAUTH+"oauth/userinfo",changePasswordEndpoint:ADDRESS_OAUTH+"oauth/password",logoutUrl:ADDRESS_OAUTH+"account/logout",refresh:!0,is_no_auth_page:function(toState){return 500===toState}},$tokenProvider.extendConfig(defaultParams),$translateProvider.preferredLanguage(DEFAULT_LANGUAGE),$translateProvider.useStaticFilesLoader({prefix:"i18n/",suffix:".json"}),$provide.decorator("fileImageChooserConfig",["$token","ADDRESS_BACKEND",function($token,ADDRESS_BACKEND){return{getBaseUrl:function(){return ADDRESS_BACKEND},getAccessToken:function(){return $token.getAccessToken()}}}])}]).config(["KeepaliveProvider","IdleProvider","NG_IDLE_MAX_IDLE_TIME","NG_IDLE_TIMEOUT","NG_IDLE_PING_INTEVAL",function(KeepaliveProvider,IdleProvider,NG_IDLE_MAX_IDLE_TIME,NG_IDLE_TIMEOUT,NG_IDLE_PING_INTEVAL){return IdleProvider.idle(NG_IDLE_MAX_IDLE_TIME),IdleProvider.timeout(NG_IDLE_TIMEOUT),KeepaliveProvider.interval(NG_IDLE_PING_INTEVAL)}]).config(["$compileProvider",function($compileProvider){$compileProvider.debugInfoEnabled(!1)}]).run(["$rootScope","$token","$translate","DEFAULT_LANGUAGE","Idle",function($rootScope,$token,$translate,DEFAULT_LANGUAGE,Idle){var lang;return $rootScope.tokenVerified=!1,lang=$token.getUserLanguage(),null!=lang?$translate.use(lang):$translate.use(DEFAULT_LANGUAGE),$rootScope.$on("TokenVerified",function(){return $translate.use($token.getUserLanguage())}),Idle.watch()}])}).call(this),function(){"use strict";angular.module("app.directives",[]).directive("customBackground",function(){return{restrict:"A",controller:["$scope","$element","$location",function($scope,$element,$location){var addBg,path;return path=function(){return $location.path()},addBg=function(path){switch($element.removeClass("body-home body-special body-tasks body-lock"),path){case"/":return $element.addClass("body-home");case"/404":case"/500":case"/550":case"/pages/signin":case"/pages/signup":case"/pages/forgot":return $element.addClass("body-special");case"/pages/lock-screen":return $element.addClass("body-special body-lock");case"/tasks":return $element.addClass("body-tasks")}},addBg($location.path()),$scope.$watch(path,function(newVal,oldVal){return newVal!==oldVal?addBg($location.path()):void 0})}]}}).directive("uiColorSwitch",[function(){return{restrict:"A",link:function(scope,ele){return ele.find(".color-option").on("click",function(event){var $this,hrefUrl,style;if($this=$(this),hrefUrl=void 0,style=$this.data("style"),"loulou"===style)hrefUrl="styles/main.css",$('link[href^="styles/main"]').attr("href",hrefUrl);else{if(!style)return!1;style="-"+style,hrefUrl="styles/main"+style+".css",$('link[href^="styles/main"]').attr("href",hrefUrl)}return event.preventDefault()})}}}]).directive("toggleMinNav",["$rootScope",function($rootScope){return{restrict:"A",link:function(scope,ele){var $window,app,updateClass;return app=$("#app"),$window=$(window),ele.on("click",function(e){return app.hasClass("nav-min")?app.removeClass("nav-min"):(app.addClass("nav-min"),$rootScope.$broadcast("minNav:enabled")),e.preventDefault()}),updateClass=function(){var width;return width=$window.width(),768>width?app.removeClass("nav-min"):992>width&&!app.hasClass("nav-min")?(app.addClass("nav-min"),$rootScope.$broadcast("minNav:enabled")):void 0},$window.resize(function(){var t;return clearTimeout(t),t=setTimeout(updateClass,300)})}}}]).directive("collapseNav",[function(){return{restrict:"A",link:function(scope,ele){return scope.$on("minNav:enabled",function(){return ele.find("ul").parent("li").removeClass("open").find("ul").slideUp()})}}}]).directive("navMenu",[function(){return{restrict:"A",scope:{navMenu:"="},link:function(scope,ele){var $a,$app,$ele,$ulParent;return $app=$("#app"),$ele=$(ele),$a=$ele.children("a"),$ulParent=$ele.parent("ul"),null!=scope.navMenu&&null!=scope.navMenu.children&&scope.navMenu.children.length>0?$a.on("click",function(event){var $parent,$this;return $app.hasClass("nav-min")?!1:($this=$(this),$parent=$this.parent("li"),$ulParent.find("ul").parent("li").not($parent).removeClass("open").find("ul").slideUp(),$parent.toggleClass("open").find("ul").stop().slideToggle(),event.preventDefault())}):$a.on("click",function(){return $ulParent.find("ul").parent("li").removeClass("open").find("ul").slideUp()})}}}]).directive("toggleOffCanvas",[function(){return{restrict:"A",link:function(scope,ele){return ele.on("click",function(){return $("#app").toggleClass("on-canvas")})}}}]).directive("slimScroll",[function(){return{restrict:"A",link:function(scope,ele,attrs){return ele.slimScroll({height:attrs.scrollHeight||"100%"})}}}]).directive("goBack",[function(){return{restrict:"A",controller:["$scope","$element","$window",function($scope,$element,$window){return $element.on("click",function(){return $window.history.back()})}]}}])}.call(this),function(){"use strict";angular.module("app.directives").controller("ICheckController",["$scope",function($scope){var ngModelCtrl;return ngModelCtrl={$setViewValue:angular.noop},this.init=function(ngModelCtrl_){return ngModelCtrl=ngModelCtrl_},$scope.click=function(){return"undefined"==typeof $attrs||null===$attrs||null==$attrs.disabled?ngModelCtrl.$viewValue?ngModelCtrl.$setViewValue(!1):ngModelCtrl.$setViewValue(!0):void 0},$scope.isChecked=function(){return ngModelCtrl.$viewValue}}]).directive("iCheck",function(){return{restrict:"E",replace:!0,scope:{ngDisabled:"="},require:["iCheck","?ngModel"],templateUrl:"views/directive/i-check.html",controller:"ICheckController",link:function(scope,element,attrs,controllers){var iCheckCtrl,ngModelCtrl;return iCheckCtrl=controllers[0],ngModelCtrl=controllers[1],null!=ngModelCtrl?iCheckCtrl.init(ngModelCtrl):void 0}}})}.call(this),function(){"use strict";angular.module("app.directives").directive("enterPressed",function(){return function(scope,element,attrs){return element.bind("keydown keypress",function(event){return 13===event.which?(scope.$apply(function(){return scope.$eval(attrs.enterPressed)}),event.preventDefault()):void 0})}})}.call(this),function(){"use strict";angular.module("app.directives").controller("SearchBoxController",["$scope","$attrs",function($scope){var lastText,listener,ngModelCtrl;return ngModelCtrl={$setViewValue:angular.noop},lastText=null,this.init=function(ngModelCtrl_){return ngModelCtrl=ngModelCtrl_,$scope.searchText=null},listener=$scope.$watch(ngModelCtrl.$viewValue,function(){return $scope.searchText=ngModelCtrl.$viewValue,lastText=$scope.searchText,listener()}),$scope.textChanged=function(){return!(null!=lastText&&lastText.length>0&&null!=$scope.searchText&&$scope.searchText.length>0&&lastText===$scope.searchText)},$scope.performSearch=function(){return listener(),ngModelCtrl.$setViewValue($scope.searchText),ngModelCtrl.$render(),lastText=$scope.searchText},$scope.clearText=function(){return listener(),lastText="",$scope.searchText="",ngModelCtrl.$setViewValue($scope.searchText),ngModelCtrl.$render()},$scope.onEnter=function(){return $scope.textChanged()?$scope.performSearch():$scope.clearText()},$scope.onBlur=function(){return $scope.textChanged()&&(null!=lastText&&lastText.length>0||null!=$scope.searchText&&$scope.searchText.length>0)?$scope.performSearch():void 0}}]).directive("searchBox",function(){return{restrict:"E",replace:!0,scope:{placeholder:"@",ngDisabled:"="},require:["searchBox","?ngModel"],templateUrl:"views/directive/search-box.html",controller:"SearchBoxController",link:function(scope,element,attrs,controllers){var ngModelCtrl,searchBoxCtrl;return searchBoxCtrl=controllers[0],ngModelCtrl=controllers[1],null!=ngModelCtrl?searchBoxCtrl.init(ngModelCtrl):void 0}}})}.call(this),function(){"use strict";angular.module("app.directives.file.image",["angularFileUpload"]).value("fileImageChooserConfig",{}).controller("SingleFileCtrl",["$scope","$element","$attrs","FileUploader","fileImageChooserConfig",function($scope,$element,$attrs,FileUploader,fileImageChooserConfig){var input,inputs,ngModelCtrl,uploader,url,_i,_input,_len;if(ngModelCtrl={$setViewValue:angular.noop},this.init=function(p_ngModelCtrl){return ngModelCtrl=p_ngModelCtrl},$scope.getFileName=function(){return null!=ngModelCtrl.$viewValue?ngModelCtrl.$viewValue.name:null},inputs=$element.find("input"),input=null,null!=inputs&&inputs.length>0)for(_i=0,_len=inputs.length;_len>_i;_i++)if(_input=inputs[_i],"file"===_input.type){input=$(_input);break}return $scope.getAccepts=function(){return null!=$attrs.accept?$attrs.accept:"*/*"},url=fileImageChooserConfig.getBaseUrl()+"file",uploader=$scope.uploader=new FileUploader({url:url,headers:null}),uploader.onAfterAddingAll=function(addedItems){var item,_j,_len1;for(_j=0,_len1=addedItems.length;_len1>_j;_j++)item=addedItems[_j],item.headers={Authorization:"Bearer "+fileImageChooserConfig.getAccessToken()};return uploader.uploadAll()},uploader.onSuccessItem=function(fileItem,response){var file;return fileItem.id=response.id,file={fileId:fileItem.id,name:fileItem._file.name},ngModelCtrl.$setViewValue(file),ngModelCtrl.$render(),null!=input?input.val(""):void 0}}]).directive("singleFile",function(){return{restrict:"AE",require:["singleFile","?ngModel"],replace:!0,scope:{},templateUrl:"views/directive/single-file.html",controller:"SingleFileCtrl",link:function(scope,element,attrs,ctrls){var SingleFileCtrl,ngModelCtrl;return SingleFileCtrl=ctrls[0],ngModelCtrl=ctrls[1],null!=ngModelCtrl?SingleFileCtrl.init(ngModelCtrl):void 0}}}).controller("SingleImageCtrl",["$scope","$element","$attrs","FileUploader","fileImageChooserConfig","$http",function($scope,$element,$attrs,FileUploader,fileImageChooserConfig,$http){var input,inputs,ngModelCtrl,sizeType,tempFileItem,uploader,url,_i,_input,_len;if(ngModelCtrl={$setViewValue:angular.noop},this.init=function(p_ngModelCtrl){return ngModelCtrl=p_ngModelCtrl},$scope.getFile=function(){return ngModelCtrl.$viewValue},$scope.getLink=function(){var id;return id=$scope.getFile(),null!=id?fileImageChooserConfig.getBaseUrl()+"image/"+id:null},sizeType=null,null!=$attrs.sizeType&&(sizeType=$attrs.sizeType),url=fileImageChooserConfig.getBaseUrl()+"image",null==sizeType||"thumb"!==sizeType&&"medium"!==sizeType&&"standard"!==sizeType||(url=url+"?sizetype="+sizeType),inputs=$element.find("input"),input=null,null!=inputs&&inputs.length>0)for(_i=0,_len=inputs.length;_len>_i;_i++)if(_input=inputs[_i],"file"===_input.type){input=$(_input);break}return tempFileItem=null,uploader=$scope.uploader=new FileUploader({url:url,headers:null}),uploader.onAfterAddingAll=function(addedItems){var item,_j,_len1;for(_j=0,_len1=addedItems.length;_len1>_j;_j++)item=addedItems[_j],item.headers={Authorization:"Bearer "+fileImageChooserConfig.getAccessToken()};return uploader.uploadAll()},uploader.onSuccessItem=function(fileItem,response){return fileItem.id=response.id,ngModelCtrl.$setViewValue(fileItem.id),ngModelCtrl.$render(),tempFileItem=fileItem,null!=input?input.val(""):void 0},$scope.removeFile=function(){var deleteURL;return null!=ngModelCtrl.$viewValue&&(deleteURL=fileImageChooserConfig.getBaseUrl()+"file",NaN+ngModelCtrl.$viewValue,NaN+fileImageChooserConfig.getAccessToken()),$http["delete"](deleteURL).success(),null!=tempFileItem&&tempFileItem.remove(),ngModelCtrl.$setViewValue(null),ngModelCtrl.$render(),null!=input?input.val(""):void 0}}]).directive("singleImage",function(){return{restrict:"AE",require:["singleImage","?ngModel"],replace:!0,scope:{},templateUrl:"views/directive/single-image.html",controller:"SingleImageCtrl",link:function(scope,element,attrs,ctrls){var SingleImageCtrl,ngModelCtrl;return SingleImageCtrl=ctrls[0],ngModelCtrl=ctrls[1],null!=ngModelCtrl?SingleImageCtrl.init(ngModelCtrl):void 0}}})}.call(this),function(){"use strict";angular.module("app.directives").directive("nameCategoryCombobox",[function(){return{restrict:"E",replace:!0,scope:{datas:"=",readonlyName:"=",placeholder:"@"},templateUrl:"views/directive/name-category-combobox.html",require:"ngModel",link:function(scope,element,attrs,ngModelCtrl){return scope.container={},scope.getPlaceholder=function(){return null!=scope.placeholder?"-- "+scope.placeholder+" --":"--"},scope.onSelect=function($item,$model){return ngModelCtrl.$setViewValue($model)},ngModelCtrl.$render=function(){return scope.container.selectedId=ngModelCtrl.$viewValue},scope.getReadonlyName=function(){var data,_i,_len,_ref;if(null!=scope.readonlyName)return scope.readonlyName;if(null!=scope.datas)for(_ref=scope.datas,_i=0,_len=_ref.length;_len>_i;_i++)if(data=_ref[_i],data.id===scope.container.selectedId||null==data.id||!scope.container.selectedId)return data.name;return""}}}}]).directive("nameCodeCategoryCombobox",[function(){return{restrict:"E",replace:!0,scope:{datas:"=",readonlyName:"=",placeholder:"@"},templateUrl:"views/directive/name-code-category-combobox.html",require:"ngModel",link:function(scope,element,attrs,ngModelCtrl){return scope.container={},scope.getPlaceholder=function(){return null!=scope.placeholder?"-- "+scope.placeholder+" --":"--"},scope.onSelect=function($item,$model){return ngModelCtrl.$setViewValue($model)},ngModelCtrl.$render=function(){return scope.container.selectedId=ngModelCtrl.$viewValue},scope.getReadonlyName=function(){var data,_i,_len,_ref;if(null!=scope.readonlyName)return scope.readonlyName;if(null!=scope.datas&&null!=scope.container.selectedId)for(_ref=scope.datas,_i=0,_len=_ref.length;_len>_i;_i++)if(data=_ref[_i],data.id===scope.container.selectedId)return data.name;return""}}}}]).directive("userCombobox",[function(){return{restrict:"E",replace:!0,scope:{datas:"=",readonlyName:"=",placeholder:"@"},templateUrl:"views/directive/user-combobox.html",require:"ngModel",link:function(scope,element,attrs,ngModelCtrl){return scope.container={},scope.getPlaceholder=function(){return null!=scope.placeholder?"-- "+scope.placeholder+" --":"--"},scope.onSelect=function($item,$model){return ngModelCtrl.$setViewValue($model)},ngModelCtrl.$render=function(){return scope.container.selectedId=ngModelCtrl.$viewValue},scope.getReadonlyName=function(){var data,_i,_len,_ref;if(null!=scope.readonlyName)return scope.readonlyName;if(null!=scope.datas&&null!=scope.container.selectedId)for(_ref=scope.datas,_i=0,_len=_ref.length;_len>_i;_i++)if(data=_ref[_i],data.id===scope.container.selectedId)return data.fullname;return""}}}}])}.call(this),function(){"use strict";angular.module("app.directives").directive("basicView",[function(){return{restrict:"E",transclude:!0,templateUrl:"views/directive/basic-view.html"}}]).directive("categoryDetail",[function(){return{restrict:"E",transclude:!0,templateUrl:"views/directive/category-detail.html"}}]).controller("OrderController",["$scope","$filter",function($scope,$filter){return $scope.getDeliveryDisplay=function(){if(null!=$scope.data){if($scope.data.vanSales)return $filter("translate")("van.sales");if(null!=$scope.data.deliveryType){if(0===$scope.data.deliveryType)return $filter("translate")("order.delivery.immediate");if(1===$scope.data.deliveryType)return $filter("translate")("order.delivery.same.day");if(2===$scope.data.deliveryType&&null!=$scope.data.deliveryTime)return $filter("isoDate")($scope.data.deliveryTime)}}},$scope.hasPromotion=function(){return null!=$scope.data&&null!=$scope.data.promotions&&$scope.data.promotions.length>0},$scope.promotionProductRewards=null,$scope.getPromotionProductRewards=function(){var detail,key,promotionProductReward,promotionProductRewardsMap,promotionResult,_i,_j,_len,_len1,_ref,_ref1;if($scope.hasPromotion()){if(null!=$scope.promotionProductRewards)return $scope.promotionProductRewards;for(promotionProductRewardsMap={},_ref=$scope.data.promotions,_i=0,_len=_ref.length;_len>_i;_i++)if(promotionResult=_ref[_i],null!=promotionResult&&null!=promotionResult.details&&promotionResult.details.length>0)for(_ref1=promotionResult.details,_j=0,_len1=_ref1.length;_len1>_j;_j++)detail=_ref1[_j],null!=detail&&null!=detail.reward&&null!=detail.reward.product&&null!=detail.reward.quantity&&(promotionProductReward=promotionProductRewardsMap[_.camelCase(detail.reward.product.name)],null!=promotionProductReward?promotionProductReward.quantity=promotionProductReward.quantity+detail.reward.quantity:promotionProductRewardsMap[_.camelCase(detail.reward.product.name)]=angular.copy(detail.reward));$scope.promotionProductRewards=[];for(key in promotionProductRewardsMap)$scope.promotionProductRewards.push(promotionProductRewardsMap[key]);return $scope.promotionProductRewards}}}]).directive("order",[function(){return{restrict:"E",scope:{data:"="},templateUrl:"views/directive/order.html",controller:"OrderController"}}])}.call(this),function(){this.staticOnMapReady=function($scope,callback){return $scope.$on("mapInitialized",function(event,map){return jQuery.isFunction(callback)?callback(new MyMap(map)):void 0})},this.staticAddMarkerToMap=function(myMap,myMarker){return null!=myMap&&null!=myMarker?myMarker.getObject().setMap(myMap.getObject()):void 0},this.staticClearMarkers=function(myMap,myMarkers){var myMarker,_i,_len,_results;if(null!=myMarkers){if(Array.isArray(myMarkers)){for(_results=[],_i=0,_len=myMarkers.length;_len>_i;_i++)myMarker=myMarkers[_i],_results.push(myMarker.getObject().setMap(null));return _results}return myMarkers.getObject().setMap(null)}},this.MyMap=function(){function MyMap(map){this.map=map}return MyMap.prototype.setCenter=function(myLatLng){return this.map.setCenter(myLatLng.getObject())},MyMap.prototype.panTo=function(myLatLng){return this.map.panTo(myLatLng.getObject())},MyMap.prototype.setZoom=function(zoom){return this.map.setZoom(zoom)},MyMap.prototype.fitBounds=function(myLatLngBounds){return this.map.fitBounds(myLatLngBounds.getObject())},MyMap.prototype.addDoubleClickListener=function(callback){return this.map.addListener("dblclick",function(event){var lat,lng;return lat=event.latLng.lat(),lng=event.latLng.lng(),jQuery.isFunction(callback)?callback(new MyLatLng(lat,lng)):void 0})},MyMap.prototype.getObject=function(){return this.map},MyMap}(),this.MyMarker=function(){function MyMarker(title){this.marker=new google.maps.Marker({title:title}),this.marker.setAnimation(google.maps.Animation.DROP)}return MyMarker.prototype.getPosition=function(){return new MyLatLng(this.marker.getPosition().lat(),this.marker.getPosition().lng())},MyMarker.prototype.setPosition=function(myLatLng){return this.marker.setPosition(myLatLng.getObject())},MyMarker.prototype.setIcon=function(icon){return this.marker.setIcon(icon)},MyMarker.prototype.setDraggable=function(draggable){return this.marker.setDraggable(draggable)},MyMarker.prototype.addClickListener=function(callback){return this.marker.addListener("click",function(event){var lat,lng;return lat=event.latLng.lat(),lng=event.latLng.lng(),jQuery.isFunction(callback)?callback(new MyLatLng(lat,lng)):void 0})},MyMarker.prototype.addDragEndListener=function(callback){return this.marker.addListener("dragend",function(){return jQuery.isFunction(callback)?callback():void 0})},MyMarker.prototype.getObject=function(){return this.marker},MyMarker}(),this.MyLatLng=function(){function MyLatLng(latitude,longitude){this.latitude=latitude,this.longitude=longitude,this.latLng=new google.maps.LatLng(this.latitude,this.longitude)}return MyLatLng.prototype.lat=function(){return this.latitude},MyLatLng.prototype.lng=function(){return this.longitude},MyLatLng.prototype.getObject=function(){return this.latLng},MyLatLng}(),this.MyLatLngBounds=function(){function MyLatLngBounds(){this.LatLngBounds=new google.maps.LatLngBounds}return MyLatLngBounds.prototype.extend=function(myLatLng){return this.LatLngBounds.extend(myLatLng.getObject())},MyLatLngBounds.prototype.getObject=function(){return this.LatLngBounds},MyLatLngBounds}(),this.MyInfoWindow=function(){function MyInfoWindow(){this.infoWindow=new google.maps.InfoWindow}return MyInfoWindow.prototype.setContent=function(content){return this.infoWindow.setContent(content)},MyInfoWindow.prototype.open=function(myMap,myLatLng){return this.infoWindow.setPosition(myLatLng.getObject()),this.infoWindow.open(myMap.getObject())},MyInfoWindow.prototype.close=function(){return this.infoWindow.close()},MyInfoWindow}(),angular.module("app").run(["$templateCache",function($templateCache){return $templateCache.put("map.html",'<map class="ui-map"></map>')}])}.call(this),function(){"use strict";angular.module("app.directives").controller("locationSelectorCtrl",["$scope","$rootScope","CtrlUtilsService","$filter",function($scope,$rootScope,CtrlUtilsService,$filter){var clearMarker,createMarker,ngModelCtrl,refresh;return ngModelCtrl={$setViewValue:angular.noop},$scope.location=null,$scope.map=null,$scope.marker=null,this.init=function(ngModelCtrl_){return ngModelCtrl=ngModelCtrl_,$rootScope.$broadcast("locationSelectorReady",$scope.elementId)},staticOnMapReady($scope,function(map){var latLng;return $scope.map=map,null!=CtrlUtilsService.getUserInfo().location&&(latLng=new MyLatLng(CtrlUtilsService.getUserInfo().location.latitude,CtrlUtilsService.getUserInfo().location.longitude),$scope.map.setCenter(latLng),$scope.map.setZoom(CtrlUtilsService.getDefaultZoom())),null!=$scope.location&&(latLng=new MyLatLng($scope.location.latitude,$scope.location.longitude),createMarker(latLng)),$scope.map.addDoubleClickListener(function(myLatLng){return ngModelCtrl.$setViewValue({latitude:myLatLng.lat(),longitude:myLatLng.lng()}),ngModelCtrl.$render(),refresh()})}),$scope.$on("refreshLocationSelector",function(event,dto){var latLng;return null!=dto.id&&dto.id!==$scope.elementId||($scope.location=dto.location,null==$scope.map)?void 0:null!=$scope.location?(latLng=new MyLatLng($scope.location.latitude,$scope.location.longitude),createMarker(latLng)):clearMarker()}),refresh=function(){var latLng;return $scope.location=ngModelCtrl.$viewValue,$scope.$apply(),null!=$scope.map?null!=$scope.location?(latLng=new MyLatLng($scope.location.latitude,$scope.location.longitude),createMarker(latLng)):clearMarker():void 0},createMarker=function(latLng){var markerTitle,_ref;return null!=$scope.map?(clearMarker(),markerTitle=null!=(_ref=$scope.markerTitle)?_ref:"location",$scope.marker=new MyMarker($filter("translate")(markerTitle)),$scope.marker.setPosition(latLng),$scope.marker.setDraggable(!0),staticAddMarkerToMap($scope.map,$scope.marker),$scope.map.panTo($scope.marker.getPosition()),$scope.map.setZoom(CtrlUtilsService.getDefaultZoom()+1),$scope.marker.addDragEndListener(function(){return ngModelCtrl.$setViewValue({latitude:$scope.marker.getPosition().lat(),longitude:$scope.marker.getPosition().lng()}),ngModelCtrl.$render(),refresh()})):void 0},clearMarker=function(){var latLng;return null!=$scope.marker&&(staticClearMarkers($scope.map,$scope.marker),$scope.marker=null,null!=$scope.map&&null!=CtrlUtilsService.getUserInfo().location)?(latLng=new MyLatLng(CtrlUtilsService.getUserInfo().location.latitude,CtrlUtilsService.getUserInfo().location.longitude),$scope.map.setCenter(latLng),$scope.map.setZoom(CtrlUtilsService.getDefaultZoom())):void 0}}]).directive("locationSelector",[function(){return{restrict:"E",scope:{markerTitle:"="},replace:!0,require:["locationSelector","?ngModel"],templateUrl:"views/directive/location-selector.html",controller:"locationSelectorCtrl",link:function(scope,element,attrs,controllers){var myCtrl,ngModelCtrl;return myCtrl=controllers[0],ngModelCtrl=controllers[1],scope.elementId=$(element).attr("id"),null!=ngModelCtrl?myCtrl.init(ngModelCtrl):void 0}}}])}.call(this),function(){"use strict";angular.module("app.directives").directive("gaugeChart",[function(){return{restrict:"A",scope:{data:"=",options:"="},link:function(scope,ele,attrs){var data,gauge,options;return data=scope.data,options=scope.options,gauge=new Gauge(ele[0]).setOptions(options),gauge.maxValue=data.maxValue,gauge.animationSpeed=data.animationSpeed,gauge.set(data.val)}}}]).directive("flotChart",[function(){return{restrict:"A",scope:{data:"=",options:"="},link:function(scope,ele,attrs){var data,options,plot;return data=scope.data,options=scope.options,plot=$.plot(ele[0],data,options)}}}]).directive("flotChartRealtime",[function(){return{restrict:"A",link:function(scope,ele,attrs){var data,getRandomData,plot,totalPoints,update,updateInterval;return data=[],totalPoints=300,getRandomData=function(){var i,prev,res,y;for(data.length>0&&(data=data.slice(1));data.length<totalPoints;)prev=data.length>0?data[data.length-1]:50,y=prev+10*Math.random()-5,0>y?y=0:y>100&&(y=100),data.push(y);for(res=[],i=0;i<data.length;)res.push([i,data[i]]),++i;return res},update=function(){plot.setData([getRandomData()]),plot.draw(),setTimeout(update,updateInterval)},data=[],totalPoints=300,updateInterval=200,plot=$.plot(ele[0],[getRandomData()],{series:{lines:{show:!0,fill:!0},shadowSize:0},yaxis:{min:0,max:100},xaxis:{show:!1},grid:{hoverable:!0,borderWidth:1,borderColor:"#eeeeee"},colors:["#5BDDDC"]}),update()}}}]).directive("sparkline",[function(){return{restrict:"A",scope:{data:"=",options:"="},link:function(scope,ele,attrs){var data,options,sparkResize,sparklineDraw;return data=scope.data,options=scope.options,sparkResize=void 0,sparklineDraw=function(){return ele.sparkline(data,options)},$(window).resize(function(e){return clearTimeout(sparkResize),sparkResize=setTimeout(sparklineDraw,200)}),sparklineDraw()}}}]).directive("morrisChart",[function(){return{restrict:"A",scope:{data:"="},link:function(scope,ele,attrs){var colors,data,func,options;switch(data=scope.data,attrs.type){case"line":return colors=void 0===attrs.lineColors||""===attrs.lineColors?null:JSON.parse(attrs.lineColors),options={element:ele[0],data:data,xkey:attrs.xkey,ykeys:JSON.parse(attrs.ykeys),labels:JSON.parse(attrs.labels),lineWidth:attrs.lineWidth||2,lineColors:colors||["#0b62a4","#7a92a3","#4da74d","#afd8f8","#edc240","#cb4b4b","#9440ed"]},new Morris.Line(options);case"area":return colors=void 0===attrs.lineColors||""===attrs.lineColors?null:JSON.parse(attrs.lineColors),options={element:ele[0],data:data,xkey:attrs.xkey,ykeys:JSON.parse(attrs.ykeys),labels:JSON.parse(attrs.labels),lineWidth:attrs.lineWidth||2,lineColors:colors||["#0b62a4","#7a92a3","#4da74d","#afd8f8","#edc240","#cb4b4b","#9440ed"],behaveLikeLine:attrs.behaveLikeLine||!1,fillOpacity:attrs.fillOpacity||"auto",pointSize:attrs.pointSize||4},new Morris.Area(options);case"bar":return colors=void 0===attrs.barColors||""===attrs.barColors?null:JSON.parse(attrs.barColors),options={element:ele[0],data:data,xkey:attrs.xkey,ykeys:JSON.parse(attrs.ykeys),labels:JSON.parse(attrs.labels),barColors:colors||["#0b62a4","#7a92a3","#4da74d","#afd8f8","#edc240","#cb4b4b","#9440ed"],stacked:attrs.stacked||null},new Morris.Bar(options);case"donut":return colors=void 0===attrs.colors||""===attrs.colors?null:JSON.parse(attrs.colors),options={element:ele[0],data:data,colors:colors||["#0B62A4","#3980B5","#679DC6","#95BBD7","#B0CCE1","#095791","#095085","#083E67","#052C48","#042135"]},attrs.formatter&&(func=new Function("y","data",attrs.formatter),options.formatter=func),new Morris.Donut(options)}}}}])}.call(this),function(){"use strict";angular.module("app.toast",[]).service("toast",function(){var logIt;toastr.options={closeButton:!0,positionClass:"toast-bottom-right",timeOut:"3000"},logIt=function(message,type){return toastr[type](message)},this.log=function(message){return logIt(message,"info")},this.logWarning=function(message){return logIt(message,"warning")},this.logSuccess=function(message){return logIt(message,"success")},this.logError=function(message){return logIt(message,"error")}})}.call(this),function(){"use strict";var utils;utils={},utils.parseIsoDate=function(isoDate){if(null!=isoDate){if(19===isoDate.length)return moment(isoDate,"YYYY-MM-DDTHH:mm:ss").toDate();if(10===isoDate.length)return moment(isoDate,"YYYY-MM-DD").toDate()}},utils.parseIsoTime=function(isoTime){if(null!=isoTime){if(10===isoTime.length)return moment(isoTime,"YYYY-MM-DD").toDate();if(19===isoTime.length)return moment(isoTime,"YYYY-MM-DDTHH:mm:ss").toDate()}},utils.createIsoDate=function(date){return null!=date?moment(date).format("YYYY-MM-DD"):void 0},utils.createIsoTime=function(date,time){return null!=date?null!=time?moment(date).format("YYYY-MM-DD")+"T"+moment(time).format("HH:mm:ss"):moment(date).format("YYYY-MM-DDTHH:mm:ss"):void 0},utils.escapeHTML=function(html){return html=_.escape(html)},utils.getChartLabel=function(label){var length;return label.length>23&&(length=label.length,label=label.substring(0,10)+"..."+label.substring(length-10)),label=_.escape(label)},window.globalUtils=utils}.call(this),function(){"use strict";var module;module=angular.module("app.push",["app.token"]),module.service("PushService",["$rootScope","$q","$token","$log","ADDRESS_WEBSOCKETS","$timeout",function($rootScope,$q,$token,$log,ADDRESS_WEBSOCKETS,$timeout){var IDLE_RETRY_INTERVAL,MAX_RETRY_COUNT,RETRY_INTERVAL,reconnect,registerSubscribe,restart,restarting,retryAfter,retryCount,send,socket,start,startInternal,subscribeStomp,subscribes;return MAX_RETRY_COUNT=5,RETRY_INTERVAL=5e3,IDLE_RETRY_INTERVAL=6e4,subscribes=[],socket={sockJsClient:null,stompClient:null},restarting=!1,retryCount=0,registerSubscribe=function(topic){var defer;return defer=$q.defer(),subscribes.push({topic:topic,defer:defer}),null!=socket.stompClient&&subscribeStomp(topic,defer),defer.promise},start=function(){return null!=$token.getUserInfo?startInternal():$rootScope.$on("TokenVerified",function(){return startInternal()})},startInternal=function(){var accessToken,sockJsClient,stompClient,userId;if(null!=socket.stompClient||null!=socket.sockJsClient){try{socket.stompClient.onclose=null,socket.stompClient.disconnect()}catch(_error){}try{socket.sockJsClient.onclose=null,socket.sockJsClient.disconnect()}catch(_error){}socket.sockJsClient=null,socket.stompClient=null}return sockJsClient=new SockJS(ADDRESS_WEBSOCKETS,{},{}),stompClient=Stomp.over(sockJsClient),accessToken=$token.getAccessToken(),userId=null!=$token.getUserInfo()?$token.getUserInfo().id:null,null==accessToken||null==userId?($log.debug("No user/token info"),void retryAfter(RETRY_INTERVAL)):stompClient.connect($token.getUserInfo().id,$token.getAccessToken(),function(){var i;for(retryCount=0,socket.sockJsClient=sockJsClient,socket.stompClient=stompClient,i=0;i<subscribes.length;)subscribeStomp(subscribes[i].topic,subscribes[i].defer),i++;return restarting?(restarting=!1,$rootScope.$broadcast("PushReconnected")):$rootScope.$broadcast("PushConnected"),sockJsClient.onclose=reconnect},function(){return retryAfter(MAX_RETRY_COUNT>retryCount?RETRY_INTERVAL:IDLE_RETRY_INTERVAL)})},retryAfter=function(interval){return retryCount++,$log.debug("Fail to connect, schedule to retry after "+interval+" milis"),$timeout(function(){return $log.debug("Trying to connect[time="+retryCount+"]"),startInternal()},interval)},restart=function(){return restarting=!0,start()},send=function(destination,message){return socket.stompClient.send(destination,{},angular.toJson(message))},subscribeStomp=function(topic,defer){return socket.stompClient.subscribe(topic,function(data){return defer.notify(angular.fromJson(data.body))})},reconnect=function(){return $log.debug("Connection closed unexpectedly, schedule to retry after "+RETRY_INTERVAL+" milis"),$timeout(function(){return $log.debug("Trying to reconnect..."),restart()},RETRY_INTERVAL)},$rootScope.$on("TokenChanged",function(){
return null!=socket.stompClient,$log.debug("Token changed, reconnect to websockets endpoint"),restart()}),{registerSubscribe:registerSubscribe,start:start,restart:restart,send:send}}])}.call(this),function(){"use strict";angular.module("app.filter",[]).filter("propsFilter",function(){return function(items,props){var item,itemMatches,key,keys,out,text,value,_i,_j,_len,_len1;if(out=[],angular.isArray(items))for(_i=0,_len=items.length;_len>_i;_i++){for(item=items[_i],itemMatches=!1,keys=Object.keys(props),_j=0,_len1=keys.length;_len1>_j;_j++)if(key=keys[_j],text=null==props[key]?"":props[key].toLowerCase(),value="",null!=item&&null!=item[key]&&(value=item[key].toString().toLowerCase()),-1!==value.indexOf(text)){itemMatches=!0;break}itemMatches&&out.push(item)}else out=items;return out}}).filter("isoDate",["CtrlUtilsService",function(CtrlUtilsService){return function(str){var date;return null!=str&&(date=globalUtils.parseIsoDate(str),null!=date)?moment(date).format(CtrlUtilsService.getUserInfo().dateFormat.toUpperCase()):""}}]).filter("isoDateTime",["CtrlUtilsService",function(CtrlUtilsService){return function(str){var date;return null!=str&&(date=globalUtils.parseIsoTime(str),null!=date)?moment(date).format(CtrlUtilsService.getUserInfo().dateFormat.toUpperCase()+" HH:mm:ss"):""}}]).filter("isoTime",function(){return function(str){var date;return null!=str&&(date=globalUtils.parseIsoTime(str),null!=date)?moment(date).format("HH:mm:ss"):""}}).filter("isoDateTimeWithoutSecond",["CtrlUtilsService",function(CtrlUtilsService){return function(str){var date;return null!=str&&(date=globalUtils.parseIsoTime(str),null!=date)?moment(date).format(CtrlUtilsService.getUserInfo().dateFormat.toUpperCase()+" HH:mm"):""}}]).filter("bigNumber",["$filter",function($filter){return function(value){var unit;return null!=value?isNaN(value)?value:(unit="",value>1e10?(value/=1e9,unit=" B"):value>1e7?(value/=1e6,unit=" M"):value>1e4&&(value/=1e3,unit=" k"),value>99?$filter("number")(value,0)+unit:value>1?$filter("number")(value,1)+unit:$filter("number")(value,2)+unit):void 0}}]).filter("bigInteger",["$filter",function($filter){return function(value){return null!=value?isNaN(value)?value:$filter("bigNumber")($filter("number")(value,0)):void 0}}])}.call(this),function(){"use strict";angular.module("app").factory("Factory",["$resource","ADDRESS_BACKEND",function($resource,ADDRESS_BACKEND){var actions,paramDefaults,url;return url=ADDRESS_BACKEND+":who/:category/:subCategory/:id/:param/:action/:subAction",paramDefaults=null,actions={doPost:{method:"POST",headers:{"Content-Type":"application/json"}},doPut:{method:"PUT",headers:{"Content-Type":"application/json"}},doGet:{method:"GET",isArray:!1},doDelete:{method:"DELETE"}},$resource(url,paramDefaults,actions)}])}.call(this),function(){"use strict";var ChangeStatus,CtrlUtilsService,LoadStatus,__slice=[].slice;CtrlUtilsService=function(){function CtrlUtilsService(Factory,$log,$filter,$token,toast){this.Factory=Factory,this.$log=$log,this.$filter=$filter,this.$token=$token,this.toast=toast}return CtrlUtilsService.prototype.getWho=function(){var roleCode;if(roleCode=this.$token.getRoleCode(),null==roleCode)return null;switch(roleCode){case"SUPER":return"super-admin";case"SUPPORTER":return"supporter";case"AD":return"admin";case"OBS":return"observer";case"SUP":return"supervisor";case"DIS":return"distributor";default:return null}},CtrlUtilsService.prototype.getUserLanguage=function(){return this.$token.getUserLanguage()},CtrlUtilsService.prototype.doPost=function(params,loadStatusOfData,requestBody,callbackSuccess,callbackFailure,action){var onFailure,onSuccess,_this;return _this=this,loadStatusOfData.processing=!0,action=null!=action?action:"save",onSuccess=function(data){return loadStatusOfData.processing=!1,jQuery.isFunction(callbackSuccess)&&callbackSuccess(data),_this.toast.logSuccess(_this.$filter("translate")(action+".success"))},onFailure=function(error){return loadStatusOfData.processing=!1,_this.$log.log(error),jQuery.isFunction(callbackFailure)&&callbackFailure(error),400===error.status?_this.toast.logError(_this.$filter("translate")(error.data.meta.error_message)):_this.toast.logError(_this.$filter("translate")(action+".error"))},_this.Factory.doPost(params,requestBody,onSuccess,onFailure)},CtrlUtilsService.prototype.doPut=function(params,loadStatusOfData,requestBody,callbackSuccess,callbackFailure,action){var onFailure,onSuccess,_this;return _this=this,loadStatusOfData.processing=!0,action=null!=action?action:"save",onSuccess=function(data){return loadStatusOfData.processing=!1,jQuery.isFunction(callbackSuccess)&&callbackSuccess(data),_this.toast.logSuccess(_this.$filter("translate")(action+".success"))},onFailure=function(error){return loadStatusOfData.processing=!1,_this.$log.log(error),jQuery.isFunction(callbackFailure)&&callbackFailure(error),400===error.status?_this.toast.logError(_this.$filter("translate")(error.data.meta.error_message)):_this.toast.logError(_this.$filter("translate")(action+".error"))},_this.Factory.doPut(params,requestBody,onSuccess,onFailure)},CtrlUtilsService.prototype.doDelete=function(params,loadStatusOfData,callbackSuccess,callbackFailure){var onFailure,onSuccess,_this;return _this=this,loadStatusOfData.processing=!0,onSuccess=function(data){return loadStatusOfData.processing=!1,jQuery.isFunction(callbackSuccess)&&callbackSuccess(data),_this.toast.logSuccess(_this.$filter("translate")("delete.success"))},onFailure=function(error){return loadStatusOfData.processing=!1,_this.$log.log(error),jQuery.isFunction(callbackFailure)&&callbackFailure(error),400===error.status?_this.toast.logError(_this.$filter("translate")(error.data.meta.error_message)):_this.toast.logError(_this.$filter("translate")("delete.error"))},_this.Factory.doDelete(params,onSuccess,onFailure)},CtrlUtilsService.prototype.loadSingleData=function(params,loadStatusOfData,callbackSuccess,callbackFailure){var onFailure,onSuccess,_this;return _this=this,loadStatusOfData.processing=!0,loadStatusOfData.error=!1,onSuccess=function(data){return loadStatusOfData.processing=!1,jQuery.isFunction(callbackSuccess)?callbackSuccess(null!=data?data:{}):void 0},onFailure=function(error){return loadStatusOfData.processing=!1,loadStatusOfData.error=!0,_this.$log.log(error),jQuery.isFunction(callbackFailure)?callbackFailure(error):void 0},_this.Factory.doGet(params,onSuccess,onFailure)},CtrlUtilsService.prototype.loadListData=function(params,loadStatusOfData,callbackSuccess,callbackFailure){var onFailure,onSuccess,_this;return _this=this,loadStatusOfData.processing=!0,loadStatusOfData.error=!1,onSuccess=function(data){var count,list;return loadStatusOfData.processing=!1,list=null!=data&&null!=data.list?data.list:[],count=null!=data&&null!=data.list?data.count:0,jQuery.isFunction(callbackSuccess)?callbackSuccess(list,count):void 0},onFailure=function(error){return loadStatusOfData.processing=!1,loadStatusOfData.error=!0,_this.$log.log(error),jQuery.isFunction(callbackFailure)?callbackFailure(error):void 0},_this.Factory.doGet(params,onSuccess,onFailure)},CtrlUtilsService.prototype.createLoadStatus=function(){var dataNames;return dataNames=1<=arguments.length?__slice.call(arguments,0):[],new LoadStatus(dataNames)},CtrlUtilsService.prototype.createChangeStatus=function(){return new ChangeStatus},CtrlUtilsService.prototype.printOrder=function(orderId){var popupWin,printContents;return printContents=document.getElementById(orderId).innerHTML,popupWin=window.open(),popupWin.document.open(),popupWin.document.write('<html><head><link rel="stylesheet" type="text/css" href="styles/main.css"/></head><body onload="window.print()" class="print">'+printContents+"</body></html>"),popupWin.document.close()},CtrlUtilsService.prototype.getUserInfo=function(){return this.$token.getUserInfo()},CtrlUtilsService.prototype.getDefaultZoom=function(){return 14},CtrlUtilsService}(),LoadStatus=function(){function LoadStatus(dataNames){var dataName,_i,_len;for(this.status={},_i=0,_len=dataNames.length;_len>_i;_i++)dataName=dataNames[_i],this.status[dataName]={processing:!1,error:!1}}return LoadStatus.prototype.getStatusByDataName=function(dataName){var _status;return _status=this.status[dataName],null==_status&&(_status={processing:!1,error:!1},this.status[dataName]=_status),_status},LoadStatus.prototype.isProcessing=function(){var dataName;if(null!=this.status)for(dataName in this.status)if(this.status[dataName].processing)return!0;return!1},LoadStatus.prototype.isError=function(){var dataName;if(null!=this.status)for(dataName in this.status)if(this.status[dataName].error)return!0;return!1},LoadStatus}(),ChangeStatus=function(){function ChangeStatus(){this.isChanged=!1}return ChangeStatus.prototype.markAsChanged=function(){return this.isChanged=!0},ChangeStatus.prototype.reset=function(){return this.isChanged=!1},ChangeStatus}(),angular.module("app").service("CtrlUtilsService",["Factory","$log","$filter","$token","toast",CtrlUtilsService])}.call(this),function(){"use strict";var LoadingUtilsService;LoadingUtilsService=function(){function LoadingUtilsService(CtrlUtilsService){this.CtrlUtilsService=CtrlUtilsService}return LoadingUtilsService.prototype.loadSupervisors=function(who,loadStatusOfData,callback){var params,_callback;return params={who:who,category:"supervisor"},_callback=function(list,count){var _list;return _list=_.sortBy(list,function(o){return o.fullname}),jQuery.isFunction(callback)?callback(_list,count):void 0},this.CtrlUtilsService.loadListData(params,loadStatusOfData,_callback)},LoadingUtilsService.prototype.loadObservers=function(who,loadStatusOfData,callback){var params,_callback;return params={who:who,category:"observer"},_callback=function(list,count){var _list;return _list=_.sortBy(list,function(o){return o.fullname}),jQuery.isFunction(callback)?callback(_list,count):void 0},this.CtrlUtilsService.loadListData(params,loadStatusOfData,_callback)},LoadingUtilsService.prototype.loadProductCategories=function(who,loadStatusOfData,callback){var params,_callback;return params={who:who,category:"product-category",subCategory:"all"},_callback=function(list,count){var _list;return _list=_.sortBy(list,function(o){return o.name}),jQuery.isFunction(callback)?callback(_list,count):void 0},this.CtrlUtilsService.loadListData(params,loadStatusOfData,_callback)},LoadingUtilsService.prototype.loadUOMs=function(who,loadStatusOfData,callback){var params,_callback;return params={who:who,category:"uom",subCategory:"all"},_callback=function(list,count){var _list;return _list=_.sortBy(list,function(o){return o.name}),jQuery.isFunction(callback)?callback(_list,count):void 0},this.CtrlUtilsService.loadListData(params,loadStatusOfData,_callback)},LoadingUtilsService.prototype.loadCustomerTypes=function(who,loadStatusOfData,callback){var params,_callback;return params={who:who,category:"customer-type",subCategory:"all"},_callback=function(list,count){var _list;return _list=_.sortBy(list,function(o){return o.name}),jQuery.isFunction(callback)?callback(_list,count):void 0},this.CtrlUtilsService.loadListData(params,loadStatusOfData,_callback)},LoadingUtilsService.prototype.loadDistributors=function(who,loadStatusOfData,callback){var params,_callback;return params={who:who,category:"distributor",subCategory:"all"},_callback=function(list,count){var _list;return _list=_.sortBy(list,function(o){return o.name}),jQuery.isFunction(callback)?callback(_list,count):void 0},this.CtrlUtilsService.loadListData(params,loadStatusOfData,_callback)},LoadingUtilsService.prototype.loadProductsByDistributor=function(who,loadStatusOfData,callback){var params,_callback;return params={who:who,category:"product",subCategory:"all"},_callback=function(list,count){var _list;return _list=_.sortBy(list,function(o){return o.name}),jQuery.isFunction(callback)?callback(_list,count):void 0},this.CtrlUtilsService.loadListData(params,loadStatusOfData,_callback)},LoadingUtilsService.prototype.loadAreasByDistributor=function(who,distributorId,loadStatusOfData,callback){var params,_callback;return params={who:who,category:"area",subCategory:"all",distributorId:distributorId},_callback=function(list,count){var _list;return _list=_.sortBy(list,function(o){return o.name}),jQuery.isFunction(callback)?callback(_list,count):void 0},this.CtrlUtilsService.loadListData(params,loadStatusOfData,_callback)},LoadingUtilsService.prototype.loadRoutesByDistributor=function(who,distributorId,loadStatusOfData,callback){var params,_callback;return params={who:who,category:"route",subCategory:"all",distributorId:distributorId},_callback=function(list,count){var _list;return _list=_.sortBy(list,function(o){return o.name}),jQuery.isFunction(callback)?callback(_list,count):void 0},this.CtrlUtilsService.loadListData(params,loadStatusOfData,_callback)},LoadingUtilsService.prototype.loadSalesmenByDistributor=function(who,distributorId,loadStatusOfData,callback){var params,_callback;return params={who:who,category:"salesman",distributorId:distributorId},_callback=function(list,count){var _list;return _list=_.sortBy(list,function(o){return o.fullname}),jQuery.isFunction(callback)?callback(_list,count):void 0},this.CtrlUtilsService.loadListData(params,loadStatusOfData,_callback)},LoadingUtilsService.prototype.loadStoreCheckersByDistributor=function(who,distributorId,loadStatusOfData,callback){var params,_callback;return params={who:who,category:"store-checker",distributorId:distributorId},_callback=function(list,count){var _list;return _list=_.sortBy(list,function(o){return o.fullname}),jQuery.isFunction(callback)?callback(_list,count):void 0},this.CtrlUtilsService.loadListData(params,loadStatusOfData,_callback)},LoadingUtilsService}(),angular.module("app").service("LoadingUtilsService",["CtrlUtilsService",LoadingUtilsService])}.call(this),function(){"use strict";angular.module("app").controller("HeaderMenuCtrl",["$scope","$location","$token","MENUS","$state","Idle","Keepalive","$modal","$http","ADDRESS_PING","$log",function($scope,$location,$token,MENUS,$state,Idle,Keepalive,$modal,$http,ADDRESS_PING,$log){var checkActiveHref,closeIdleWarningModals;return $scope.menus=MENUS,checkActiveHref=function(path,href){return null!=path&&null!=href?"#"+path===href:!1},$scope.isMenuActive=function(menu){var child,_i,_len,_ref;if(null!=menu){if(null==menu.children)return checkActiveHref($location.path(),menu.href);for(_ref=menu.children,_i=0,_len=_ref.length;_len>_i;_i++)if(child=_ref[_i],checkActiveHref($location.path(),child.href))return!0}return!1},$scope.checkMenu=function(menu){return $scope.checkMenuByRole(menu)&&$scope.checkModule(menu)},$scope.checkMenuByRole=function(menu){var roleCode;return roleCode=null!=$token?$token.getRoleCode():null,null!=menu&&null!=menu.roles&&_.indexOf(menu.roles,roleCode)>-1},$scope.checkModule=function(menu){var module,modules,_i,_len,_ref;if(modules=null!=$token?$token.getModules():null,null!=menu&&null!=menu.modules&&menu.modules.length>0){for(_ref=menu.modules,_i=0,_len=_ref.length;_len>_i;_i++)if(module=_ref[_i],null!=modules&&_.indexOf(modules,module)>-1)return!0;return!1}return!0},$scope.isSpecificPage=function(){var path;return path=$location.path(),_.includes(["/404","/500","/550"],path)},$scope.main={brand:"DMS PLUS",name:function(){return null!=$token.getUserInfo()?$token.getUserInfo().fullname:""}},$scope.logout=$token.logout,$scope.changePassword=function(){return $state.go("change-password")},$scope.$on("IdleStart",function(){return closeIdleWarningModals(),$scope.warning=$modal.open({templateUrl:"views/system/logout-warning-dialog.html",controller:"TimeoutWarnCtrl",windowClass:"modal-danger"})}),$scope.$on("IdleEnd",function(){return closeIdleWarningModals()}),$scope.$on("IdleTimeout",function(){return closeIdleWarningModals(),$scope.timedout=$modal.open({templateUrl:"views/system/logged-out-dialog.html",windowClass:"modal-danger"}),$token.logout()}),$scope.$on("Keepalive",function(){var iFrame;return iFrame=document.createElement("iframe"),iFrame.onload=function(){return iFrame.parentNode.removeChild(iFrame)},iFrame.setAttribute("src",ADDRESS_PING),iFrame.setAttribute("id","keep_alive_frame"),iFrame.style.display="none",document.body.appendChild(iFrame)}),closeIdleWarningModals=function(){return $scope.warning&&($scope.warning.close(),$scope.warning=null),$scope.timedout&&($scope.timedout.close(),$scope.timedout=null),$scope.$apply()},$scope.getUserLanguage=function(){return $token.getUserLanguage()}}]).controller("TimeoutWarnCtrl",["$scope","NG_IDLE_TIMEOUT",function($scope,NG_IDLE_TIMEOUT){return $scope.max=NG_IDLE_TIMEOUT,$scope.countdown=NG_IDLE_TIMEOUT,$scope.$on("IdleWarn",function(e,countdown){return $scope.countdown=countdown,$scope.$apply()}),$scope.$on("IdleTimeout",function(){return $scope.countdown=0,$scope.$apply()})}])}.call(this),function(){"use strict";angular.module("app").controller("NotificationCtrl",["$scope","$token","CtrlUtilsService","PushService","Factory","$filter","toast","$state",function($scope,$token,CtrlUtilsService,PushService,Factory,$filter,toast,$state){var addToList,findRecordIndex,init,loadPendingCustomers,loadPendingOrders,loadUnreadFeedbacks,onCustomerMessage,onFeedbackMessage,onMessage,onOrderMessage,onPushConnected,removeFromList,syncData,transformDisplayData;return init=function(){return $scope.MIN_ITEM_COUNT=5,$scope.INITIAL_ITEM_COUNT=20,$scope.SYNC_EXPIRED_TIME=6e4,$scope.userId=$token.getUserInfo().id,$scope.who=CtrlUtilsService.getWho(),$scope.data={customers:[],feedbacks:[],orders:[]},$scope.lastSyncTime=null,syncData(),PushService.registerSubscribe("/user/queue/notify").then(null,null,onMessage),PushService.start(),$scope.$on("PushReconnected",onPushConnected),$scope.$on("PushConnected",onPushConnected)},syncData=function(){return $scope.canApproveCustomer()&&loadPendingCustomers(),$scope.canReadFeedback()&&loadUnreadFeedbacks(),$scope.canApproveOrder()&&loadPendingOrders(),$scope.lastSyncTime=new Date},onPushConnected=function(){var currentDate,dateDiff;return null!=$scope.lastSyncTime&&(currentDate=new Date,dateDiff=currentDate.getTime()-$scope.lastSyncTime.getTime(),dateDiff>$scope.SYNC_EXPIRED_TIME)?syncData():void 0},onMessage=function(message){if(null!=message&&null!=message.type){if("order"===message.type&&$scope.canApproveOrder())return onOrderMessage(message);if("customer"===message.type&&$scope.canApproveCustomer())return onCustomerMessage(message);if("feedback"===message.type&&$scope.canReadFeedback())return onFeedbackMessage(message)}},onCustomerMessage=function(message){var notice,skipNotice;return $scope.data.customers.count=message.data.count,skipNotice=message.senderId===$scope.userId,"add"===message.data.action?(notice=$filter("translate")("header.notification.customer.alert.add",{count:message.data.count}),addToList($scope.data.customers,message.data.customer)):"approve"===message.data.action?(notice=$filter("translate")("header.notification.customer.alert.approve",{name:message.data.customer.name}),removeFromList($scope.data.customers,message.data.customer)):"reject"===message.data.action&&(notice=$filter("translate")("header.notification.customer.alert.reject",{name:message.data.customer.name}),removeFromList($scope.data.customers,message.data.customer)),null==notice||skipNotice||toast.log(notice),$scope.data.customers.original.length<$scope.MIN_ITEM_COUNT&&$scope.data.customers.count>=$scope.MIN_ITEM_COUNT?loadPendingCustomers():void 0},onFeedbackMessage=function(message){var notice,skipNotice;return $scope.data.feedbacks.count=message.data.count,skipNotice=message.senderId===$scope.userId,"add"===message.data.action?(notice=$filter("translate")("header.notification.feedback.alert.add",{count:message.data.count}),addToList($scope.data.feedbacks,message.data.feedback)):"read"===message.data.action&&removeFromList($scope.data.feedbacks,message.data.feedback),null==notice||skipNotice||toast.log(notice),$scope.data.feedbacks.original.length<$scope.MIN_ITEM_COUNT&&$scope.data.feedbacks.count>=$scope.MIN_ITEM_COUNT?loadUnreadFeedbacks():void 0},onOrderMessage=function(message){var notice,skipNotice;return $scope.data.orders.count=message.data.count,skipNotice=message.senderId===$scope.userId,"add"===message.data.action?(notice=$filter("translate")("header.notification.order.alert.add",{count:message.data.count}),addToList($scope.data.orders,message.data.order)):"approve"===message.data.action?(notice=$filter("translate")("header.notification.order.alert.approve",{code:message.data.order.code}),removeFromList($scope.data.orders,message.data.order)):"reject"===message.data.action&&(notice=$filter("translate")("header.notification.order.alert.reject",{code:message.data.order.code}),removeFromList($scope.data.orders,message.data.order)),null==notice||skipNotice||toast.log(notice),$scope.data.orders.original.length<$scope.MIN_ITEM_COUNT&&$scope.data.orders.count>=$scope.MIN_ITEM_COUNT?loadPendingOrders():void 0},addToList=function(list,record){return list.original.unshift(record),transformDisplayData(list)},removeFromList=function(list,record){var index;return index=findRecordIndex(list.original,record.id),index>-1&&list.original.splice(index,1),transformDisplayData(list)},findRecordIndex=function(arr,id){var i,size;for(i=0,size=arr.length;size>i;){if(arr[i].id===id)return i;i++}return-1},loadPendingCustomers=function(){var loadSuccess,params;return params={who:$scope.who,category:"customer",subCategory:"pending",page:1,size:$scope.INITIAL_ITEM_COUNT},loadSuccess=function(data){return $scope.data.customers.count=data.count,$scope.data.customers.original=data.list?data.list:[],transformDisplayData($scope.data.customers)},Factory.doGet(params,loadSuccess)},loadUnreadFeedbacks=function(){var loadSuccess,params;return params={who:$scope.who,category:"feedback",page:1,size:$scope.INITIAL_ITEM_COUNT,read:!1},loadSuccess=function(data){return $scope.data.feedbacks.count=data.count,$scope.data.feedbacks.original=data.list?data.list:[],transformDisplayData($scope.data.feedbacks)},Factory.doGet(params,loadSuccess)},loadPendingOrders=function(){var loadSuccess,params;return params={who:$scope.who,category:"order",subCategory:"pending",page:1,size:$scope.INITIAL_ITEM_COUNT},loadSuccess=function(data){return $scope.data.orders.count=data.count,$scope.data.orders.original=data.list?data.list:[],transformDisplayData($scope.data.orders)},Factory.doGet(params,loadSuccess)},transformDisplayData=function(list){var dataLength,i,size,_results;if(list.display=[],null!=list.original&&list.original.length>0){for(size=$scope.MIN_ITEM_COUNT,dataLength=list.original.length,size>dataLength&&(size=dataLength),i=0,_results=[];size>i;)list.display.push(list.original[i]),_results.push(i++);return _results}},$scope.gotoCustomerPending=function(){return $state.go("customer-pending")},$scope.gotoCustomerPendingDetail=function(customer){return $state.go("customer-approval",{id:customer.id})},$scope.gotoFeedbackList=function(){return $state.go("feedback")},$scope.gotoFeedbackDetail=function(feedback){return $state.go("feedback-detail",{id:feedback.id})},$scope.gotoApproveOrderList=function(){return $state.go("order-pending")},$scope.gotoOrderApproveDetail=function(order){return $state.go("order-approval",{id:order.id})},$scope.canApproveOrder=function(){return _.includes(["admin","supervisor","distributor"],$scope.who)},$scope.canApproveCustomer=function(){return _.includes(["admin","supervisor"],$scope.who)},$scope.canReadFeedback=function(){return _.includes(["admin","supervisor","distributor"],$scope.who)},init()}])}.call(this),function(){"use strict";angular.module("app.token",[]).provider("$token",function(){var REQUIRED_AND_MISSING,defaultConfigs;return REQUIRED_AND_MISSING="REQUIRED_AND_MISSING",defaultConfigs={client_id:REQUIRED_AND_MISSING,authorizationEndpoint:REQUIRED_AND_MISSING,scope:"",revokeTokenEndpoint:"",verifyTokenEndpoint:"",changePasswordEndpoint:"",logoutUrl:"",redirect_url:"",state_length:5,refresh:!0,min_live_time:3e5,check_token_interval:5e3,refresh_max_wait:2e3,refresh_checklock_interval:2e3,is_no_auth_page:function(){return!1}},{extendConfig:function(configExtension){return defaultConfigs=angular.extend(defaultConfigs,configExtension)},set:function(){var key,value;return 1!==arguments.length&&"object"==typeof arguments[0]?this:"string"!=typeof arguments[0]?this:(value="undefined"==typeof arguments[1]?null:arguments[1],key=arguments[0],defaultConfigs[key]=value,this)},$get:["$http","$rootScope","$location","$q","$window","$log","$timeout","$interval","$state",function($http,$rootScope,$location,$q,$window,$log,$timeout,$interval,$state){var addUrlParam,buildAuthorizationUrl,changePassword,clearToken,clearUserInfo,createRandomState,createRandomString,currentRenewTokenTaskTimeout,endsWith,getAccessToken,getModules,getRedirectUrl,getRoleCode,getState,getTokenExpiredIn,getUserInfo,getUserLanguage,isNoAuthPage,isOAuthFrame,key,login,logout,removeOAuthFrame,renewToken,renewTokenAfter,renewTokenTask,requiredAndMissing,revokeToken,setAccessToken,setTimeoutToRefresh,setTokenFromLocation,setUserInfo,setUserLanguage,updateProgressTask,verifyToken,verifyTokenPromise,wrap;requiredAndMissing=[],updateProgressTask=void 0,renewTokenTask=void 0,currentRenewTokenTaskTimeout=0,setAccessToken=function(params){var expiredIn,expiryDate,rawState,returnUrl,state;return null==params.state?void $log.debug("State not exist, token rejected"):(rawState=decodeURIComponent(params.state),state=rawState.substring(0,defaultConfigs.state_length),state!==$window.localStorage.state?void $log.debug("State not match, token rejected"):(returnUrl=rawState.substring(defaultConfigs.state_length+1),$window.localStorage.access_token=params.access_token,$window.localStorage.token_type=params.token_type,params.expires_in?(expiryDate=new Date((new Date).getTime()+1e3*params.expires_in),$window.localStorage.expires_in=params.expires_in,$window.localStorage.expiry_date=expiryDate):($window.localStorage.expires_in=void 0,$window.localStorage.expiry_date=void 0),params.auto_refresh||(params.lang&&($window.localStorage.lang=params.lang.toLowerCase()),defaultConfigs.refresh&&(expiredIn=getTokenExpiredIn(),expiredIn<=defaultConfigs.min_live_time&&($log.error("Token validity must be > min_live_time"),defaultConfigs.min_live_time=parseInt(expiredIn/3),$log.error("The min_live_time was automatic set to "+defaultConfigs.min_live_time))),setTimeoutToRefresh(),null==returnUrl)?void 0:$location.url(returnUrl)))},getAccessToken=function(){return getTokenExpiredIn()<defaultConfigs.min_live_time?void 0:$window.localStorage.access_token},getTokenExpiredIn=function(){var expiryDate;return expiryDate=angular.isUndefined($window.localStorage.expiry_date)?null:Date.parse($window.localStorage.expiry_date),null!==expiryDate?expiryDate-(new Date).getTime():0},setTimeoutToRefresh=function(){return defaultConfigs.refresh?isOAuthFrame()?void $log.debug("Skip auto refresh token in OAuth iFrame"):renewTokenAfter(0):void $log.debug("Auto refresh token was turned off")},getRoleCode=function(){var userInfo;return userInfo=getUserInfo(),null!=userInfo?userInfo.roleCode:null},getModules=function(){var userInfo;return userInfo=getUserInfo(),null!=userInfo?userInfo.modules:null},endsWith=function(str,suffix){return-1!==str.indexOf(suffix,str.length-suffix.length)},logout=function(){var accessToken,doIt;return accessToken=getAccessToken(),doIt=function(){var lang;return clearToken(),clearUserInfo(),defaultConfigs.logoutUrl&&defaultConfigs.logoutUrl.length>0?(lang=getUserLanguage(),null!=lang?$window.location.href=addUrlParam(defaultConfigs.logoutUrl,"lang",lang):$window.location.href=defaultConfigs.logoutUrl):void 0},accessToken&&defaultConfigs.revokeTokenEndpoint&&defaultConfigs.revokeTokenEndpoint.length>0?revokeToken(accessToken).then(function(){return $log.info("Token revoked")},function(e){return $log.error("Token revoke error",e)})["finally"](function(){return doIt()}):doIt()},revokeToken=function(accessToken){var configs,url;return url=defaultConfigs.revokeTokenEndpoint,endsWith(url,"/")||(url+="/"),url+="/"+accessToken,configs={method:"DELETE",url:url,headers:{Authorization:"Bearer "+accessToken}},$http(configs)},addUrlParam=function(search,key,val){var newParam,params;return newParam=key+"="+val,params="?"+newParam,null!=search&&(params=search.replace(new RegExp("[?&]"+key+"[^&]*"),"$1"+newParam),params===search&&(-1===params.indexOf("?")&&(params+="?"),params+="&"+newParam)),params},clearToken=function(){return $window.localStorage.removeItem("access_token")},clearUserInfo=function(){return $window.localStorage.removeItem("userInfo")},getUserInfo=function(){var e,userInfo;if(userInfo=$window.localStorage.userInfo,!userInfo)return null;try{return angular.fromJson(userInfo)}catch(_error){e=_error,$window.localStorage.userInfo=null}return null},setUserInfo=function(userInfo){return $window.localStorage.userInfo=angular.toJson(userInfo)},getUserLanguage=function(){return $window.localStorage.lang},setUserLanguage=function(lang){return $window.localStorage.lang=lang},verifyTokenPromise=null,verifyToken=function(){var defer;if(null==verifyTokenPromise){if(null==defaultConfigs.verifyTokenEndpoint||0===defaultConfigs.verifyTokenEndpoint.length)throw new Error("Please config 'verifyTokenEndpoint' before use this function");defer=$q.defer(),null===getAccessToken()&&login(),$http.get(defaultConfigs.verifyTokenEndpoint).success(function(userinfo){return setUserInfo(userinfo),$log.debug("Token was verified"),$rootScope.$broadcast("TokenVerified"),defer.resolve(userinfo),verifyTokenPromise=null}).error(function(error){return $log.debug("Cannot verify token: "+error),defer.reject(error),verifyTokenPromise=null}),verifyTokenPromise=defer.promise}return verifyTokenPromise},setTokenFromLocation=function(){var search;return search=$location.search(),setAccessToken(search),$location.search("access_token",null),$location.search("token_type",null),$location.search("expires_in",null),$location.search("flag",null),$location.search("lang",null),$location.search("auto_refresh",null),$location.search("state",null),isOAuthFrame()?($log.debug("Token was renewed using iFrame"),removeOAuthFrame()):$log.debug("Token was saved")},isOAuthFrame=function(){return $window.parent&&$window.parent.document.getElementById("oauth_frame")},removeOAuthFrame=function(){var iFrame;return iFrame=$window.parent.document.getElementById("oauth_frame"),iFrame?iFrame.parentNode.removeChild(iFrame):void 0},getRedirectUrl=function(){var redirect_uri;return redirect_uri=$state.href("callback",{},{absolute:!0}),redirect_uri+"?"},getState=function(){var prefix,suffix;return suffix=$location.url(),prefix=createRandomState(),encodeURIComponent(prefix+"_"+suffix)},createRandomString=function(length){var i,possible,text;for(text="",possible="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;length>i;)text+=possible.charAt(Math.floor(Math.random()*possible.length)),i++;return text},createRandomState=function(){var state;return state=createRandomString(defaultConfigs.state_length),$window.localStorage.state=state,state},buildAuthorizationUrl=function(extendParams){var params,url;return params={response_type:"token",client_id:defaultConfigs.client_id,redirect_uri:getRedirectUrl(),scope:defaultConfigs.scope,state:getState()},params=angular.extend(params,extendParams),url=defaultConfigs.authorizationEndpoint,angular.forEach(params,function(value,key){return url=addUrlParam(url,encodeURIComponent(key),encodeURIComponent(value))}),url},login=function(){var search;return search=$location.search(),null!=search.access_token?void setTokenFromLocation():$window.location.href=buildAuthorizationUrl()},renewTokenAfter=function(timeout){return 0===timeout?renewToken():null==renewTokenTask?(currentRenewTokenTaskTimeout=timeout,renewTokenTask=$interval(function(){return renewToken()},timeout)):timeout!==currentRenewTokenTaskTimeout?($interval.cancel(renewTokenTask),currentRenewTokenTaskTimeout=timeout,renewTokenTask=$interval(function(){
return renewToken()},timeout)):void 0},renewToken=function(){var currentTime,diff,iFrame,lastUpdate,tokenExpiredIn;return tokenExpiredIn=getTokenExpiredIn(),tokenExpiredIn>defaultConfigs.min_live_time?void renewTokenAfter(defaultConfigs.check_token_interval):$window.localStorage.refresh_locked&&(currentTime=(new Date).getTime(),lastUpdate=null!=$window.localStorage.refresh_last_update?Date.parse($window.localStorage.refresh_last_update):null,lastUpdate>0&&(diff=currentTime-lastUpdate,diff>0&&diff<=defaultConfigs.refresh_max_wait))?void renewTokenAfter(defaultConfigs.refresh_checklock_interval):($window.localStorage.refresh_locked=!0,$window.localStorage.refresh_last_update=new Date,removeOAuthFrame(),null!=updateProgressTask&&($interval.cancel(updateProgressTask),updateProgressTask=void 0),updateProgressTask=$interval(function(){return $window.localStorage.refresh_last_update=new Date},1e3),iFrame=document.createElement("iframe"),iFrame.setAttribute("src",buildAuthorizationUrl({auto_refresh:"true"})),iFrame.setAttribute("id","oauth_frame"),iFrame.style.display="none",document.body.appendChild(iFrame),$log.debug("Refreshing access token using iFrame"),renewTokenAfter(defaultConfigs.check_token_interval))},isNoAuthPage=function(toState,toParams){return defaultConfigs.is_no_auth_page(toState,toParams)},changePassword=function(oldPassword,newPassword){var defer,params;if(null==defaultConfigs.changePasswordEndpoint||0===defaultConfigs.changePasswordEndpoint.length)throw new Error("Please config 'changePasswordEndpoint' before use this function");return defer=$q.defer(),params={newPassword:newPassword,oldPassword:oldPassword},$http.put(defaultConfigs.changePasswordEndpoint,params).success(function(data){return $rootScope.$broadcast("PasswordChanged"),defer.resolve(data)}).error(function(error){return defer.reject(error)}),defer.promise};for(key in defaultConfigs)defaultConfigs[key]===REQUIRED_AND_MISSING&&requiredAndMissing.push(key);if(requiredAndMissing.length>0)throw new Error("TokenProvider is insufficiently configured. Please configure the following options using $tokenProvider.extendConfig: "+requiredAndMissing.join(", "));return isOAuthFrame()||(wrap=function(event){var newToken,oldToken;return"access_token"===event.key&&event.newValue!==event.oldValue?(oldToken=event.oldValue,newToken=event.newValue,updateProgressTask&&($interval.cancel(updateProgressTask),updateProgressTask=void 0,$window.localStorage.refresh_locked=void 0,$window.localStorage.refresh_last_update=void 0),$rootScope.$broadcast("TokenChanged",oldToken,newToken)):void 0},$window.addEventListener?$window.addEventListener("storage",wrap,!1):$window.attachEvent("onstorage",wrap),getAccessToken()&&setTimeoutToRefresh()),{login:login,logout:logout,isNoAuthPage:isNoAuthPage,getAccessToken:getAccessToken,extendConfig:this.extendConfig,clearToken:clearToken,verifyToken:verifyToken,setTokenFromLocation:setTokenFromLocation,clearUserInfo:clearUserInfo,getUserInfo:getUserInfo,setUserInfo:setUserInfo,getUserLanguage:getUserLanguage,setUserLanguage:setUserLanguage,isOAuthFrame:isOAuthFrame,getRoleCode:getRoleCode,getModules:getModules,changePassword:changePassword}}]}}).config(["$httpProvider",function($httpProvider){return $httpProvider.interceptors.push(["$injector",function($injector){return{request:function(config){return config.headers=config.headers||{},$injector.invoke(["$token",function($token){return null!=$token.getAccessToken()?config.headers.Authorization="Bearer "+$token.getAccessToken():void 0}]),config},responseError:function(resp){return 401===resp.status&&$injector.invoke(["$token",function($token){return $token.clearToken(),$token.clearUserInfo(),$token.login()}]),-1===resp.status&&$injector.invoke(["$state",function($state){return $state.go("500")}]),$injector.get("$q").reject(resp)}}}])}]).run(["$rootScope","$log","$location","$state","$token",function($rootScope,$log,$location,$state,$token){return $rootScope.$on("$locationChangeStart",function(event){var search;return search=$location.search(),null!=search&&null!=search.access_token?($token.setTokenFromLocation(),event.preventDefault()):void 0}),$rootScope.$on("$stateChangeStart",function(event,toState,toParams,fromState,fromParams){var access_token,promise,tokenVerified;if($token.isOAuthFrame())return void event.preventDefault();if(!$token.isNoAuthPage(toState)){if(access_token=$token.getAccessToken(),tokenVerified=$rootScope.tokenVerified,null!=access_token)return null!=$token.getUserInfo()&&tokenVerified?$rootScope.$broadcast("$stateChangeStart:tokenVerified",toState,fromState,event):(promise=$token.verifyToken(),promise.then(function(){return $rootScope.tokenVerified=!0,$rootScope.$broadcast("$stateChangeStart:tokenVerified",toState,fromState,event)},function(error){return event.preventDefault(),null==error||401!==error.status?$rootScope.$broadcast("$token:failToVerifyToken"):void 0}));if(event.preventDefault(),null!=$rootScope.preventOtherLogin&&$rootScope.preventOtherLogin)return;return $token.login(),$rootScope.preventOtherLogin=!0}})}])}.call(this),function(){"use strict";angular.module("app.state",[]).constant("CATEGORY_LIST_TEMPLATE","views/common/category-list.html").constant("CATEGORY_POPUP_TEMPLATE","views/common/category-popup.html").constant("CATEGORY_POPUP_CTRL","NameCategoryPopupCtrl").controller("HomeCtrl",["$scope","$state","$token","HOME_STATE",function($scope,$state,$token,HOME_STATE){var home,roleCode;return null!=$token?(roleCode=$token.getRoleCode(),null!=roleCode?(home=HOME_STATE[roleCode],null!=home?$state.go(home):$state.go("550")):void 0):void 0}]).config(["$stateProvider","$urlRouterProvider","STATES","CATEGORY_LIST_TEMPLATE",function($stateProvider,$urlRouterProvider,STATES,CATEGORY_LIST_TEMPLATE){var addState,getTemplateUrl,state,_i,_len,_results;if($urlRouterProvider.when("","/home"),$urlRouterProvider.otherwise(function($injector,$location){var $state;return $state=$injector.get("$state"),"/"===$location.url()?$state.go("home"):$state.go("404")}),$stateProvider.state("home",{url:"/home",controller:"HomeCtrl"}),$stateProvider.state("callback",{url:"/callback"}),$stateProvider.state("404",{url:"/404",templateUrl:"views/pages/404.html"}),$stateProvider.state("500",{url:"/500",templateUrl:"views/pages/500.html"}),$stateProvider.state("550",{url:"/550",templateUrl:"views/pages/550.html"}),getTemplateUrl=function(url){switch(url){case"CATEGORY_LIST_TEMPLATE":return CATEGORY_LIST_TEMPLATE;default:return url}},addState=function(state){var url;return null!=state&&null!=state.name?(url=null!=state.url?state.url:"/"+state.name,$stateProvider.state(state.name,{url:url+"?filter&id&parent&parentFilter",templateUrl:getTemplateUrl(state.templateUrl),controller:state.controller})):void 0},null!=STATES&&STATES.length>0){for(_results=[],_i=0,_len=STATES.length;_len>_i;_i++)state=STATES[_i],_results.push(addState(state));return _results}}]).run(["$rootScope","$location","$state","$token","STATES","MENUS","HOME_STATE",function($rootScope,$location,$state,$token,STATES,MENUS,HOME_STATE){return $rootScope.$on("$stateChangeStart:tokenVerified",function(event,toState,fromState,parentEvent){var isValid,module,modules,roleCode,state,stateName,_i,_j,_len,_len1,_ref;if(roleCode=null!=$token?$token.getRoleCode():null,modules=null!=$token?$token.getModules():null,null!=toState&&null!=toState.name){if("home"===toState.name)return;if(stateName=toState.name,"404"===stateName||"500"===stateName||"550"===stateName)return;for(isValid=!1,_i=0,_len=STATES.length;_len>_i;_i++)if(state=STATES[_i],state.name===stateName){if(_.indexOf(state.roles,roleCode)>-1)if(null!=state.modules&&state.modules.length>0){for(_ref=state.modules,_j=0,_len1=_ref.length;_len1>_j;_j++)if(module=_ref[_j],null!=modules&&_.indexOf(modules,module)>-1){isValid=!0;break}}else isValid=!0;break}if(!isValid)return event.preventDefault(),parentEvent.preventDefault(),$state.go("404")}}),$rootScope.$on("$token:failToVerifyToken",function(){return $state.go("500")})}])}.call(this),function(){"use strict";angular.module("app").controller("LangCtrl",["$scope","$translate","$token",function($scope,$translate,$token){return $scope.lang=$translate.use(),$scope.$watch(function(){return $translate.use()},function(newLang){return $scope.lang=newLang}),$scope.setLang=function(lang){return $translate.use(lang),$scope.lang=lang,$token.setUserLanguage(lang)},$scope.getFlag=function(){var lang;switch(lang=$scope.lang){case"vi":return"flags-vietnam";case"zh":return"flags-china";default:return"flags-british"}},$scope.isSupportedLanguage=function(lang){var userInfo;return null!=$token&&(userInfo=$token.getUserInfo(),null!=userInfo&&null!=userInfo.languages)?_.includes(userInfo.languages,lang):!1},$scope.isShowLangInDropDown=function(lang){return!(!$scope.isSupportedLanguage(lang)||$scope.lang===lang)}}])}.call(this),function(){"use strict";angular.module("app").controller("ChangePasswordCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","toast","$filter","$token",function($scope,CtrlUtilsService,CtrlInitiatorService,toast,$filter,$token){return $scope.title="",CtrlInitiatorService.initBasicViewCtrl($scope),$scope.save=function(){var status;return $scope.isFormValid("form")?$scope.record.newPassword!==$scope.record.newPassword2?toast.logError($filter("translate")("error.new.password.not.match")):(status=$scope.loadStatus.getStatusByDataName("data"),status.processing=!0,$token.changePassword($scope.record.oldPassword,$scope.record.newPassword).then(function(){return status.processing=!1,toast.logSuccess($filter("translate")("save.success")),$scope.refresh()},function(error){return status.processing=!1,400===error.status?toast.logError($filter("translate")(error.data.meta.error_message)):toast.logError($filter("translate")("save.error"))})):toast.logError($filter("translate")("error.data.input.not.valid"))},$scope.addInitFunction(function(){return $scope.record={}}),$scope.init()}])}.call(this),function(){"use strict";var CtrlInitiatorService,__slice=[].slice;CtrlInitiatorService=function(){function CtrlInitiatorService($log,$filter,toast,$modal,$state,$stateParams,CtrlUtilsService,LoadingUtilsService,$confirm){this.$log=$log,this.$filter=$filter,this.toast=toast,this.$modal=$modal,this.$state=$state,this.$stateParams=$stateParams,this.CtrlUtilsService=CtrlUtilsService,this.LoadingUtilsService=LoadingUtilsService,this.$confirm=$confirm}return CtrlInitiatorService.prototype.initBasicViewCtrl=function($scope){var _ref,_ref1,_ref2,_ref3,_ref4,_this;return _this=this,$scope.isEmpty=null!=(_ref=$scope.isEmpty)?_ref:function(){return!1},$scope.isOnePage=null!=(_ref1=$scope.isOnePage)?_ref1:function(){return!1},$scope.initFunctions=null!=(_ref2=$scope.initFunctions)?_ref2:[],$scope.addInitFunction=function(initFunction,name){if(!jQuery.isFunction(initFunction))throw"initFunction cannot null and must be a function";return null==name?$scope.initFunctions.push({"function":initFunction,name:null}):_.findIndex($scope.initFunctions,function(o){return null!=o.name&&o.name===name})<0?$scope.initFunctions.push({"function":initFunction,name:name}):void 0},$scope.init=function(){var container,_i,_len,_ref3,_results;for(_ref3=$scope.initFunctions,_results=[],_i=0,_len=_ref3.length;_len>_i;_i++)container=_ref3[_i],_results.push(container["function"]());return _results},$scope.refresh=null!=(_ref3=$scope.refresh)?_ref3:function(){return $scope.init()},$scope.isFormValid=function(formName){var _scope;for(_scope=$scope;null!=_scope;){if(null!=_scope[formName])return _scope[formName].$valid;_scope=_scope.$$childHead}return!1},$scope.who=null!=(_ref4=$scope.who)?_ref4:_this.CtrlUtilsService.getWho(),$scope.isLoading=function(){return $scope.loadStatus.isProcessing()&&!$scope.loadStatus.isError()},$scope.isError=function(){return $scope.loadStatus.isError()},$scope.isDisplayContent=function(){return!($scope.isLoading()||$scope.isError())},$scope.addInitFunction(function(){return $scope.loadStatus=_this.CtrlUtilsService.createLoadStatus("data")},"basic-view")},CtrlInitiatorService.prototype.initFilterViewCtrl=function($scope,defaultFilter){var b64_to_object,b64_to_utf8,object_to_b64,utf8_to_b64,_this;return _this=this,_this.initBasicViewCtrl($scope),utf8_to_b64=function(str){return str=window.btoa(unescape(encodeURIComponent(str))),str=str.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,"")},b64_to_utf8=function(str){return str.length%4===3?str+="=":str.length%4===2?str+="==":str.length%4===1&&(str+="==="),str=str.replace(/-/g,"+").replace(/_/g,"/"),decodeURIComponent(escape(window.atob(str)))},object_to_b64=function(object){return null!=object?utf8_to_b64(JSON.stringify(object)):null},b64_to_object=function(str,onError){var error;if(null!=str)try{return JSON.parse(b64_to_utf8(str))}catch(_error){error=_error,_this.$log.log(error),jQuery.isFunction(onError)&&onError()}return null},$scope.convertFilterAsString=function(filter){return object_to_b64(filter)},$scope.getFilterAsString=function(){return $scope.convertFilterAsString($scope.filter)},$scope.reloadForNewFilter=function(){return _this.$state.go(".",{filter:$scope.getFilterAsString()},{reload:!0})},$scope.addInitFunction(function(){var key,_results;if($scope.filter=b64_to_object(_this.$stateParams.filter,function(){return _this.$state.go("404")}),null==$scope.filter)return $scope.filter=null!=defaultFilter?defaultFilter:{};if(null!=defaultFilter){_results=[];for(key in defaultFilter)null==$scope.filter[key]?_results.push($scope.filter[key]=angular.copy(defaultFilter[key])):_results.push(void 0);return _results}},"filter-view")},CtrlInitiatorService.prototype.initPagingFilterViewCtrl=function($scope){var defaultFilter,_ref,_this;if(_this=this,!jQuery.isFunction($scope.getReloadDataParams))throw"must implement $scope.getReloadDataParams";return defaultFilter={currentPage:1,itemsPerPage:10},_this.initFilterViewCtrl($scope,defaultFilter),$scope.pageChange=function(){return $scope.loaded?($scope.filter.currentPage=$scope.pagingData.currentPage,$scope.reloadForNewFilter()):void 0},$scope.afterLoad=null!=(_ref=$scope.afterLoad)?_ref:function(){},$scope.reloadData=function(){var params;return $scope.pagingData={pagingMaxSize:5},params={who:$scope.who,page:$scope.filter.currentPage,size:$scope.filter.itemsPerPage},params=$scope.getReloadDataParams(params),null==params?$scope.loaded=!0:($scope.loaded=!1,_this.CtrlUtilsService.loadListData(params,$scope.loadStatus.getStatusByDataName("data"),function(records,count){var newPage;return _.isEmpty(records)&&count>0&&params.page>1?(newPage=Math.floor(count/$scope.filter.itemsPerPage),newPage+=count%$scope.filter.itemsPerPage>0?1:0,$scope.filter.currentPage=newPage,$scope.loaded=!0,$scope.reloadForNewFilter()):($scope.records=records,$scope.pagingData.count=count,$scope.pagingData.currentPage=$scope.filter.currentPage,$scope.pagingData.itemsPerPage=$scope.filter.itemsPerPage,$scope.afterLoad(records,count),$scope.loaded=!0)},function(error){return 400===error.status?_this.$state.go("404"):_this.toast.logError(_this.$filter("translate")("loading.error"))}))},$scope.isEmpty=function(){return _.isEmpty($scope.records)},$scope.isOnePage=function(){return null!=$scope.pagingData&&null!=$scope.pagingData.count&&null!=$scope.pagingData.itemsPerPage&&$scope.pagingData.count<=$scope.pagingData.itemsPerPage},$scope.addInitFunction(function(){return $scope.filter.currentPage<1&&($scope.filter.currentPage=defaultFilter.currentPage),$scope.filter.itemsPerPage<=0&&($scope.filter.itemsPerPage=defaultFilter.itemsPerPage),$scope.loaded=!1,$scope.pagingData={pagingMaxSize:5}},"paging-filter-view")},CtrlInitiatorService.prototype.initCanSaveViewCtrl=function($scope){var _ref,_save,_this;if(_this=this,!jQuery.isFunction($scope.checkBeforeSave))throw"must implement $scope.checkBeforeSave";if(!jQuery.isFunction($scope.getObjectToSave))throw"must implement $scope.getObjectToSave";if(!jQuery.isFunction($scope.getSaveParams))throw"must implement $scope.getSaveParams";if(!jQuery.isFunction($scope.onSaveSuccess))throw"must implement $scope.onSaveSuccess";if(!jQuery.isFunction($scope.onSaveFailure))throw"must implement $scope.onSaveFailure";if(!jQuery.isFunction($scope.isPost))throw"must implement $scope.isPost";return _this.initBasicViewCtrl($scope),$scope.confirmOnSave=null!=(_ref=$scope.confirmOnSave)?_ref:function(){return null},$scope.isChanged=function(){return null!=$scope.changeStatus&&$scope.changeStatus.isChanged},$scope.isDisplaySaveBtn=function(){return $scope.isChanged()},$scope.refresh=function(){return $scope.isDisplaySaveBtn()?_this.$confirm({text:_this.$filter("translate")("confirm.dialog.are.you.sure.refresh")}).then(function(){return $scope.init()}):$scope.init()},_save=function(){var loadStatusOfData,onFailure,onSuccess,params,requestBody;return loadStatusOfData=$scope.loadStatus.getStatusByDataName("save"),requestBody=$scope.getObjectToSave(),params={who:$scope.who},params=$scope.getSaveParams(params),onSuccess=function(data){return $scope.changeStatus.reset(),$scope.onSaveSuccess(data)},onFailure=function(error){return $scope.onSaveFailure(error)},$scope.isPost()?_this.CtrlUtilsService.doPost(params,loadStatusOfData,requestBody,onSuccess,onFailure,"save"):_this.CtrlUtilsService.doPut(params,loadStatusOfData,requestBody,onSuccess,onFailure,"save")},$scope.save=function(){var confirmOnSave;return $scope.checkBeforeSave()?(confirmOnSave=$scope.confirmOnSave(),null!=confirmOnSave?_this.$confirm(confirmOnSave.data,confirmOnSave.settings).then(function(){return _save()}):_save()):void 0},$scope.addInitFunction(function(){return $scope.changeStatus=_this.CtrlUtilsService.createChangeStatus()},"can-save-view")},CtrlInitiatorService.prototype.initCanBackViewCtrl=function($scope){var _this;if(_this=this,null==$scope.defaultBackState)throw"must set value $scope.defaultBackState";return _this.initBasicViewCtrl($scope),$scope.isDisplayBackBtn=function(){return!0},null==$scope.getParentFilter&&($scope.getParentFilter=function(){var _ref;return null!=(_ref=_this.$stateParams.parentFilter)?_ref:_this.$stateParams.filter}),$scope.back=function(){var backState,backStateFilter,_ref;return backState=null!=(_ref=_this.$stateParams.parent)?_ref:$scope.defaultBackState,backStateFilter=$scope.getParentFilter(),jQuery.isFunction($scope.isChanged)&&$scope.isChanged()?_this.$confirm({text:_this.$filter("translate")("confirm.dialog.are.you.sure.back")}).then(function(){return _this.$state.go(backState,{filter:backStateFilter})}):_this.$state.go(backState,{filter:backStateFilter})}},CtrlInitiatorService.prototype.initUseDatePickerCtrl=function($scope){var _this;return _this=this,_this.initBasicViewCtrl($scope),$scope.createDatePickerModel=function(date){var model;return model={date:date,opened:!1},$scope.datePickerModels.push(model),model},$scope.removeDatePickerModel=function(model){return null!=model?$scope.datePickerModels.splice(_.indexOf($scope.datePickerModels,model),1):void 0},$scope.open=function($event,model){var otherModel,_i,_len,_ref,_results;if(jQuery.isFunction($scope.onOpenDatePicker)&&$scope.onOpenDatePicker(model),$event.preventDefault(),$event.stopPropagation(),null!=model){for(model.opened=!0,_ref=$scope.datePickerModels,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)otherModel=_ref[_i],null!=otherModel&&otherModel!==model&&_results.push(otherModel.opened=!1);return _results}},$scope.dateOptions={"year-format":"yy","starting-day":1},$scope.dateFormat=_this.CtrlUtilsService.getUserInfo().dateFormat,$scope.addInitFunction(function(){return $scope.datePickerModels=[]},"use-date-view")},CtrlInitiatorService}(),angular.module("app").service("CtrlInitiatorService",["$log","$filter","toast","$modal","$state","$stateParams","CtrlUtilsService","LoadingUtilsService","$confirm",CtrlInitiatorService]),window.ListenerContainer=function(){function ListenerContainer(){this.container={}}return ListenerContainer.prototype.addListener=function(name,callback){var listeners;return listeners=this.container[name],null==listeners&&(listeners=[],this.container[name]=listeners),listeners.push(callback)},ListenerContainer.prototype.executeCallback=function(){var args,listener,listenerName,listeners,value,_i,_len;if(listenerName=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[],listeners=this.container[listenerName],null!=listeners)for(_i=0,_len=listeners.length;_len>_i;_i++)if(listener=listeners[_i],value=listener.apply(this,args),null!==value&&value===!1)return!1;return!0},ListenerContainer.prototype.getContainer=function(){return this.container},ListenerContainer.prototype.merge=function(listenerContainer){var listener,listenerName,listeners,_container,_results;if(null!=listenerContainer&&(_container=listenerContainer.getContainer(),null!=_container)){_results=[];for(listenerName in _container)listeners=_container[listenerName],_results.push(function(){var _i,_len,_results1;for(_results1=[],_i=0,_len=listeners.length;_len>_i;_i++)listener=listeners[_i],_results1.push(this.addListener(listenerName,listener));return _results1}.call(this));return _results}},ListenerContainer}()}.call(this),function(){"use strict";var CtrlCategoryInitiatorService;CtrlCategoryInitiatorService=function(){function CtrlCategoryInitiatorService($log,$filter,toast,$modal,$state,$stateParams,CtrlUtilsService,LoadingUtilsService,CATEGORY_POPUP_TEMPLATE,CATEGORY_POPUP_CTRL,$confirm,CtrlInitiatorService){this.$log=$log,this.$filter=$filter,this.toast=toast,this.$modal=$modal,this.$state=$state,this.$stateParams=$stateParams,this.CtrlUtilsService=CtrlUtilsService,this.LoadingUtilsService=LoadingUtilsService,this.CATEGORY_POPUP_TEMPLATE=CATEGORY_POPUP_TEMPLATE,this.CATEGORY_POPUP_CTRL=CATEGORY_POPUP_CTRL,this.$confirm=$confirm,this.CtrlInitiatorService=CtrlInitiatorService}return CtrlCategoryInitiatorService.prototype.initCategoryListViewCtrl=function($scope){var openDetailPopup,_ref,_ref1,_ref2,_ref3,_ref4,_ref5,_ref6,_this;if(_this=this,null==$scope.title)throw"must set value $scope.title";if(null==$scope.categoryName)throw"must set value $scope.categoryName";if(null==$scope.usePopup)throw"must set value $scope.usePopup";if(!jQuery.isFunction($scope.isUseDistributorFilter))throw"must implement $scope.isUseDistributorFilter";return $scope.columns=null!=(_ref=$scope.columns)?_ref:[{header:"name",property:"name"}],$scope.usePopup?($scope.popupTemplateUrl=null!=(_ref1=$scope.popupTemplateUrl)?_ref1:_this.CATEGORY_POPUP_TEMPLATE,$scope.popupCtrl=null!=(_ref2=$scope.popupCtrl)?_ref2:_this.CATEGORY_POPUP_CTRL):$scope.detailState=null!=(_ref3=$scope.detailState)?_ref3:_this.$state.get(".").name+"-detail",$scope.useDeleteButton=null!=(_ref4=$scope.useDeleteButton)?_ref4:!0,$scope.useEnableButton=null!=(_ref5=$scope.useEnableButton)?_ref5:!0,$scope.useActivateButton=null!=(_ref6=$scope.useActivateButton)?_ref6:!0,$scope.isDisplayImportBtn=function(){return null!=$scope.importState},$scope.goToImport=function(){return _this.$state.go($scope.importState,{filter:_this.$stateParams.filter})},$scope.distributorFilterChange=function(){return $scope.filter.searchText=null,$scope.searchFilterChange()},$scope.searchFilterChange=function(){return $scope.filter.currentPage=1,$scope.pageChange()},$scope.getPropertyValue=function(column,record){return null!=column&&null!=column.property?"function"==typeof column.property?column.property(record):record[column.property]:""},$scope.enableRecord=function(record){var action,onSuccess,params,status;return action="enable",status=$scope.loadStatus.getStatusByDataName(action),params={who:$scope.who,category:$scope.categoryName,id:record.id,action:action},onSuccess=function(){return $scope.refresh()},_this.CtrlUtilsService.doPut(params,status,null,onSuccess,null,action)},$scope.changeActiveState=function(record){var action,onSuccess,params,status;return action=record.active?"deactivate":"activate",status=$scope.loadStatus.getStatusByDataName(action),params={who:$scope.who,category:$scope.categoryName,id:record.id,action:action},onSuccess=function(){return $scope.refresh()},_this.CtrlUtilsService.doPut(params,status,null,onSuccess,null,action)},$scope.deleteRecord=function(record){var onSuccess,params,status;return status=$scope.loadStatus.getStatusByDataName("data"),params={who:$scope.who,category:$scope.categoryName,id:record.id},onSuccess=function(){return $scope.refresh()},_this.CtrlUtilsService.doDelete(params,status,onSuccess,null)},openDetailPopup=function(id){var modalInstance;return modalInstance=_this.$modal.open({templateUrl:$scope.popupTemplateUrl,controller:$scope.popupCtrl,resolve:{title:function(){return $scope.title},categoryName:function(){return $scope.categoryName},id:function(){return id},useDistributorFilter:function(){return $scope.isUseDistributorFilter()}},backdrop:!0}),modalInstance.result.then(function(){return $scope.refresh()})},$scope.createRecord=function(){return $scope.usePopup?openDetailPopup(null):_this.$state.go($scope.detailState)},$scope.editRecord=function(record){return $scope.usePopup?openDetailPopup(record.id):_this.$state.go($scope.detailState,{id:record.id,filter:$scope.getFilterAsString()})},$scope.getReloadDataParams=function(params){return params=null!=params?params:{},params.category=$scope.categoryName,null!=$scope.subCategory&&(params.subCategory=$scope.subCategory),$scope.isUseDistributorFilter()&&null!=$scope.filter.distributorId&&"all"!==$scope.filter.distributorId&&(params.distributorId=$scope.filter.distributorId),_.isEmpty($scope.filter.searchText)||(params.q=$scope.filter.searchText),params},_this.CtrlInitiatorService.initPagingFilterViewCtrl($scope),$scope.addInitFunction(function(){return $scope.isUseDistributorFilter()?_this.LoadingUtilsService.loadDistributors($scope.who,$scope.loadStatus.getStatusByDataName("distributors"),function(list){var distributor,_ref7;return $scope.isBigData?($scope.distributors=list,null==$scope.filter.distributorId&&$scope.distributors.length>0&&($scope.filter.distributorId=$scope.distributors[0].id)):($scope.distributors=_.union([{id:"all",name:"-- "+_this.$filter("translate")("all")+" --"}],list),$scope.filter.distributorId=null!=(_ref7=$scope.filter.distributorId)?_ref7:"all"),$scope.distributors.length>0?null!=$scope.filter.distributorId?(distributor=_.find($scope.distributors,function(distributor){return distributor.id===$scope.filter.distributorId}),null!=distributor?$scope.reloadData():_this.$state.go("404")):$scope.reloadData():void 0}):$scope.reloadData()},"category-list-view")},CtrlCategoryInitiatorService.prototype.initCategoryDetailViewCtrl=function($scope){var afterAction,currentCheckBeforeSave,_ref,_ref1,_this;if(_this=this,null==$scope.title)throw"must set value $scope.title";if(null==$scope.categoryName)throw"must set value $scope.categoryName";if(!jQuery.isFunction($scope.isIdRequire))throw"must implement $scope.isIdRequire";if($scope.useMap=null!=(_ref=$scope.useMap)?_ref:!1,$scope.useMap){if(!jQuery.isFunction($scope.getLocation))throw"must implement $scope.getLocation";$scope.firstLoadDone=!1,$scope.$on("locationSelectorReady",function(){return $scope.firstLoadDone?$scope.$broadcast("refreshLocationSelector",{id:null,location:$scope.getLocation()}):void 0})}return $scope.isNew=function(){return $scope.isIdRequire()&&null==_this.$stateParams.id},$scope.isEdit=function(){return!$scope.isNew()},$scope.isDraft=function(){return!(null!=$scope.record&&null!=$scope.record.draft&&!$scope.record.draft)},afterAction=function(data){var _newStateParam;return $scope.isNew()?(_newStateParam=angular.copy(_this.$stateParams),_newStateParam.id=data.id,_this.$state.go(".",_newStateParam)):$scope.refresh()},currentCheckBeforeSave=$scope.checkBeforeSave,$scope.checkBeforeSave=function(){return $scope.isFormValid("form")?!(jQuery.isFunction(currentCheckBeforeSave)&&!currentCheckBeforeSave()):(_this.toast.logError(_this.$filter("translate")("error.data.input.not.valid")),!1)},$scope.getObjectToSave=null!=(_ref1=$scope.getObjectToSave)?_ref1:function(){return $scope.record},$scope.getSaveParams=function(params){return params.category=$scope.categoryName,$scope.isNew()||(params.id=_this.$stateParams.id),params},$scope.onSaveSuccess=function(data){return afterAction(data)},$scope.onSaveFailure=function(){},$scope.isPost=function(){return $scope.isNew()},$scope.enable=function(){var loadStatusOfData,onFailure,onSuccess,params,requestBody;return!$scope.isChanged()||$scope.checkBeforeSave()?(loadStatusOfData=$scope.loadStatus.getStatusByDataName("enable"),requestBody=null,$scope.isChanged()&&(requestBody=$scope.getObjectToSave()),params={who:$scope.who},params=$scope.getSaveParams(params),params.action="enable",onSuccess=function(data){return $scope.changeStatus.reset(),$scope.onSaveSuccess(data)},onFailure=function(error){return $scope.onSaveFailure(error)},$scope.isPost()?_this.CtrlUtilsService.doPost(params,loadStatusOfData,requestBody,onSuccess,onFailure,"enable"):_this.CtrlUtilsService.doPut(params,loadStatusOfData,requestBody,onSuccess,onFailure,"enable")):void 0},_this.CtrlInitiatorService.initCanSaveViewCtrl($scope),$scope.isIdRequire()&&_this.CtrlInitiatorService.initCanBackViewCtrl($scope),$scope.reloadData=function(){var params;return $scope.isNew()?($scope.record={},jQuery.isFunction($scope.onLoadSuccess)?$scope.onLoadSuccess($scope.record):void 0):(params={who:$scope.who,category:$scope.categoryName},$scope.isIdRequire()&&(params.id=_this.$stateParams.id),_this.CtrlUtilsService.loadSingleData(params,$scope.loadStatus.getStatusByDataName("data"),function(record){return $scope.record=record,$scope.useMap&&($scope.$broadcast("refreshLocationSelector",{id:null,location:$scope.getLocation()}),$scope.firstLoadDone=!0),jQuery.isFunction($scope.onLoadSuccess)?$scope.onLoadSuccess($scope.record):void 0},function(error){return jQuery.isFunction($scope.onLoadFailure)&&$scope.onLoadFailure(error),400===error.status?_this.$state.go("404"):_this.toast.logError(_this.$filter("translate")("loading.error"))}))},$scope.addInitFunction(function(){return $scope.reloadData()},"category-detail-view")},CtrlCategoryInitiatorService.prototype.initCategoryDetailPopupCtrl=function($scope,$modalInstance){var afterAction,currentCheckBeforeSave,_ref,_this;if(_this=this,null==$scope.title)throw"must set value $scope.title";if(null==$scope.categoryName)throw"must set value $scope.categoryName";if(!jQuery.isFunction($scope.isIdRequire))throw"must implement $scope.isIdRequire";if(!jQuery.isFunction($scope.isUseDistributorFilter))throw"must implement $scope.isUseDistributorFilter";return $scope.isNew=function(){return $scope.isIdRequire()&&null==$scope.id},$scope.isEdit=function(){return!$scope.isNew()},$scope.isDraft=function(){return!(null!=$scope.record&&null!=$scope.record.draft&&!$scope.record.draft)},$scope.cancel=function(){return $modalInstance.dismiss("cancel")},afterAction=function(){return $modalInstance.close()},currentCheckBeforeSave=$scope.checkBeforeSave,$scope.checkBeforeSave=function(){return $scope.isFormValid("form")?!(jQuery.isFunction(currentCheckBeforeSave)&&!currentCheckBeforeSave()):(_this.toast.logError(_this.$filter("translate")("error.data.input.not.valid")),!1)},$scope.getObjectToSave=null!=(_ref=$scope.getObjectToSave)?_ref:function(){return $scope.record},$scope.getSaveParams=function(params){return params.category=$scope.categoryName,$scope.isNew()||(params.id=$scope.id),params},$scope.onSaveSuccess=function(){return afterAction()},$scope.onSaveFailure=function(){},$scope.isPost=function(){return $scope.isNew()},$scope.enable=function(){var loadStatusOfData,onFailure,onSuccess,params,requestBody;return!$scope.isChanged()||$scope.checkBeforeSave()?(loadStatusOfData=$scope.loadStatus.getStatusByDataName("enable"),requestBody=null,$scope.isChanged()&&(requestBody=$scope.getObjectToSave()),params={who:$scope.who},params=$scope.getSaveParams(params),params.action="enable",onSuccess=function(data){return $scope.changeStatus.reset(),$scope.onSaveSuccess(data)},onFailure=function(error){return $scope.onSaveFailure(error);
},$scope.isPost()?_this.CtrlUtilsService.doPost(params,loadStatusOfData,requestBody,onSuccess,onFailure,"enable"):_this.CtrlUtilsService.doPut(params,loadStatusOfData,requestBody,onSuccess,onFailure,"enable")):void 0},_this.CtrlInitiatorService.initCanSaveViewCtrl($scope),$scope.reloadData=function(){var params;return params={who:$scope.who,category:$scope.categoryName},$scope.isIdRequire()&&(params.id=$scope.id),$scope.isNew()?($scope.record={},$scope.isUseDistributorFilter()?_this.LoadingUtilsService.loadDistributors($scope.who,$scope.loadStatus.getStatusByDataName("distributors"),function(list){return $scope.distributors=list}):void 0):_this.CtrlUtilsService.loadSingleData(params,$scope.loadStatus.getStatusByDataName("data"),function(record){return $scope.record=record,null!=$scope.record.distributor?$scope.record.distributorId=$scope.record.distributor.id:void 0},function(error){return 400===error.status?_this.$state.go("404"):_this.toast.logError(_this.$filter("translate")("loading.error"))})},$scope.addInitFunction(function(){return $scope.reloadData()},"category-detail-popup")},CtrlCategoryInitiatorService}(),angular.module("app").service("CtrlCategoryInitiatorService",["$log","$filter","toast","$modal","$state","$stateParams","CtrlUtilsService","LoadingUtilsService","CATEGORY_POPUP_TEMPLATE","CATEGORY_POPUP_CTRL","$confirm","CtrlInitiatorService",CtrlCategoryInitiatorService])}.call(this),function(){"use strict";angular.module("app").controller("NameCategoryPopupCtrl",["$scope","CtrlCategoryInitiatorService","$modalInstance","title","categoryName","id","useDistributorFilter",function($scope,CtrlCategoryInitiatorService,$modalInstance,title,categoryName,id,useDistributorFilter){return $scope.title=title,$scope.categoryName=categoryName,$scope.id=id,$scope.isIdRequire=function(){return!0},$scope.isUseDistributorFilter=function(){return null!=useDistributorFilter?useDistributorFilter:!1},CtrlCategoryInitiatorService.initCategoryDetailPopupCtrl($scope,$modalInstance),$scope.init()}]).controller("NameCodeCategoryPopupCtrl",["$scope","CtrlCategoryInitiatorService","$modalInstance","title","categoryName","id","useDistributorFilter",function($scope,CtrlCategoryInitiatorService,$modalInstance,title,categoryName,id,useDistributorFilter){return $scope.title=title,$scope.categoryName=categoryName,$scope.id=id,$scope.isIdRequire=function(){return!0},$scope.isUseDistributorFilter=function(){return null!=useDistributorFilter?useDistributorFilter:!1},$scope.useCode=!0,CtrlCategoryInitiatorService.initCategoryDetailPopupCtrl($scope,$modalInstance),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("PhotoPopupCtrl",["$scope","$modalInstance","title","subTitle","photoLink","$filter",function($scope,$modalInstance,title,subTitle,photoLink,$filter){return $scope.title=null!=title?$filter("translate")(title):null,$scope.subTitle=null!=subTitle?$filter("translate")(subTitle):null,$scope.photoLink=photoLink,$scope.isDisplayFooter=function(){return $scope.isDisplayTitle()||$scope.isDisplaySubTitle()},$scope.isDisplayTitle=function(){return null!=$scope.title},$scope.isDisplaySubTitle=function(){return null!=$scope.subTitle},$scope.cancel=function(){return $modalInstance.dismiss("cancel")}}])}.call(this),function(){"use strict";angular.module("app").constant("DEFAULT_LANGUAGE","en").constant("NG_IDLE_MAX_IDLE_TIME",1800).constant("NG_IDLE_TIMEOUT",8).constant("NG_IDLE_PING_INTEVAL",600)}.call(this),function(){"use strict";angular.module("app").constant("HOME_STATE",{SUPER:"system-config",SUPPORTER:"client",AD:"dashboard",OBS:"dashboard",SUP:"dashboard",DIS:"order-pending"}).constant("MENUS",[{name:"system.config.title",href:"#/system-config",icon:"fa fa-cog",roles:["SUPER"]},{name:"client.title",href:"#/client",icon:"fa fa-building",roles:["SUPER","SUPPORTER"]},{name:"system.action.title",href:"#/system-action",icon:"fa fa-hourglass-half",roles:["SUPER"]},{name:"dashboard.menu",href:"#/dashboard",icon:"fa fa-dashboard",roles:["AD","OBS","SUP"]},{name:"system.menu",icon:"fa fa-cogs",roles:["AD"],children:[{name:"user.title",href:"#/user",roles:["AD"]},{name:"distributor.title",href:"#/distributor",roles:["AD"]},{name:"client.config.title",href:"#/client-config",roles:["AD"]},{name:"calendar.config.title",href:"#/calendar-config",roles:["AD"]},{name:"system.action.title",href:"#/client-action",roles:["AD"]}]},{name:"product.menu",icon:"fa fa-barcode",roles:["AD"],children:[{name:"uom.title",href:"#/uom",roles:["AD"]},{name:"product.category.title",href:"#/product-category",roles:["AD"]},{name:"product.title",href:"#/product",roles:["AD"]},{name:"promotion.title",href:"#/promotion",roles:["AD"],modules:["PROMOTION"]}]},{name:"customer.menu",icon:"fa fa-group",roles:["AD","SUP"],children:[{name:"customer.type.title",href:"#/customer-type",roles:["AD"]},{name:"area.title",href:"#/area",roles:["AD"]},{name:"customer.title",href:"#/customer",roles:["AD","SUP"]}]},{name:"survey.title",icon:"fa fa-question-circle",href:"#/survey",roles:["AD"],modules:["SURVEY"]},{name:"target.menu",icon:"fa fa-crosshairs",href:"#/target",roles:["SUP"]},{name:"schedule.menu",icon:"fa fa-code-fork",roles:["AD","SUP"],children:[{name:"route.title",href:"#/route",roles:["AD","SUP"]},{name:"customer.schedule.title",href:"#/customer-schedule",roles:["AD","SUP"]}]},{name:"visit.today.menu",icon:"fa fa-user-secret",roles:["AD","OBS","SUP"],children:[{name:"visit.today.list.menu",href:"#/visit-today",roles:["AD","OBS","SUP"]},{name:"visit.today.map.menu",href:"#/visit-today-map",roles:["AD","OBS","SUP"]}]},{name:"approval.menu",icon:"fa fa-gavel",roles:["AD","SUP","DIS"],children:[{name:"order",href:"#/order-pending",roles:["AD","SUP","DIS"]},{name:"customer",href:"#/customer-pending",roles:["AD","SUP"]}]},{name:"feedback",icon:"fa fa-comment",href:"#/feedback",roles:["AD","OBS","SUP","DIS"]},{name:"history.menu",icon:"fa fa-archive",roles:["AD","OBS","SUP","DIS"],children:[{name:"order",href:"#/order-search",roles:["AD","OBS","SUP","DIS"]},{name:"visit",href:"#/visit-search",roles:["AD","OBS","SUP"]},{name:"visit.photo",href:"#/visit-photo",roles:["AD","OBS","SUP","DIS"]},{name:"check.in.menu",href:"#/check-in-search",roles:["AD"],modules:["CHECK_IN"]}]},{name:"report.menu",icon:"fa fa-pie-chart",roles:["AD","OBS","SUP","DIS"],children:[{name:"sales.report.menu",href:"#/sales-report",roles:["AD","OBS","SUP","DIS"]},{name:"visit.report.menu",href:"#/visit-report",roles:["AD","OBS","SUP"]},{name:"survey.report.menu",href:"#/survey-report",roles:["AD","OBS","SUP"],modules:["SURVEY"]},{name:"performance.report.menu",href:"#/performance-report",roles:["AD","OBS","SUP"]},{name:"inventory.report.menu",href:"#/inventory-report",roles:["AD","OBS","SUP"],modules:["INVENTORY"]},{name:"inventory.report.menu",href:"#/inventory-report-distributor",roles:["DIS"],modules:["INVENTORY"]}]},{name:"export.menu",icon:"fa fa-file-excel-o",roles:["AD","OBS","SUP","DIS"],children:[{name:"order.export.menu",href:"#/order-export",roles:["AD","OBS","SUP","DIS"]},{name:"visit.export.menu",href:"#/visit-export",roles:["AD","OBS","SUP","DIS"]},{name:"exchange.return.export.menu",href:"#/exchange-return-export",roles:["AD","OBS","SUP","DIS"],modules:["EXCHANGE_RETURN"]},{name:"check.in.export.menu",href:"#/check-in-export",roles:["AD"],modules:["CHECK_IN"]}]},{name:"distributor.price.list.menu",icon:"fa fa-tag",href:"#/distributor-price-list",roles:["DIS"]},{name:"van.sales.menu",icon:"fa fa-truck",href:"#/van-sales",roles:["DIS"]},{name:"inventory.update.menu",icon:"fa fa-bank",href:"#/inventory",roles:["DIS"],modules:["INVENTORY"]}])}.call(this),function(){"use strict";angular.module("app.state").constant("STATES",[{name:"client",templateUrl:"CATEGORY_LIST_TEMPLATE",controller:"ClientCtrl",roles:["SUPER","SUPPORTER"]},{name:"client-detail",templateUrl:"views/business/super-admin/client-detail.html",controller:"ClientDetailCtrl",roles:["SUPER","SUPPORTER"]},{name:"import-master-data",templateUrl:"views/business/import/import-master-data.html",controller:"ImportMasterDataCtrl",roles:["SUPER","SUPPORTER"]},{name:"system-config",templateUrl:"views/business/super-admin/system-config.html",controller:"SystemConfigCtrl",roles:["SUPER"]},{name:"system-action",templateUrl:"views/business/super-admin/system-action.html",controller:"SystemActionCtrl",roles:["SUPER"]},{name:"dashboard",templateUrl:"views/business/dashboard/dashboard.html",controller:"DashboardCtrl",roles:["AD","OBS","SUP"]},{name:"user",templateUrl:"views/business/system/user.html",controller:"UserCtrl",roles:["AD"]},{name:"user-detail",templateUrl:"views/business/system/user-detail.html",controller:"UserDetailCtrl",roles:["AD"]},{name:"user-observer-distributors",templateUrl:"views/business/system/user-observer-distributors.html",controller:"UserObserverDistributorsCtrl",roles:["AD"]},{name:"distributor",templateUrl:"CATEGORY_LIST_TEMPLATE",controller:"DistributorCtrl",roles:["AD"]},{name:"distributor-detail",templateUrl:"views/business/system/distributor-detail.html",controller:"DistributorDetailCtrl",roles:["AD"]},{name:"client-config",templateUrl:"views/business/system/client-config.html",controller:"ClientConfigCtrl",roles:["AD"]},{name:"calendar-config",templateUrl:"views/business/system/calendar-config.html",controller:"CalendarConfigCtrl",roles:["AD"]},{name:"client-action",templateUrl:"views/business/system/client-action.html",controller:"ClientActionCtrl",roles:["AD"]},{name:"uom",templateUrl:"CATEGORY_LIST_TEMPLATE",controller:"UomCtrl",roles:["AD"]},{name:"product-category",templateUrl:"CATEGORY_LIST_TEMPLATE",controller:"ProductCategoryCtrl",roles:["AD"]},{name:"product",templateUrl:"CATEGORY_LIST_TEMPLATE",controller:"ProductCtrl",roles:["AD"]},{name:"product-detail",templateUrl:"views/business/product/product-detail.html",controller:"ProductDetailCtrl",roles:["AD"]},{name:"import-product",templateUrl:"views/business/import/import-product.html",controller:"ImportProductCtrl",roles:["AD"]},{name:"promotion",templateUrl:"CATEGORY_LIST_TEMPLATE",controller:"PromotionCtrl",roles:["AD"],modules:["PROMOTION"]},{name:"promotion-detail",templateUrl:"views/business/product/promotion-detail.html",controller:"PromotionDetailCtrl",roles:["AD"],modules:["PROMOTION"]},{name:"customer-type",templateUrl:"CATEGORY_LIST_TEMPLATE",controller:"CustomerTypeCtrl",roles:["AD"]},{name:"area",templateUrl:"CATEGORY_LIST_TEMPLATE",controller:"AreaCtrl",roles:["AD"]},{name:"customer",templateUrl:"CATEGORY_LIST_TEMPLATE",controller:"CustomerCtrl",roles:["AD","SUP"]},{name:"customer-detail",templateUrl:"views/business/customer/customer-detail.html",controller:"CustomerDetailCtrl",roles:["AD","SUP"]},{name:"import-customer",templateUrl:"views/business/import/import-customer.html",controller:"ImportCustomerCtrl",roles:["AD","SUP"]},{name:"route",templateUrl:"CATEGORY_LIST_TEMPLATE",controller:"RouteCtrl",roles:["AD","SUP"]},{name:"route-detail",templateUrl:"views/business/schedule/route-detail.html",controller:"RouteDetailCtrl",roles:["AD","SUP"]},{name:"customer-schedule",templateUrl:"views/business/schedule/customer-schedule.html",controller:"CustomerScheduleCtrl",roles:["AD","SUP"]},{name:"import-customer-schedule",templateUrl:"views/business/import/import-customer-schedule.html",controller:"ImportCustomerScheduleCtrl",roles:["AD","SUP"]},{name:"survey",templateUrl:"CATEGORY_LIST_TEMPLATE",controller:"SurveyCtrl",roles:["AD"],modules:["SURVEY"]},{name:"survey-detail",templateUrl:"views/business/survey/survey-detail.html",controller:"SurveyDetailCtrl",roles:["AD"],modules:["SURVEY"]},{name:"target",templateUrl:"views/business/target/target.html",controller:"TargetCtrl",roles:["SUP"]},{name:"target-detail",templateUrl:"views/business/target/target-detail.html",controller:"TargetDetailCtrl",roles:["SUP"]},{name:"visit-today",templateUrl:"views/business/visit-today/visit-today.html",controller:"VisitTodayCtrl",roles:["AD","OBS","SUP"]},{name:"visit-today-map",templateUrl:"views/business/visit-today/visit-today-map.html",controller:"VisitTodayMapCtrl",roles:["AD","OBS","SUP"]},{name:"visit-detail",templateUrl:"views/business/visit-today/visit-detail.html",controller:"VisitDetailCtrl",roles:["AD","OBS","SUP"]},{name:"order-pending",templateUrl:"views/business/approval/order-pending.html",controller:"OrderPendingCtrl",roles:["AD","SUP","DIS"]},{name:"order-approval",templateUrl:"views/business/approval/order-approval.html",controller:"OrderApprovalCtrl",roles:["AD","SUP","DIS"]},{name:"customer-pending",templateUrl:"views/business/approval/customer-pending.html",controller:"CustomerPendingCtrl",roles:["AD","SUP"]},{name:"customer-approval",templateUrl:"views/business/approval/customer-approval.html",controller:"CustomerApprovalCtrl",roles:["AD","SUP"]},{name:"customer-schedule-single",templateUrl:"views/business/schedule/customer-schedule-single.html",controller:"CustomerScheduleSingleCtrl",roles:["AD","SUP"]},{name:"feedback",templateUrl:"views/business/feedback/feedback.html",controller:"FeedbackCtrl",roles:["AD","OBS","SUP","DIS"]},{name:"feedback-detail",templateUrl:"views/business/feedback/feedback-detail.html",controller:"FeedbackDetailCtrl",roles:["AD","OBS","SUP","DIS"]},{name:"order-search",templateUrl:"views/business/history/order-search.html",controller:"OrderSearchCtrl",roles:["AD","OBS","SUP","DIS"]},{name:"order-list",templateUrl:"views/business/history/order-list.html",controller:"OrderListCtrl",roles:["AD","OBS","SUP","DIS"]},{name:"order-detail",templateUrl:"views/business/history/order-detail.html",controller:"OrderDetailCtrl",roles:["AD","OBS","SUP","DIS"]},{name:"visit-search",templateUrl:"views/business/history/visit-search.html",controller:"VisitSearchCtrl",roles:["AD","OBS","SUP"]},{name:"visit-list",templateUrl:"views/business/history/visit-list.html",controller:"VisitListCtrl",roles:["AD","OBS","SUP"]},{name:"visit-photo",templateUrl:"views/business/visit-photo/visit-photo.html",controller:"VisitPhotoCtrl",roles:["AD","OBS","SUP","DIS"]},{name:"check-in-search",templateUrl:"views/business/check-in/check-in-search.html",controller:"CheckInSearchCtrl",roles:["AD"],modules:["CHECK_IN"]},{name:"check-in-list",templateUrl:"views/business/check-in/check-in-list.html",controller:"CheckInListCtrl",roles:["AD"],modules:["CHECK_IN"]},{name:"check-in-timeline",templateUrl:"views/business/check-in/check-in-timeline.html",controller:"CheckInTimelineCtrl",roles:["AD"],modules:["CHECK_IN"]},{name:"check-in-detail",templateUrl:"views/business/check-in/check-in-detail.html",controller:"CheckInDetailCtrl",roles:["AD"],modules:["CHECK_IN"]},{name:"sales-report",templateUrl:"views/business/report/sales/sales-report.html",controller:"SalesReportCtrl",roles:["AD","OBS","SUP","DIS"]},{name:"sales-report-daily",templateUrl:"views/business/report/sales/sales-report-daily.html",controller:"SalesReportDetailCtrl",roles:["AD","OBS","SUP","DIS"]},{name:"sales-report-distributor",templateUrl:"views/business/report/sales/sales-report-distributor.html",controller:"SalesReportDetailCtrl",roles:["AD","OBS","SUP","DIS"]},{name:"sales-report-product",templateUrl:"views/business/report/sales/sales-report-product.html",controller:"SalesReportDetailCtrl",roles:["AD","OBS","SUP","DIS"]},{name:"sales-report-salesman",templateUrl:"views/business/report/sales/sales-report-salesman.html",controller:"SalesReportDetailCtrl",roles:["AD","OBS","SUP","DIS"]},{name:"visit-report",templateUrl:"views/business/report/visit/visit-report.html",controller:"VisitReportCtrl",roles:["AD","OBS","SUP"]},{name:"visit-report-daily",templateUrl:"views/business/report/visit/visit-report-daily.html",controller:"VisitReportDetailCtrl",roles:["AD","OBS","SUP"]},{name:"visit-report-distributor",templateUrl:"views/business/report/visit/visit-report-distributor.html",controller:"VisitReportDetailCtrl",roles:["AD","OBS","SUP"]},{name:"visit-report-salesman",templateUrl:"views/business/report/visit/visit-report-salesman.html",controller:"VisitReportDetailCtrl",roles:["AD","OBS","SUP"]},{name:"survey-report",templateUrl:"views/business/report/survey/survey-report.html",controller:"SurveyReportCtrl",roles:["AD","OBS","SUP"],modules:["SURVEY"]},{name:"survey-report-detail",templateUrl:"views/business/report/survey/survey-report-detail.html",controller:"SurveyReportDetailCtrl",roles:["AD","OBS","SUP"],modules:["SURVEY"]},{name:"performance-report",templateUrl:"views/business/report/performance/performance-report.html",controller:"PerformanceReportCtrl",roles:["AD","OBS","SUP","DIS"]},{name:"performance-report-salesman",templateUrl:"views/business/report/performance/performance-report-salesman.html",controller:"PerformanceReportSalesmanCtrl",roles:["AD","OBS","SUP","DIS"]},{name:"inventory-report",templateUrl:"views/business/report/inventory/inventory-report.html",controller:"InventoryReportCtrl",roles:["AD","OBS","SUP"],modules:["INVENTORY"]},{name:"inventory-report-distributor",templateUrl:"views/business/report/inventory/inventory-report-distributor.html",controller:"InventoryReportDistributorCtrl",roles:["AD","OBS","SUP","DIS"],modules:["INVENTORY"]},{name:"inventory-report-product",templateUrl:"views/business/report/inventory/inventory-report-product.html",controller:"InventoryReportProductCtrl",roles:["AD","OBS","SUP"],modules:["INVENTORY"]},{name:"order-export",templateUrl:"views/business/export/order-export.html",controller:"OrderExportCtrl",roles:["AD","OBS","SUP","DIS"]},{name:"visit-export",templateUrl:"views/business/export/visit-export.html",controller:"VisitExportCtrl",roles:["AD","OBS","SUP","DIS"]},{name:"exchange-return-export",templateUrl:"views/business/export/exchange-return-export.html",controller:"ExchangeReturnExportCtrl",roles:["AD","OBS","SUP","DIS"],modules:["EXCHANGE_RETURN"]},{name:"check-in-export",templateUrl:"views/business/export/check-in-export.html",controller:"CheckInExportCtrl",roles:["AD"],modules:["CHECK_IN"]},{name:"change-password",templateUrl:"views/system/change-password.html",controller:"ChangePasswordCtrl",roles:["AD","OBS","SUP","DIS"]},{name:"distributor-price-list",templateUrl:"views/business/price-list/distributor-price-list.html",controller:"DistributorPriceListCtrl",roles:["DIS"]},{name:"import-price-list",templateUrl:"views/business/import/import-distributor-price-list.html",controller:"ImportDistributorPriceListCtrl",roles:["DIS"]},{name:"van-sales",templateUrl:"views/business/van-sales/van-sales.html",controller:"VanSalesCtrl",roles:["DIS"]},{name:"inventory",templateUrl:"views/business/inventory/inventory-list.html",controller:"InventoryCtrl",roles:["DIS"],modules:["INVENTORY"]},{name:"inventory-detail",templateUrl:"views/business/inventory/inventory-detail.html",controller:"InventoryDetailCtrl",roles:["DIS"],modules:["INVENTORY"]},{name:"import-inventory",templateUrl:"views/business/import/import-inventory.html",controller:"ImportInventoryCtrl",roles:["DIS"],modules:["INVENTORY"]}])}.call(this),function(){"use strict";angular.module("app").controller("ClientCtrl",["$scope","CtrlCategoryInitiatorService",function($scope,CtrlCategoryInitiatorService){return $scope.title="client.title",$scope.categoryName="client",$scope.usePopup=!1,$scope.isUseDistributorFilter=function(){return!1},$scope.columns=[{header:"name",property:"name"},{header:"code",property:"code"}],$scope.useDeleteButton=!1,$scope.useEnableButton=!1,$scope.useActivateButton=!1,CtrlCategoryInitiatorService.initCategoryListViewCtrl($scope),$scope.init()}]).controller("ClientDetailCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","$state","$stateParams",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,$state,$stateParams){return $scope.title="client.title",$scope.categoryName="client",$scope.isIdRequire=function(){return!0},$scope.defaultBackState="client",$scope.goToImport=function(){return $state.go("import-master-data",{id:$stateParams.id,filter:$stateParams.filter})},$scope.useMap=!0,$scope.getLocation=function(){return null!=$scope.record.clientConfig?$scope.record.clientConfig.location:null},$scope.onLoadSuccess=function(){var holiday,holidayDates,workingDays,_i,_len,_ref,_ref1,_ref2;if($scope.record.clientConfig=null!=(_ref=$scope.record.clientConfig)?_ref:{},null!=$scope.record.clientConfig.visitDurationKPI&&($scope.record.clientConfig.visitDurationKPIinMinute=$scope.record.clientConfig.visitDurationKPI/60/1e3),null!=$scope.record.clientConfig.modules&&$scope.record.clientConfig.modules.length>0?($scope.record.clientConfig.usePromotion=_.includes($scope.record.clientConfig.modules,"PROMOTION"),$scope.record.clientConfig.useSurvey=_.includes($scope.record.clientConfig.modules,"SURVEY"),$scope.record.clientConfig.useInventory=_.includes($scope.record.clientConfig.modules,"INVENTORY"),$scope.record.clientConfig.useCheckIn=_.includes($scope.record.clientConfig.modules,"CHECK_IN"),$scope.record.clientConfig.useExchangeReturn=_.includes($scope.record.clientConfig.modules,"EXCHANGE_RETURN")):($scope.record.clientConfig.usePromotion=!1,$scope.record.clientConfig.useSurvey=!1,$scope.record.clientConfig.useInventory=!1,$scope.record.clientConfig.useCheckIn=!1,$scope.record.clientConfig.useExchangeReturn=!1),null==$scope.record.clientConfig.numberDayInventoryExpire&&($scope.record.clientConfig.numberDayInventoryExpire=31),$scope.record.calendarConfig=null!=(_ref1=$scope.record.calendarConfig)?_ref1:{},workingDays=[],null!=$scope.record.calendarConfig.workingDays&&(workingDays=$scope.record.calendarConfig.workingDays),$scope.record.calendarConfig.sunday=_.includes(workingDays,1),$scope.record.calendarConfig.monday=_.includes(workingDays,2),$scope.record.calendarConfig.tuesday=_.includes(workingDays,3),$scope.record.calendarConfig.wednesday=_.includes(workingDays,4),$scope.record.calendarConfig.thursday=_.includes(workingDays,5),$scope.record.calendarConfig.friday=_.includes(workingDays,6),$scope.record.calendarConfig.saturday=_.includes(workingDays,7),null!=$scope.record.calendarConfig.holidays){for(holidayDates=[],_ref2=$scope.record.calendarConfig.holidays,_i=0,_len=_ref2.length;_len>_i;_i++)holiday=_ref2[_i],holidayDates.push($scope.createDatePickerModel(globalUtils.parseIsoDate(holiday)));return $scope.record.calendarConfig.holidayDates=holidayDates}},$scope.getObjectToSave=function(){var holidayDate,holidays,record,workingDays,_i,_len,_ref;if(record=angular.copy($scope.record),record.clientConfig=angular.copy($scope.record.clientConfig),record.calendarConfig=angular.copy($scope.record.calendarConfig),record.clientConfig.visitDurationKPI=60*$scope.record.clientConfig.visitDurationKPIinMinute*1e3,record.clientConfig.modules=[],$scope.record.clientConfig.usePromotion&&record.clientConfig.modules.push("PROMOTION"),$scope.record.clientConfig.useSurvey&&record.clientConfig.modules.push("SURVEY"),$scope.record.clientConfig.useInventory&&record.clientConfig.modules.push("INVENTORY"),$scope.record.clientConfig.useCheckIn&&record.clientConfig.modules.push("CHECK_IN"),$scope.record.clientConfig.useExchangeReturn&&record.clientConfig.modules.push("EXCHANGE_RETURN"),workingDays=[],$scope.record.calendarConfig.sunday&&workingDays.push(1),$scope.record.calendarConfig.monday&&workingDays.push(2),$scope.record.calendarConfig.tuesday&&workingDays.push(3),$scope.record.calendarConfig.wednesday&&workingDays.push(4),$scope.record.calendarConfig.thursday&&workingDays.push(5),$scope.record.calendarConfig.friday&&workingDays.push(6),$scope.record.calendarConfig.saturday&&workingDays.push(7),record.calendarConfig.workingDays=workingDays,null!=record.calendarConfig.holidayDates){for(holidays=[],_ref=$scope.record.calendarConfig.holidayDates,_i=0,_len=_ref.length;_len>_i;_i++)holidayDate=_ref[_i],null!=holidayDate.date&&holidays.push(globalUtils.createIsoDate(holidayDate.date));record.calendarConfig.holidays=holidays}return record},$scope.holidaysEmpty=function(){return null==$scope.record||null==$scope.record.calendarConfig||null==$scope.record.calendarConfig.holidayDates||0===$scope.record.calendarConfig.holidayDates.length},$scope.addHoliday=function(){return $scope.changeStatus.markAsChanged(),null==$scope.record.calendarConfig.holidayDates&&($scope.record.calendarConfig.holidayDates=[]),$scope.record.calendarConfig.holidayDates.push($scope.createDatePickerModel(null))},$scope.removeHoliday=function(holidayDate){return $scope.changeStatus.markAsChanged(),null!=$scope.record.calendarConfig.holidayDates?($scope.record.calendarConfig.holidayDates.splice(_.indexOf($scope.record.calendarConfig.holidayDates,holidayDate),1),$scope.removeDatePickerModel(holidayDate)):void 0},$scope.onOpenDatePicker=function(){return $scope.changeStatus.markAsChanged()},$scope.createSampleMasterData=function(){var params,status;return status=$scope.loadStatus.getStatusByDataName("data"),params={who:$scope.who,category:"client",action:"create-sample-master-data",clientId:$stateParams.id},CtrlUtilsService.doPost(params,status,null,null,null,"save")},$scope.generateVisitAndOrder=function(){var params,status;return status=$scope.loadStatus.getStatusByDataName("data"),params={who:$scope.who,category:"client",action:"generate-visit-and-order",clientId:$stateParams.id},CtrlUtilsService.doPost(params,status,null,null,null,"save")},CtrlInitiatorService.initUseDatePickerCtrl($scope),CtrlCategoryInitiatorService.initCategoryDetailViewCtrl($scope),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("ImportMasterDataCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams","ADDRESS_BACKEND","$token",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams,ADDRESS_BACKEND,$token){var importMasterData,initStep,verify;return $scope.title="Import Master Data",$scope.defaultBackState="client-detail",initStep=function(){return $scope.currentStep=0,$scope.steps=[{name:"import.step.upload.file"},{name:"import.step.confirm"},{name:"import.step.finalisation"}]},$scope.isDoneStep=function(stepIndex){return stepIndex<$scope.currentStep},$scope.isCurrentStep=function(stepIndex){return $scope.currentStep===stepIndex},$scope.canNext=function(){return null!=$scope.currentStep&&$scope.currentStep>=0&&!$scope.isFinish()},$scope.isNextDisabled=function(){if($scope.canNext()){if(0===$scope.currentStep)return null===$scope.global.excel;if(1===$scope.currentStep)return null==$scope.global.confirm||$scope.global.confirm.errorTemplate}return!0},$scope.nextStep=function(){return $scope.canNext()?0===$scope.currentStep?verify():importMasterData():void 0},$scope.canBack=function(){return null!=$scope.currentStep&&$scope.currentStep>=0&&!$scope.isFinish()},$scope.backStep=function(){return $scope.global.excel=null,0===$scope.currentStep?$scope.back():$scope.currentStep--},$scope.isFinish=function(){return $scope.currentStep>=2},$scope.finish=function(){return $scope.isFinish()?$scope.back():void 0},$scope.getTemplateLink=function(){return ADDRESS_BACKEND+$scope.who+"/import/master-data/template?access_token="+$token.getAccessToken()+"&lang="+CtrlUtilsService.getUserLanguage()},$scope.getRowErrorData=function(data){return _.isEmpty(data)?"<"+$filter("translate")("import.data.empty")+">":data},verify=function(){var onSuccess,params,status;return $scope.global.confirm={},status=$scope.loadStatus.getStatusByDataName("data"),params={who:$scope.who,category:"import",subCategory:"master-data",param:"verify",fileId:$scope.global.excel.fileId},onSuccess=function(data){var _results;return $scope.global.confirm=data,$scope.columnIndex=function(){_results=[];for(var _i=0,_ref=$scope.global.confirm.nbColumn-1;_ref>=0?_ref>=_i:_i>=_ref;_ref>=0?_i++:_i--)_results.push(_i);return _results}.apply(this),$scope.currentStep++},CtrlUtilsService.loadSingleData(params,status,onSuccess,null)},importMasterData=function(){var onSuccess,params,status;return status=$scope.loadStatus.getStatusByDataName("data"),params={who:$scope.who,category:"import",subCategory:"master-data",param:"import",clientId:$stateParams.id,fileId:$scope.global.excel.fileId},onSuccess=function(){return $scope.currentStep++},CtrlUtilsService.doPost(params,status,null,onSuccess,null,"save")},CtrlInitiatorService.initCanBackViewCtrl($scope),$scope.addInitFunction(function(){return null==$stateParams.id&&$state.go("404"),initStep(),$scope.global={},$scope.global.excel=null,$scope.global.confirm=null}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("SystemConfigCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","$filter",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,$filter){return $scope.title="system.config.title",$scope.categoryName="system-config",$scope.isIdRequire=function(){return!1},$scope.useMap=!0,$scope.getLocation=function(){return $scope.record.location},CtrlCategoryInitiatorService.initCategoryDetailViewCtrl($scope),$scope.orderDateTypes=[{id:"CREATED_DATE",name:$filter("translate")("order.created.date")},{id:"APPROVED_DATE",name:$filter("translate")("order.approved.date")}],$scope.init()}])}.call(this),function(){angular.module("app").controller("SystemActionCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService",function($scope,CtrlUtilsService,CtrlInitiatorService){return $scope.title="system.action.title",CtrlInitiatorService.initBasicViewCtrl($scope),$scope.resetCache=function(){var params,status;return status=$scope.loadStatus.getStatusByDataName("data"),params={who:$scope.who,category:"system",action:"reset-cache"},CtrlUtilsService.doPut(params,status,null,null,null,"reset.cache")},$scope.generateBigData=function(){var params,status;return status=$scope.loadStatus.getStatusByDataName("data"),params={who:$scope.who,category:"system",action:"generate-big-data"},CtrlUtilsService.doPost(params,status,null,null,null,"generate.big.data")},$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("DashboardCtrl",["$scope","$state","$stateParams","toast","$filter","CtrlUtilsService","CtrlInitiatorService",function($scope,$state,$stateParams,toast,$filter,CtrlUtilsService,CtrlInitiatorService){return CtrlInitiatorService.initBasicViewCtrl($scope),$scope.getComparisonIcon=function(before,current){return null==before&&(before=0),null==current&&(current=0),current>before?"fa-arrow-circle-up":before>current?"fa-arrow-circle-down":before===current?"fa-arrow-circle-right":void 0},$scope.isDisplayProgressWarning=function(){return null!=$scope.record&&null!=$scope.record.progressWarnings&&$scope.record.progressWarnings.length>0},$scope.isDisplayBestSellers=function(){return null!=$scope.record&&null!=$scope.record.bestSellers&&$scope.record.bestSellers.length>0},$scope.reloadData=function(){var callbackFailure,callbackSuccess,params,status;return status=$scope.loadStatus.getStatusByDataName("data"),params={who:$scope.who,category:"dashboard"},callbackSuccess=function(data){return $scope.record=data},callbackFailure=function(){return toast.logError($filter("translate")("loading.error"))},CtrlUtilsService.loadSingleData(params,status,callbackSuccess,callbackFailure)},$scope.addInitFunction(function(){return $scope.reloadData()}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("UserCtrl",["$scope","CtrlCategoryInitiatorService","$filter",function($scope,CtrlCategoryInitiatorService,$filter){return $scope.title="user.title",$scope.categoryName="user",$scope.usePopup=!1,$scope.roles=[{id:"all",name:"-- "+$filter("translate")("all")+" --"},{id:"AD",name:$filter("translate")("role.ad")},{id:"OBS",name:$filter("translate")("role.obs")},{id:"SUP",name:$filter("translate")("role.sup")},{id:"DIS",name:$filter("translate")("role.dis")},{id:"SM",name:$filter("translate")("role.sm")}],$scope.isUseDistributorFilter=function(){return null!=$scope.filter.role&&("DIS"===$scope.filter.role||"SM"===$scope.filter.role);
},$scope.roleFilterChange=function(){return $scope.filter.distributorId=null,$scope.distributorFilterChange()},CtrlCategoryInitiatorService.initCategoryListViewCtrl($scope),$scope.getReloadDataParams=function(params){return params=null!=params?params:{},params.category=$scope.categoryName,null!=$scope.filter.role&&"all"!==$scope.filter.role&&(params.role=$scope.filter.role),$scope.isUseDistributorFilter()&&null!=$scope.filter.distributorId&&"all"!==$scope.filter.distributorId&&(params.distributorId=$scope.filter.distributorId),_.isEmpty($scope.filter.searchText)||(params.q=$scope.filter.searchText),params},$scope.addInitFunction(function(){var _ref;return $scope.filter.role=null!=(_ref=$scope.filter.role)?_ref:"all",$scope.isUseDistributorFilter()||"all"===$scope.filter.role?$scope.columns=[{header:"fullname",property:"fullname"},{header:"username",property:"usernameFull"},{header:"role",property:function(record){return $filter("translate")("role."+record.role.toLowerCase())}},{header:"distributor",property:function(record){return null!=record.distributor?record.distributor.name:void 0}}]:$scope.columns=[{header:"fullname",property:"fullname"},{header:"username",property:"usernameFull"},{header:"role",property:function(record){return $filter("translate")("role."+record.role.toLowerCase())}}]}),$scope.init()}]).controller("UserDetailCtrl",["$scope","$state","$stateParams","$filter","CtrlUtilsService","LoadingUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService",function($scope,$state,$stateParams,$filter,CtrlUtilsService,LoadingUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService){return $scope.title="user.title",$scope.categoryName="user",$scope.isIdRequire=function(){return!0},$scope.defaultBackState="user",$scope.onLoadSuccess=function(){var salesman;return null!=$scope.record.distributor&&($scope.record.distributorId=$scope.record.distributor.id),null!=$scope.record.salesmen&&$scope.record.salesman.length>0&&($scope.record.salesmanIds=function(){var _i,_len,_ref,_results;for(_ref=$scope.record.salesmen,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)salesman=_ref[_i],_results.push(salesman.id);return _results}()),null!=$scope.record.role?$scope.roleName=$filter("translate")("role."+$scope.record.role.toLowerCase()):void 0},$scope.clientCode=CtrlUtilsService.getUserInfo().clientCode.toLowerCase()+"_",$scope.roles=[{id:"AD",name:$filter("translate")("role.ad")},{id:"OBS",name:$filter("translate")("role.obs")},{id:"SUP",name:$filter("translate")("role.sup")},{id:"DIS",name:$filter("translate")("role.dis")},{id:"SM",name:$filter("translate")("role.sm")}],$scope.useDistributor=function(){return null!=$scope.record&&null!=$scope.record.role?"DIS"===$scope.record.role||"SM"===$scope.record.role:void 0},$scope.resetPassword=function(){var params,status;return status=$scope.loadStatus.getStatusByDataName("reset.password"),params={who:$scope.who,category:$scope.categoryName,id:$scope.record.id,action:"reset-password"},CtrlUtilsService.doPut(params,status,null,null,null,"reset.password")},$scope.goToObserverDistributors=function(){return $state.go("user-observer-distributors",{id:$scope.record.id,filter:$stateParams.filter})},CtrlCategoryInitiatorService.initCategoryDetailViewCtrl($scope),$scope.addInitFunction(function(){return LoadingUtilsService.loadDistributors($scope.who,$scope.loadStatus.getStatusByDataName("distributor"),function(list){return $scope.distributors=list})}),$scope.init()}]).controller("UserObserverDistributorsCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams","$confirm",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams,$confirm){return $scope.title="user.observer.distributors.title",$scope.reloadData=function(){var params;return $scope.records=[],params={who:$scope.who,category:"user",id:$stateParams.id,param:"distributors"},CtrlUtilsService.loadListData(params,$scope.loadStatus.getStatusByDataName("data"),function(records){return $scope.records=records},function(){return toast.logError($filter("translate")("loading.error"))})},$scope.isEmpty=function(){return _.isEmpty($scope.records)},$scope.checkBeforeSave=function(){return!0},$scope.getObjectToSave=function(){var record,saveData,_i,_len,_ref;for(saveData={list:[]},_ref=$scope.records,_i=0,_len=_ref.length;_len>_i;_i++)record=_ref[_i],record.selected&&saveData.list.push(record.id);return saveData},$scope.getSaveParams=function(params){return params.category="user",params.id=$stateParams.id,params.param="distributors",params},$scope.moreThan20=function(){return null!=$scope.records&&$scope.records.length>20},$scope.onSaveSuccess=function(){},$scope.onSaveFailure=function(){},$scope.isPost=function(){return!1},$scope.back=function(){return $scope.isChanged()?$confirm({text:$filter("translate")("confirm.dialog.are.you.sure.back")}).then(function(){return $state.go("user-detail",{id:$stateParams.id,filter:$stateParams.filter})}):$state.go("user-detail",{id:$stateParams.id,filter:$stateParams.filter})},CtrlInitiatorService.initCanSaveViewCtrl($scope),$scope.addInitFunction(function(){return $scope.reloadData()}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("DistributorCtrl",["$scope","CtrlCategoryInitiatorService","$filter",function($scope,CtrlCategoryInitiatorService,$filter){return $scope.title="distributor.title",$scope.categoryName="distributor",$scope.usePopup=!1,$scope.isUseDistributorFilter=function(){return!1},$scope.useActivateButton=!1,$scope.columns=[{header:"name",property:"name"},{header:"code",property:"code"},{header:"supervisor",property:function(record){return record.supervisor.fullname}}],CtrlCategoryInitiatorService.initCategoryListViewCtrl($scope),$scope.init()}]).controller("DistributorDetailCtrl",["$scope","$stateParams","$filter","CtrlUtilsService","LoadingUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService",function($scope,$stateParams,$filter,CtrlUtilsService,LoadingUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService){return $scope.title="distributor.title",$scope.categoryName="distributor",$scope.isIdRequire=function(){return!0},$scope.defaultBackState="distributor",$scope.onLoadSuccess=function(){return null!=$scope.record.supervisor?$scope.record.supervisorId=$scope.record.supervisor.id:void 0},CtrlCategoryInitiatorService.initCategoryDetailViewCtrl($scope),$scope.addInitFunction(function(){return LoadingUtilsService.loadSupervisors($scope.who,$scope.loadStatus.getStatusByDataName("supervisor"),function(list){return $scope.supervisors=list})}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("ClientConfigCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService){return $scope.title="client.config.title",$scope.categoryName="client-config",$scope.isIdRequire=function(){return!1},$scope.onLoadSuccess=function(){return null!=$scope.record.visitDurationKPI?$scope.record.visitDurationKPIinMinute=$scope.record.visitDurationKPI/60/1e3:void 0},$scope.getObjectToSave=function(){var record;return record=angular.copy($scope.record),record.visitDurationKPI=60*$scope.record.visitDurationKPIinMinute*1e3,record},CtrlCategoryInitiatorService.initCategoryDetailViewCtrl($scope),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("CalendarConfigCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService){return $scope.title="calendar.config.title",$scope.categoryName="calendar-config",$scope.isIdRequire=function(){return!1},$scope.onLoadSuccess=function(){var holiday,holidayDates,workingDays,_i,_len,_ref;if(workingDays=[],null!=$scope.record.workingDays&&(workingDays=$scope.record.workingDays),$scope.record.sunday=_.includes(workingDays,1),$scope.record.monday=_.includes(workingDays,2),$scope.record.tuesday=_.includes(workingDays,3),$scope.record.wednesday=_.includes(workingDays,4),$scope.record.thursday=_.includes(workingDays,5),$scope.record.friday=_.includes(workingDays,6),$scope.record.saturday=_.includes(workingDays,7),null!=$scope.record.holidays){for(holidayDates=[],_ref=$scope.record.holidays,_i=0,_len=_ref.length;_len>_i;_i++)holiday=_ref[_i],holidayDates.push($scope.createDatePickerModel(globalUtils.parseIsoDate(holiday)));return $scope.record.holidayDates=holidayDates}},$scope.getObjectToSave=function(){var holidayDate,holidays,record,workingDays,_i,_len,_ref;if(record=angular.copy($scope.record),workingDays=[],$scope.record.sunday&&workingDays.push(1),$scope.record.monday&&workingDays.push(2),$scope.record.tuesday&&workingDays.push(3),$scope.record.wednesday&&workingDays.push(4),$scope.record.thursday&&workingDays.push(5),$scope.record.friday&&workingDays.push(6),$scope.record.saturday&&workingDays.push(7),record.workingDays=workingDays,null!=$scope.record.holidayDates){for(holidays=[],_ref=$scope.record.holidayDates,_i=0,_len=_ref.length;_len>_i;_i++)holidayDate=_ref[_i],null!=holidayDate.date&&holidays.push(globalUtils.createIsoDate(holidayDate.date));record.holidays=holidays}return record},$scope.holidaysEmpty=function(){return null==$scope.record||null==$scope.record.holidayDates||0===$scope.record.holidayDates.length},$scope.addHoliday=function(){return $scope.changeStatus.markAsChanged(),null==$scope.record.holidayDates&&($scope.record.holidayDates=[]),$scope.record.holidayDates.push($scope.createDatePickerModel(null))},$scope.removeHoliday=function(holidayDate){return $scope.changeStatus.markAsChanged(),null!=$scope.record.holidayDates?($scope.record.holidayDates.splice(_.indexOf($scope.record.holidayDates,holidayDate),1),$scope.removeDatePickerModel(holidayDate)):void 0},$scope.onOpenDatePicker=function(){return $scope.changeStatus.markAsChanged()},CtrlInitiatorService.initUseDatePickerCtrl($scope),CtrlCategoryInitiatorService.initCategoryDetailViewCtrl($scope),$scope.init()}])}.call(this),function(){angular.module("app").controller("ClientActionCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService",function($scope,CtrlUtilsService,CtrlInitiatorService){return $scope.title="system.action.title",CtrlInitiatorService.initBasicViewCtrl($scope),$scope.resetCache=function(){var params,status;return status=$scope.loadStatus.getStatusByDataName("data"),params={who:$scope.who,category:"system",action:"reset-cache"},CtrlUtilsService.doPut(params,status,null,null,null,"reset.cache")},$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("UomCtrl",["$scope","CtrlCategoryInitiatorService",function($scope,CtrlCategoryInitiatorService){return $scope.title="uom.title",$scope.categoryName="uom",$scope.usePopup=!0,$scope.isUseDistributorFilter=function(){return!1},$scope.popupCtrl="NameCodeCategoryPopupCtrl",$scope.columns=[{header:"name",property:"name"},{header:"code",property:"code"}],CtrlCategoryInitiatorService.initCategoryListViewCtrl($scope),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("ProductCategoryCtrl",["$scope","CtrlCategoryInitiatorService",function($scope,CtrlCategoryInitiatorService){return $scope.title="product.category.title",$scope.categoryName="product-category",$scope.usePopup=!0,$scope.isUseDistributorFilter=function(){return!1},CtrlCategoryInitiatorService.initCategoryListViewCtrl($scope),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("ProductCtrl",["$scope","CtrlCategoryInitiatorService",function($scope,CtrlCategoryInitiatorService){return $scope.title="product.title",$scope.categoryName="product",$scope.usePopup=!1,$scope.isUseDistributorFilter=function(){return!1},$scope.importState="import-product",$scope.columns=[{header:"name",property:"name"},{header:"code",property:"code"}],CtrlCategoryInitiatorService.initCategoryListViewCtrl($scope),$scope.init()}]).controller("ProductDetailCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$token",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$token){return $scope.title="product.title",$scope.categoryName="product",$scope.isIdRequire=function(){return!0},$scope.defaultBackState="product",$scope.getProductivityUnit=function(){return null!=$token.getUserInfo()?$token.getUserInfo().productivityUnit:null},$scope.onLoadSuccess=function(){return($scope.isNew()||$scope.isDraft())&&(LoadingUtilsService.loadProductCategories($scope.who,$scope.loadStatus.getStatusByDataName("productCategories"),function(list){return $scope.productCategories=list}),LoadingUtilsService.loadUOMs($scope.who,$scope.loadStatus.getStatusByDataName("uom"),function(list){return $scope.uoms=list})),$scope.isNew()&&($scope.record.productivity=1),null!=$scope.record&&(null!=$scope.record.productCategory&&($scope.record.productCategoryId=$scope.record.productCategory.id),null!=$scope.record.uom)?$scope.record.uomId=$scope.record.uom.id:void 0},CtrlCategoryInitiatorService.initCategoryDetailViewCtrl($scope),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("PromotionCtrl",["$scope","CtrlCategoryInitiatorService","$filter",function($scope,CtrlCategoryInitiatorService,$filter){return $scope.title="promotion.title",$scope.categoryName="promotion",$scope.usePopup=!1,$scope.isUseDistributorFilter=function(){return!1},$scope.useActivateButton=!1,$scope.columns=[{header:"name",property:"name"},{header:"start.date",property:function(record){return $filter("isoDate")(record.startDate)}},{header:"end.date",property:function(record){return $filter("isoDate")(record.endDate)}}],CtrlCategoryInitiatorService.initCategoryListViewCtrl($scope),$scope.init()}]).controller("PromotionDetailCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","$filter","LoadingUtilsService","ADDRESS_BACKEND","toast",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,$filter,LoadingUtilsService,ADDRESS_BACKEND,toast){return $scope.title="promotion.title",$scope.categoryName="promotion",$scope.isIdRequire=function(){return!0},$scope.defaultBackState="promotion",$scope.onLoadSuccess=function(){var detail,promotionType,_i,_len,_ref,_results;if($scope.startDate=$scope.createDatePickerModel(globalUtils.parseIsoDate($scope.record.startDate)),$scope.endDate=$scope.createDatePickerModel(globalUtils.parseIsoDate($scope.record.endDate)),$scope.promotionTypes=[{type:0,name:$filter("translate")("promotion.type.c.product.qty.r.percentage.amt")},{type:1,name:$filter("translate")("promotion.type.c.product.qty.r.product.qty")}],null!=$scope.record.details){for(_ref=$scope.record.details,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)detail=_ref[_i],null!=detail&&detail.type<$scope.promotionTypes.length?(promotionType=$scope.promotionTypes[detail.type],null==promotionType.details&&(promotionType.details=[]),_results.push(promotionType.details.push(detail))):_results.push(void 0);return _results}},$scope.checkBeforeSave=function(){var hasAtLeastOne,promotionType,_i,_len,_ref;for(hasAtLeastOne=!1,_ref=$scope.promotionTypes,_i=0,_len=_ref.length;_len>_i;_i++)promotionType=_ref[_i],$scope.isPromotionTypeApplied(promotionType)&&(hasAtLeastOne=!0);return $scope.startDate.date.getTime()>$scope.endDate.date.getTime()?(toast.logError($filter("translate")("error.start.date.after.end.date")),!1):hasAtLeastOne?!0:(toast.logError($filter("translate")("error.data.input.not.valid")),!1)},$scope.getObjectToSave=function(){var detail,details,promotionType,record,_i,_j,_len,_len1,_ref,_ref1;for(record=angular.copy($scope.record),record.startDate=globalUtils.createIsoDate($scope.startDate.date),record.endDate=globalUtils.createIsoDate($scope.endDate.date),details=[],_ref=$scope.promotionTypes,_i=0,_len=_ref.length;_len>_i;_i++)if(promotionType=_ref[_i],$scope.isPromotionTypeApplied(promotionType))for(_ref1=promotionType.details,_j=0,_len1=_ref1.length;_len1>_j;_j++)detail=_ref1[_j],details.push({type:detail.type,condition:{productId:detail.condition.product.id,quantity:detail.condition.quantity},reward:{percentage:detail.reward.percentage,quantity:detail.reward.quantity,productId:null!=detail.reward.product?detail.reward.product.id:null,productText:detail.reward.productText}});return record.details=details,record},$scope.hasPromotionTypeApplied=function(){var promotionType,_i,_len,_ref;if(null!=$scope.promotionTypes)for(_ref=$scope.promotionTypes,_i=0,_len=_ref.length;_len>_i;_i++)if(promotionType=_ref[_i],$scope.isPromotionTypeApplied(promotionType))return!0;return!1},$scope.isPromotionTypeApplied=function(promotionType){return null!=promotionType&&null!=promotionType.details&&promotionType.details.length>0},$scope.sortPromotionType=function(promotionType){return $scope.isPromotionTypeApplied(promotionType)?0:1},$scope.getPromotionDetailDisplay=function(type,detail){var display;return 0===type?(display="<strong>"+globalUtils.escapeHTML(detail.condition.product.name)+"</strong> ("+detail.condition.product.code+")",display=display+" - ("+$filter("translate")("promotion.discount")+" <strong>"+detail.reward.percentage+"%</strong>)",detail.condition.quantity>1&&(display=display+" - ("+$filter("translate")("promotion.buy.from.quantity")+" "+detail.condition.quantity+" "+detail.condition.product.uom.name+")"),display):1===type?(display=$filter("translate")("promotion.buy"),display=display+" "+detail.condition.quantity+" x",display=display+" <strong>"+globalUtils.escapeHTML(detail.condition.product.name)+"</strong> ("+detail.condition.product.code+")",display=display+" - "+$filter("translate")("promotion.get"),display=display+" "+detail.reward.quantity+" x",null!=detail.reward.product?display=display+" <strong>"+globalUtils.escapeHTML(detail.reward.product.name)+"</strong> ("+detail.reward.product.code+")":null!=detail.reward.productText&&(display=display+" <strong>"+globalUtils.escapeHTML(detail.reward.productText)+"</strong>"),display):void 0},$scope.clearPromotionType=function(promotionType){return $scope.changeStatus.markAsChanged(),promotionType.details=null},$scope.isEditPromotionTypeMode=function(){return null!=$scope.currentPromotionType},$scope.editPromotionType=function(promotionType){var detail,detailMap,product,_i,_j,_len,_len1,_ref,_ref1,_results;if($scope.changeStatus.markAsChanged(),$scope.currentPromotionType=promotionType,$scope.currentPromtionTypeDetails=[],detailMap={},null!=$scope.currentPromotionType&&null!=$scope.currentPromotionType.details&&$scope.currentPromotionType.details.length>0)for(_ref=$scope.currentPromotionType.details,_i=0,_len=_ref.length;_len>_i;_i++)detail=_ref[_i],null!=detail&&null!=detail.condition&&(detailMap[detail.condition.product.id]=detail);if(null!=$scope.products&&null!=$scope.productMap){for(_ref1=$scope.products,_results=[],_j=0,_len1=_ref1.length;_len1>_j;_j++)product=_ref1[_j],detail=detailMap[product.id],null!=detail?_results.push($scope.currentPromtionTypeDetails.push({type:$scope.currentPromotionType.type,condition:{product:product,quantity:angular.copy(detail.condition.quantity)},reward:{percentage:angular.copy(detail.reward.percentage),quantity:angular.copy(detail.reward.quantity),productId:null!=detail.reward.product?angular.copy(detail.reward.product.id):null,productText:angular.copy(detail.reward.productText)},textMode:null!=detail.reward.productText})):_results.push($scope.currentPromtionTypeDetails.push({type:$scope.currentPromotionType.type,condition:{product:product,quantity:null},reward:{},textMode:!1}));return _results}},$scope.getPhotoLink=function(photoId){return ADDRESS_BACKEND+"image/"+photoId},$scope.isDisplayRewardProduct=function(){return null!=$scope.currentPromotionType&&_.includes([1],$scope.currentPromotionType.type)},$scope.isDisplayRewardQuantity=function(){return null!=$scope.currentPromotionType&&_.includes([1],$scope.currentPromotionType.type)},$scope.isDisplayRewardPercentage=function(){return null!=$scope.currentPromotionType&&_.includes([0],$scope.currentPromotionType.type)},$scope.isDetailUsed=function(detail){return detail.condition.quantity>0},$scope.sortDetail=function(detail){return $scope.isDetailUsed(detail)?0:1},$scope.changeProductMode=function(detail){return detail.textMode=!detail.textMode},$scope.getNumberRewardColumn=function(){var numberColumn;return numberColumn=0,$scope.isDisplayRewardProduct()&&numberColumn++,$scope.isDisplayRewardQuantity()&&numberColumn++,$scope.isDisplayRewardPercentage()&&numberColumn++,numberColumn},$scope.applyPromotionTypeEdit=function(){var detail,temp,_i,_len,_ref;if($scope.isFormValid("form2")){for($scope.currentPromotionType.details=[],_ref=$scope.currentPromtionTypeDetails,_i=0,_len=_ref.length;_len>_i;_i++)detail=_ref[_i],$scope.isDetailUsed(detail)&&(temp={},temp.type=$scope.currentPromotionType.type,temp.condition=detail.condition,temp.reward={percentage:detail.reward.percentage,quantity:detail.reward.quantity},detail.textMode?temp.reward.productText=detail.reward.productText:temp.reward.product=$scope.productMap[detail.reward.productId],$scope.currentPromotionType.details.push(temp));return $scope.cancelPromotionTypeEdit()}return toast.logError($filter("translate")("error.data.input.not.valid"))},$scope.cancelPromotionTypeEdit=function(){return $scope.currentPromotionType=null,$scope.currentPromtionTypeDetails=null},CtrlInitiatorService.initUseDatePickerCtrl($scope),CtrlCategoryInitiatorService.initCategoryDetailViewCtrl($scope),$scope.addInitFunction(function(){return $scope.currentPromotionType=null,$scope.currentPromtionTypeDetails=null,$scope.products=null,$scope.productMap=null,LoadingUtilsService.loadProductsByDistributor($scope.who,$scope.loadStatus.getStatusByDataName("product"),function(list){var product,_i,_len,_ref,_results;for($scope.products=list,$scope.productMap={},_ref=$scope.products,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)product=_ref[_i],_results.push($scope.productMap[product.id]=product);return _results})}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("CustomerTypeCtrl",["$scope","CtrlCategoryInitiatorService",function($scope,CtrlCategoryInitiatorService){return $scope.title="customer.type.title",$scope.categoryName="customer-type",$scope.usePopup=!0,$scope.isUseDistributorFilter=function(){return!1},CtrlCategoryInitiatorService.initCategoryListViewCtrl($scope),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("AreaCtrl",["$scope","CtrlCategoryInitiatorService",function($scope,CtrlCategoryInitiatorService){return $scope.title="area.title",$scope.categoryName="area",$scope.usePopup=!0,$scope.isUseDistributorFilter=function(){return!0},$scope.columns=[{header:"name",property:"name"},{header:"distributor",property:function(record){return record.distributor.name}}],CtrlCategoryInitiatorService.initCategoryListViewCtrl($scope),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("CustomerCtrl",["$scope","CtrlCategoryInitiatorService",function($scope,CtrlCategoryInitiatorService){return $scope.title="customer.title",$scope.categoryName="customer",$scope.usePopup=!1,$scope.isBigData=!0,$scope.isUseDistributorFilter=function(){return"distributor"!==$scope.who},$scope.importState="import-customer",$scope.isUseDistributorFilter()?$scope.columns=[{header:"name",property:"name"},{header:"code",property:"code"},{header:"distributor",property:function(record){return record.distributor.name}},{header:"area",property:function(record){return record.area.name}},{header:"customer.type",property:function(record){return record.customerType.name}}]:$scope.columns=[{header:"name",property:"name"},{header:"code",property:"code"},{header:"area",property:function(record){return record.area.name}},{header:"customer.type",property:function(record){return record.customerType.name}}],CtrlCategoryInitiatorService.initCategoryListViewCtrl($scope),$scope.init()}]).controller("CustomerDetailCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService){var reloadArea;return $scope.title="customer.title",$scope.categoryName="customer",$scope.isIdRequire=function(){return!0},$scope.defaultBackState="customer",$scope.useMap=!0,$scope.getLocation=function(){return $scope.record.location},$scope.onLoadSuccess=function(record){return($scope.isNew()||$scope.isDraft())&&(LoadingUtilsService.loadDistributors($scope.who,$scope.loadStatus.getStatusByDataName("distributors"),function(list){return $scope.distributors=list}),LoadingUtilsService.loadCustomerTypes($scope.who,$scope.loadStatus.getStatusByDataName("customerTypes"),function(list){return $scope.customerTypes=list})),null!=record&&(null!=record.distributor&&null!=record.distributor.id&&($scope.record.distributorId=$scope.record.distributor.id,reloadArea()),null!=record.customerType&&null!=record.customerType.id&&($scope.record.customerTypeId=$scope.record.customerType.id),null!=record.area&&null!=record.area.id)?$scope.record.areaId=$scope.record.area.id:void 0},reloadArea=function(){return null!=$scope.record&&null!=$scope.record.distributorId?LoadingUtilsService.loadAreasByDistributor($scope.who,$scope.record.distributorId,$scope.loadStatus.getStatusByDataName("areas"),function(list){return $scope.areas=list}):$scope.areas=[]},$scope.changeDistributor=function(){return $scope.record.areaId=null,$scope.changeStatus.markAsChanged(),reloadArea()},CtrlInitiatorService.initUseDatePickerCtrl($scope),CtrlCategoryInitiatorService.initCategoryDetailViewCtrl($scope),$scope.init()}]).controller("CustomerSelectPopupCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","$modalInstance","distributorId","distributorName","toast",function($scope,CtrlUtilsService,CtrlInitiatorService,$modalInstance,distributorId,distributorName,toast){return $scope.title="customer",$scope.distributorId=distributorId,$scope.distributorName=distributorName,$scope.getReloadDataParams=function(params){return params.category="customer",params.distributorId=$scope.distributorId,params},$scope.reloadData=function(){var params;return params={who:$scope.who,category:"customer",distributorId:$scope.distributorId,page:$scope.pagingData.currentPage,size:$scope.pagingData.itemsPerPage,q:$scope.filter.searchText},$scope.records=[],CtrlUtilsService.loadListData(params,$scope.loadStatus.getStatusByDataName("data"),function(list,count){return $scope.records=list,$scope.pagingData.count=count},function(){return toast.logError($filter("translate")("loading.error"))})},$scope.search=function(){return $scope.reloadData()},$scope.selectCustomer=function(customer){return $modalInstance.close(customer)},$scope.cancel=function(){return $modalInstance.dismiss("cancel")},$scope.isEmpty=function(){return!$scope.isLoading()&&(null==$scope.records||0===$scope.records.length)},CtrlInitiatorService.initBasicViewCtrl($scope),$scope.addInitFunction(function(){return $scope.filter={searchText:null},$scope.pagingData={pagingMaxSize:5,itemsPerPage:10,count:0,currentPage:1},$scope.reloadData()}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("RouteCtrl",["$scope","CtrlCategoryInitiatorService",function($scope,CtrlCategoryInitiatorService){return $scope.title="route.title",$scope.categoryName="route",$scope.usePopup=!1,$scope.isUseDistributorFilter=function(){return"distributor"!==$scope.who},$scope.isUseDistributorFilter()?$scope.columns=[{header:"name",property:"name"},{header:"distributor",property:function(record){return record.distributor.name}},{header:"salesman",property:function(record){return null!=record.salesman?record.salesman.fullname:""}}]:$scope.columns=[{header:"name",property:"name"},{header:"salesman",property:function(record){return null!=record.salesman?record.salesman.fullname:""}}],CtrlCategoryInitiatorService.initCategoryListViewCtrl($scope),$scope.init()}]).controller("RouteDetailCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter){var reloadSalesmen;return $scope.title="route.title",$scope.categoryName="route",$scope.isIdRequire=function(){return!0},$scope.defaultBackState="route",$scope.isUseDistributorFilter=function(){return"distributor"!==$scope.who},$scope.onLoadSuccess=function(){return null!=$scope.record&&($scope.isDraft()&&LoadingUtilsService.loadDistributors($scope.who,$scope.loadStatus.getStatusByDataName("distributors"),function(list){return $scope.distributors=list}),null!=$scope.record.distributor&&null!=$scope.record.distributor.id&&($scope.record.distributorId=$scope.record.distributor.id,reloadSalesmen()),null!=$scope.record.salesman&&null!=$scope.record.salesman.id)?$scope.record.salesmanId=$scope.record.salesman.id:void 0},reloadSalesmen=function(){return null!=$scope.record&&null!=$scope.record.distributorId?LoadingUtilsService.loadSalesmenByDistributor($scope.who,$scope.record.distributorId,$scope.loadStatus.getStatusByDataName("salesmen"),function(list){return $scope.salesmen=_.union([{id:null,fullname:"-- "+$filter("translate")("none")+" --"}],list)}):$scope.salesmen=[]},$scope.changeDistributor=function(){return $scope.record.salesmanId=null,$scope.changeStatus.markAsChanged(),reloadSalesmen()},CtrlCategoryInitiatorService.initCategoryDetailViewCtrl($scope),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("CustomerScheduleCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams){var convertWeeks,createNewScheduleItem,createWeekHeader,isItemDayValid,reconvertWeeks,weekIndex;if($scope.title="customer.schedule.title",$scope.isUseDistributorFilter=function(){return"distributor"!==CtrlUtilsService.getWho()},$scope.mustSelectDistributor=function(){return $scope.isUseDistributorFilter()&&null==$scope.filter.distributorId},$scope.goToImport=function(){return $state.go("import-customer-schedule",{filter:$stateParams.filter})},$scope.dayOfWeeks=[{id:null,name:$filter("translate")("all")},{id:2,name:$filter("translate")("monday")},{id:3,name:$filter("translate")("tuesday")},{id:4,name:$filter("translate")("wednesday")},{id:5,name:$filter("translate")("thursday")},{id:6,name:$filter("translate")("friday")},{id:7,name:$filter("translate")("saturday")},{id:1,name:$filter("translate")("sunday")}],$scope.itemsPerPageOptions=[{id:10,name:"10"},{id:20,name:"20"},{id:30,name:"30"}],$scope.useWeekOfFrequency=CtrlUtilsService.getUserInfo().numberWeekOfFrequency>1,$scope.numberWeekOfFrequency=$scope.useWeekOfFrequency?CtrlUtilsService.getUserInfo().numberWeekOfFrequency:0,$scope.weeks=[],$scope.useWeekOfFrequency)for(weekIndex=1,createWeekHeader=function(){return $scope.weeks.push({header:"W"+weekIndex,index:weekIndex}),weekIndex++};!(weekIndex>$scope.numberWeekOfFrequency);)createWeekHeader();return createNewScheduleItem=function(){var item,weekConverted,_i,_len,_ref;if(item={monday:!1,tuesday:!1,wednesday:!1,thursday:!1,friday:!1,saturday:!1,sunday:!1},$scope.useWeekOfFrequency)for(item.weeksConverted=convertWeeks([]),_ref=item.weeksConverted,_i=0,_len=_ref.length;_len>_i;_i++)weekConverted=_ref[_i],weekConverted.selected=!0;return item},convertWeeks=function(weeks){var f,weeksConverted;for(weekIndex=1,
weeksConverted=[],f=function(){return weeksConverted.push({selected:_.includes(weeks,weekIndex),index:weekIndex}),weekIndex++};!(weekIndex>$scope.numberWeekOfFrequency);)f();return weeksConverted},reconvertWeeks=function(weeksConverted){var weekConverted,weeks,_i,_len;if($scope.useWeekOfFrequency){for(weeks=[],_i=0,_len=weeksConverted.length;_len>_i;_i++)weekConverted=weeksConverted[_i],weekConverted.selected&&weeks.push(weekConverted.index);return weeks}return null},isItemDayValid=function(item){return null!=item&&(item.monday||item.tuesday||item.wednesday||item.thursday||item.friday||item.saturday||item.sunday)},$scope.editRoute=function(record){return $scope.changeStatus.markAsChanged(),null==record.schedule.routeId?record.schedule.item=createNewScheduleItem():void 0},$scope.getReloadDataParams=function(params){return $scope.mustSelectDistributor()?null:(params.category="customer-schedule",$scope.isUseDistributorFilter()&&(params.distributorId=$scope.filter.distributorId),null!=$scope.filter.searchText&&$scope.filter.searchText.length>0&&(params.q=$scope.filter.searchText),null!=$scope.filter.routeId&&"all"!==$scope.filter.routeId?(params.searchByRoute=!0,"null"!==$scope.filter.routeId&&(params.routeId=$scope.filter.routeId)):params.searchByRoute=!1,null!=$scope.filter.day&&(params.day=$scope.filter.day),params)},$scope.afterLoad=function(){var record,_i,_len,_ref,_results;for(_ref=$scope.records,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)record=_ref[_i],null!=record.schedule?null!=record.schedule.item?_results.push(record.schedule.item.weeksConverted=convertWeeks(record.schedule.item.weeks)):_results.push(record.schedule.item=createNewScheduleItem()):(record.schedule={},_results.push(record.schedule.item=createNewScheduleItem()));return _results},$scope.checkBeforeSave=function(){var item,record,_i,_len,_ref;for(_ref=$scope.records,_i=0,_len=_ref.length;_len>_i;_i++)if(record=_ref[_i],null!=record.schedule&&null!=record.schedule.routeId){if(null==record.schedule.item)return toast.logError($filter("translate")("error.data.input.not.valid")),!1;if(item=record.schedule.item,!isItemDayValid(item))return toast.logError($filter("translate")("error.data.input.not.valid")),!1;if($scope.useWeekOfFrequency&&_.isEmpty(reconvertWeeks(item.weeksConverted)))return toast.logError($filter("translate")("error.data.input.not.valid")),!1}return!0},$scope.getObjectToSave=function(){var itemCopy,record,recordForSave,recordForSaves,_i,_len,_ref;for(recordForSaves=[],_ref=$scope.records,_i=0,_len=_ref.length;_len>_i;_i++)record=_ref[_i],recordForSave={id:record.id},null!=record.schedule&&null!=record.schedule.routeId&&(recordForSave.schedule={routeId:record.schedule.routeId},itemCopy=angular.copy(record.schedule.item),itemCopy.weeks=reconvertWeeks(record.schedule.item.weeksConverted),recordForSave.schedule.item=itemCopy),recordForSaves.push(recordForSave);return{list:recordForSaves}},$scope.getSaveParams=function(params){return params.category="customer-schedule",params.param="by-distributor",$scope.isUseDistributorFilter()&&(params.distributorId=$scope.filter.distributorId),params},$scope.onSaveSuccess=function(){},$scope.onSaveFailure=function(){},$scope.isPost=function(){return!1},$scope.distributorFilterChange=function(){return $scope.filter.routeId=null,$scope.filterChange()},$scope.filterChange=function(){return $scope.filter.searchText=null,$scope.searchFilterChange()},$scope.searchFilterChange=function(){return $scope.filter.currentPage=1,$scope.pageChange()},CtrlInitiatorService.initPagingFilterViewCtrl($scope),CtrlInitiatorService.initCanSaveViewCtrl($scope),$scope.addInitFunction(function(){var _ref;return $scope.filter.routeId=null!=(_ref=$scope.filter.routeId)?_ref:"all",$scope.isUseDistributorFilter()&&LoadingUtilsService.loadDistributors($scope.who,$scope.loadStatus.getStatusByDataName("distributors"),function(list){return $scope.distributors=list}),$scope.mustSelectDistributor()||LoadingUtilsService.loadRoutesByDistributor($scope.who,$scope.filter.distributorId,$scope.loadStatus.getStatusByDataName("routes"),function(list){return $scope.routesFilter=_.union([{id:"all",name:"-- "+$filter("translate")("all")+" --"},{id:"null",name:"-- "+$filter("translate")("customer.schedule.route.null")+" --"}],list),$scope.routes=_.union([{id:null,name:"-- "+$filter("translate")("customer.schedule.route.null")+" --"}],list)}),$scope.reloadData()}),$scope.init()}]).controller("CustomerScheduleSingleCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$stateParams","$state",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$stateParams,$state){var convertWeeks,createNewScheduleItem,createWeekHeader,isItemDayValid,reconvertWeeks,weekIndex;if($scope.title="customer.schedule.title",$scope.defaultBackState="customer-pending",$scope.useWeekOfFrequency=CtrlUtilsService.getUserInfo().numberWeekOfFrequency>1,$scope.numberWeekOfFrequency=$scope.useWeekOfFrequency?CtrlUtilsService.getUserInfo().numberWeekOfFrequency:0,$scope.weeks=[],$scope.useWeekOfFrequency)for(weekIndex=1,createWeekHeader=function(){return $scope.weeks.push({header:"W"+weekIndex,index:weekIndex}),weekIndex++};!(weekIndex>$scope.numberWeekOfFrequency);)createWeekHeader();return createNewScheduleItem=function(){var item,weekConverted,_i,_len,_ref;if(item={monday:!1,tuesday:!1,wednesday:!1,thursday:!1,friday:!1,saturday:!1,sunday:!1},$scope.useWeekOfFrequency)for(item.weeksConverted=convertWeeks([]),_ref=item.weeksConverted,_i=0,_len=_ref.length;_len>_i;_i++)weekConverted=_ref[_i],weekConverted.selected=!0;return item},convertWeeks=function(weeks){var f,weeksConverted;for(weekIndex=1,weeksConverted=[],f=function(){return weeksConverted.push({selected:_.includes(weeks,weekIndex),index:weekIndex}),weekIndex++};!(weekIndex>$scope.numberWeekOfFrequency);)f();return weeksConverted},reconvertWeeks=function(weeksConverted){var weekConverted,weeks,_i,_len;if($scope.useWeekOfFrequency){for(weeks=[],_i=0,_len=weeksConverted.length;_len>_i;_i++)weekConverted=weeksConverted[_i],weekConverted.selected&&weeks.push(weekConverted.index);return weeks}return null},isItemDayValid=function(item){return null!=item&&(item.monday||item.tuesday||item.wednesday||item.thursday||item.friday||item.saturday||item.sunday)},$scope.editRoute=function(record){return $scope.changeStatus.markAsChanged(),null==record.schedule.routeId?record.schedule.item=createNewScheduleItem():void 0},$scope.reloadData=function(){var params;return params={who:$scope.who,category:"customer-schedule",id:$stateParams.id},CtrlUtilsService.loadSingleData(params,$scope.loadStatus.getStatusByDataName("data"),function(record){return $scope.record=record,LoadingUtilsService.loadRoutesByDistributor($scope.who,$scope.record.distributor.id,$scope.loadStatus.getStatusByDataName("routes"),function(list){return $scope.routes=_.union([{id:null,name:"-- "+$filter("translate")("customer.schedule.route.null")+" --"}],list)}),null!=$scope.record.schedule?null!=$scope.record.schedule.item?$scope.record.schedule.item.weeksConverted=convertWeeks(record.schedule.item.weeks):$scope.record.schedule.item=createNewScheduleItem():($scope.record.schedule={},$scope.record.schedule.item=createNewScheduleItem())},function(error){return 400===error.status?$state.go("404"):toast.logError($filter("translate")("loading.error"))})},$scope.checkBeforeSave=function(){var item,record;if(record=$scope.record,null!=record.schedule&&null!=record.schedule.routeId){if(null==record.schedule.item)return toast.logError($filter("translate")("error.data.input.not.valid")),!1;if(item=record.schedule.item,!isItemDayValid(item))return toast.logError($filter("translate")("error.data.input.not.valid")),!1;if($scope.useWeekOfFrequency&&_.isEmpty(reconvertWeeks(item.weeksConverted)))return toast.logError($filter("translate")("error.data.input.not.valid")),!1}return!0},$scope.getObjectToSave=function(){var itemCopy,record,recordForSave;return record=$scope.record,recordForSave={id:record.id},null!=record.schedule&&null!=record.schedule.routeId&&(recordForSave.schedule={routeId:record.schedule.routeId},itemCopy=angular.copy(record.schedule.item),itemCopy.weeks=reconvertWeeks(record.schedule.item.weeksConverted),recordForSave.schedule.item=itemCopy),recordForSave},$scope.getSaveParams=function(params){return params.category="customer-schedule",params.id=$stateParams.id,params},$scope.onSaveSuccess=function(){},$scope.onSaveFailure=function(){},$scope.isPost=function(){return!1},CtrlInitiatorService.initCanBackViewCtrl($scope),CtrlInitiatorService.initCanSaveViewCtrl($scope),$scope.addInitFunction(function(){return null==$stateParams.id?$state.go("404"):$scope.reloadData()}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("SurveyCtrl",["$scope","CtrlCategoryInitiatorService","$filter",function($scope,CtrlCategoryInitiatorService,$filter){return $scope.title="survey.title",$scope.categoryName="survey",$scope.usePopup=!1,$scope.isUseDistributorFilter=function(){return!1},$scope.useActivateButton=!1,$scope.columns=[{header:"name",property:"name"},{header:"start.date",property:function(record){return $filter("isoDate")(record.startDate)}},{header:"end.date",property:function(record){return $filter("isoDate")(record.endDate)}}],CtrlCategoryInitiatorService.initCategoryListViewCtrl($scope),$scope.init()}]).controller("SurveyDetailCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","$filter","LoadingUtilsService","ADDRESS_BACKEND","toast",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,$filter,LoadingUtilsService,ADDRESS_BACKEND,toast){return $scope.title="survey.title",$scope.categoryName="survey",$scope.isIdRequire=function(){return!0},$scope.defaultBackState="survey",$scope.onLoadSuccess=function(){return $scope.startDate=$scope.createDatePickerModel(globalUtils.parseIsoDate($scope.record.startDate)),$scope.endDate=$scope.createDatePickerModel(globalUtils.parseIsoDate($scope.record.endDate))},$scope.checkBeforeSave=function(){return $scope.startDate.date.getTime()>$scope.endDate.date.getTime()?(toast.logError($filter("translate")("error.start.date.after.end.date")),!1):$scope.hasQuestion()?!0:(toast.logError($filter("translate")("error.data.input.not.valid")),!1)},$scope.getObjectToSave=function(){var record;return record=angular.copy($scope.record),record.startDate=globalUtils.createIsoDate($scope.startDate.date),record.endDate=globalUtils.createIsoDate($scope.endDate.date),record},$scope.hasQuestion=function(){return null!=$scope.record&&null!=$scope.record.questions&&$scope.record.questions.length>0},$scope.addNewQuestion=function(){return $scope.changeStatus.markAsChanged(),$scope.currentEdit={index:null,question:{}}},$scope.removeQuestion=function(index){return $scope.changeStatus.markAsChanged(),$scope.record.questions.splice(index,1)},$scope.editQuestion=function(index){var option,question,questionEdit,_i,_len,_ref;if($scope.changeStatus.markAsChanged(),question=$scope.record.questions[index],questionEdit=angular.copy(question),null!=question.options)for(questionEdit.options=[],_ref=question.options,_i=0,_len=_ref.length;_len>_i;_i++)option=_ref[_i],questionEdit.options.push(angular.copy(option));return $scope.currentEdit={index:index,question:questionEdit}},$scope.isDetailMode=function(){return null!=$scope.currentEdit},$scope.exitDetailMode=function(){return $scope.currentEdit=null},$scope.applyEdit=function(){return $scope.isFormValid("form2")?null==$scope.currentEdit.question.options||$scope.currentEdit.question.options.length<2?toast.logError($filter("translate")("survey.at.least.2.option")):(null!=$scope.currentEdit.index?$scope.record.questions.splice($scope.currentEdit.index,1,$scope.currentEdit.question):(null==$scope.record.questions&&($scope.record.questions=[]),$scope.record.questions.push($scope.currentEdit.question)),$scope.exitDetailMode()):toast.logError($filter("translate")("error.data.input.not.valid"))},$scope.hasOption=function(){return null!=$scope.currentEdit&&null!=$scope.currentEdit.question&&null!=$scope.currentEdit.question.options&&$scope.currentEdit.question.options.length>0},$scope.addNewOption=function(){return null==$scope.currentEdit.question.options&&($scope.currentEdit.question.options=[]),$scope.currentEdit.question.options.push({})},$scope.removeOption=function(option){var options;return null!=$scope.currentEdit.question.options?(options=$scope.currentEdit.question.options,options.splice(options.indexOf(option),1)):void 0},CtrlInitiatorService.initUseDatePickerCtrl($scope),CtrlCategoryInitiatorService.initCategoryDetailViewCtrl($scope),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("TargetCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams){return $scope.title="target.title",$scope.dateChange=function(){return $scope.filter.date=globalUtils.createIsoDate($scope.date.date),$scope.reloadForNewFilter()},$scope.goToDetail=function(record){return $state.go("target-detail",{id:record.salesman.id,filter:$stateParams.filter})},CtrlInitiatorService.initFilterViewCtrl($scope),CtrlInitiatorService.initUseDatePickerCtrl($scope),$scope.reloadData=function(){var params;return params={who:$scope.who,category:"target",month:$scope.date.date.getMonth(),year:$scope.date.date.getFullYear()},CtrlUtilsService.loadListData(params,$scope.loadStatus.getStatusByDataName("data"),function(records){return $scope.records=records},function(error){return 400===error.status?$state.go("404"):toast.logError($filter("translate")("loading.error"))})},$scope.addInitFunction(function(){return null!=$scope.filter.date?$scope.date=$scope.createDatePickerModel(globalUtils.parseIsoDate($scope.filter.date)):$scope.date=$scope.createDatePickerModel(new Date),$scope.reloadData()}),$scope.init()}]).controller("TargetDetailCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams","$token",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams,$token){return $scope.title="target.title",$scope.defaultBackState="target",$scope.getProductivityUnit=function(){return null!=$token.getUserInfo()?$token.getUserInfo().productivityUnit:null},$scope.checkBeforeSave=function(){return $scope.isFormValid("form")?!0:(toast.logError($filter("translate")("error.data.input.not.valid")),!1)},$scope.getObjectToSave=function(){var recordForSave;return recordForSave=angular.copy($scope.record),recordForSave.salesmanId=$stateParams.id,recordForSave.month=$scope.date.getMonth(),recordForSave.year=$scope.date.getFullYear(),recordForSave},$scope.getSaveParams=function(params){return params.category="target",params},$scope.onSaveSuccess=function(){return $scope.refresh()},$scope.onSaveFailure=function(){},$scope.isPost=function(){return!1},CtrlInitiatorService.initFilterViewCtrl($scope),CtrlInitiatorService.initCanBackViewCtrl($scope),CtrlInitiatorService.initCanSaveViewCtrl($scope),$scope.getMonthDisplay=function(){return moment($scope.date).format("MM/YYYY")},$scope.reloadData=function(){var params;return params={who:$scope.who,category:"target",subCategory:"detail",month:$scope.date.getMonth(),year:$scope.date.getFullYear(),salesmanId:$stateParams.id},CtrlUtilsService.loadSingleData(params,$scope.loadStatus.getStatusByDataName("data"),function(record){return $scope.record=record},function(error){return 400===error.status?$state.go("404"):toast.logError($filter("translate")("loading.error"))})},$scope.addInitFunction(function(){return null!=$stateParams.id?($scope.date=null!=$scope.filter.date?globalUtils.parseIsoDate($scope.filter.date):new Date,null!=$scope.date?$scope.reloadData():$state.go("404")):$state.go("404")}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("VisitTodayMapCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state){var addMarkersToMap,clearMarkers,showInfoWindow;return $scope.title="visit.today.title",$scope.isUseDistributorFilter=function(){return"distributor"!==CtrlUtilsService.getWho()},$scope.mustSelectDistributor=function(){return $scope.isUseDistributorFilter()&&null==$scope.filter.distributorId},clearMarkers=function(){var latLng;return null!=$scope.markers&&(staticClearMarkers($scope.map,$scope.markers),$scope.markers=null,null!=$scope.map)?(latLng=new MyLatLng(CtrlUtilsService.getUserInfo().location.latitude,CtrlUtilsService.getUserInfo().location.longitude),$scope.map.setCenter(latLng),$scope.map.setZoom(CtrlUtilsService.getDefaultZoom())):void 0},showInfoWindow=function(latLng){var content,detailLink,i,marker,_i,_len,_ref;if(null!=$scope.markers)for(_ref=$scope.markers,i=_i=0,_len=_ref.length;_len>_i;i=++_i)if(marker=_ref[i],marker.getPosition().lat()===latLng.lat()&&marker.getPosition().lng()===latLng.lng())return content="<strong> "+$scope.records[i].name+" </strong><br/>",null!=$scope.records[i].visitInfo?(detailLink="#/visit-detail?id="+$scope.records[i].visitInfo.id+"&parent=visit-today-map&filter="+$scope.getFilterAsString(),content=content+'<a class="underline-link" href="'+detailLink+'">'+$filter("translate")("visit.today.view.detail")+"</a>"):content+=$filter("translate")("visit.today.not.visited"),$scope.infowindow.setContent(content),void $scope.infowindow.open($scope.map,marker.getPosition());return $scope.infowindow.close()},addMarkersToMap=function(){var bounds,i,latLng,marker,record,_i,_len,_ref;if(null!=$scope.map){if(null!=$scope.records&&$scope.records.length>0){for($scope.markers=[],$scope.infowindow=new MyInfoWindow,bounds=new MyLatLngBounds,_ref=$scope.records,i=_i=0,_len=_ref.length;_len>_i;i=++_i)record=_ref[i],latLng=new MyLatLng(record.location.latitude,record.location.longitude),bounds.extend(latLng),marker=new MyMarker($filter("translate")("location")),staticAddMarkerToMap($scope.map,marker),marker.setPosition(latLng),marker.setDraggable(!1),null!=record.visitInfo?marker.setIcon("images/marker-ok.png"):marker.setIcon("images/marker-warning.png"),marker.addClickListener(function(latLng){return showInfoWindow(latLng)}),$scope.markers.push(marker);return $scope.map.fitBounds(bounds)}return latLng=new MyLatLng(CtrlUtilsService.getUserInfo().location.latitude,CtrlUtilsService.getUserInfo().location.longitude),$scope.map.setCenter(latLng),$scope.map.setZoom(CtrlUtilsService.getDefaultZoom())}},staticOnMapReady($scope,function(map){return $scope.map=map,addMarkersToMap()}),$scope.distributorFilterChange=function(){return $scope.filter.salesmanId=null,$scope.filterChange()},$scope.filterChange=function(){return $scope.reloadForNewFilter()},$scope.reloadData=function(){var params;return $scope.mustSelectDistributor()||(LoadingUtilsService.loadSalesmenByDistributor($scope.who,$scope.filter.distributorId,$scope.loadStatus.getStatusByDataName("salesmen"),function(list){return $scope.salesmen=list}),null==$scope.filter.salesmanId)?void 0:(clearMarkers(),params={who:$scope.who,category:"visit",subCategory:"today",param:"by-salesman",salesmanId:$scope.filter.salesmanId},CtrlUtilsService.loadListData(params,$scope.loadStatus.getStatusByDataName("data"),function(records,count){return $scope.records=records,$scope.count=count,addMarkersToMap()},function(error){return 400===error.status?$state.go("404"):toast.logError($filter("translate")("loading.error"))}))},CtrlInitiatorService.initFilterViewCtrl($scope),$scope.addInitFunction(function(){return $scope.map=null,$scope.markers=null,$scope.isUseDistributorFilter()&&LoadingUtilsService.loadDistributors($scope.who,$scope.loadStatus.getStatusByDataName("distributors"),function(list){return $scope.distributors=list}),$scope.reloadData()}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("VisitTodayCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams){return $scope.title="visit.today.title",$scope.isUseDistributorFilter=function(){return"distributor"!==CtrlUtilsService.getWho()},$scope.mustSelectDistributor=function(){return $scope.isUseDistributorFilter()&&null==$scope.filter.distributorId},$scope.getDurationDisplay=function(duration){var minute,second;return null!=duration?(minute=parseInt(duration/6e4),second=parseInt(duration/1e3%60),minute+"m "+second+"s"):""},$scope.getStartEndDisplay=function(record){return null!=record&&null!=record.startTime&&null!=record.endTime?$filter("isoTime")(record.startTime)+" - "+$filter("isoTime")(record.endTime):""},$scope.isDistanceNormal=function(record){return null!=record.locationStatus&&0===record.locationStatus},$scope.isDistanceTooFar=function(record){return null!=record.locationStatus&&1===record.locationStatus},$scope.isLocationSalesmanUndefined=function(record){return null!=record.locationStatus&&2===record.locationStatus},$scope.isLocationCustomerUndefined=function(record){return null!=record.locationStatus&&3===record.locationStatus},$scope.getDistanceDisplay=function(distance){return null!=distance?$filter("number")(1e3*distance,0)+" m":""},$scope.isNoOrder=function(record){return!(null!=record.hasOrder&&record.hasOrder)},$scope.isOrderApproved=function(record){return!$scope.isNoOrder(record)&&1===record.approveStatus},$scope.isOrderPending=function(record){return!$scope.isNoOrder(record)&&0===record.approveStatus},$scope.isOrderRejected=function(record){return!$scope.isNoOrder(record)&&2===record.approveStatus},$scope.goToDetail=function(record){return $state.go("visit-detail",{id:record.id,filter:$stateParams.filter})},$scope.distributorFilterChange=function(){return $scope.filter.salesmanId=null,$scope.filterChange()},$scope.filterChange=function(){return $scope.filter.currentPage=1,$scope.pageChange()},$scope.getReloadDataParams=function(params){var summaryCallback,summaryLoadStatus,summaryParams;return $scope.mustSelectDistributor()?void 0:(LoadingUtilsService.loadSalesmenByDistributor($scope.who,$scope.filter.distributorId,$scope.loadStatus.getStatusByDataName("salesmen"),function(list){return $scope.salesmen=_.union([{id:"all",fullname:"-- "+$filter("translate")("all")+" --"}],list)}),params.category="visit",params.subCategory="today",$scope.isUseDistributorFilter()&&(params.distributorId=$scope.filter.distributorId),null!=$scope.filter.salesmanId&&"all"!==$scope.filter.salesmanId&&(params.salesmanId=$scope.filter.salesmanId),summaryParams=angular.copy(params),summaryParams.param="summary",summaryLoadStatus=$scope.loadStatus.getStatusByDataName("summary"),$scope.summary={},summaryCallback=function(data){return $scope.summary=data},CtrlUtilsService.loadSingleData(summaryParams,summaryLoadStatus,summaryCallback,null),params)},CtrlInitiatorService.initPagingFilterViewCtrl($scope),$scope.addInitFunction(function(){var _ref;return $scope.filter.salesmanId=null!=(_ref=$scope.filter.salesmanId)?_ref:"all",$scope.isUseDistributorFilter()&&LoadingUtilsService.loadDistributors($scope.who,$scope.loadStatus.getStatusByDataName("distributors"),function(list){return $scope.distributors=list}),$scope.reloadData()}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("VisitDetailCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams","ADDRESS_BACKEND",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams,ADDRESS_BACKEND){var addMarkerToMap;return $scope.title="visit.detail.title",$scope.defaultBackState="visit-today",CtrlInitiatorService.initCanBackViewCtrl($scope),$scope.isClosed=function(){return null!=$scope.record&&$scope.record.closed},$scope.getTimeDisplay=function(){var duration,minute,second,time;return null!=$scope.record&&null!=$scope.record.duration&&null!=$scope.record.startTime&&null!=$scope.record.endTime?(minute=parseInt($scope.record.duration/6e4),second=parseInt($scope.record.duration/1e3%60),duration=minute+"m "+second+"s",time=$filter("isoTime")($scope.record.startTime)+" - "+$filter("isoTime")($scope.record.endTime),time+" ("+duration+")"):""},$scope.getDurationDisplay=function(){var minute,second;return null!=$scope.record&&null!=$scope.record.duration?(minute=parseInt($scope.record.duration/6e4),second=parseInt($scope.record.duration/1e3%60),minute+"m "+second+"s"):""},$scope.getStartEndDisplay=function(){return null!=$scope.record&&null!=$scope.record.startTime&&null!=$scope.record.endTime?$filter("isoTime")($scope.record.startTime)+" - "+$filter("isoTime")($scope.record.endTime):""},$scope.isErrorDistance=function(){return!(null!=$scope.record&&null!=$scope.record.locationStatus&&0===$scope.record.locationStatus)},$scope.getDistanceDisplay=function(){return null==$scope.record||null==$scope.record.locationStatus||0!==$scope.record.locationStatus&&1!==$scope.record.locationStatus?null!=$scope.record&&null!=$scope.record.locationStatus&&3===$scope.record.locationStatus?$filter("translate")("visit.customer.location.undefined"):$filter("translate")("visit.salesman.location.undefined"):null!=$scope.record.distance?$filter("number")(1e3*$scope.record.distance,0)+" m":""},$scope.hasOrder=function(){return null!=$scope.record&&$scope.record.hasOrder},$scope.getOrderDisplay=function(){return $scope.hasOrder()?$filter("number")($scope.record.grandTotal,0):$filter("translate")("visit.no.order")},$scope.printOrder=function(){return CtrlUtilsService.printOrder("order")},$scope.hasFeedback=function(){return null!=$scope.record&&null!=$scope.record.feedbacks&&$scope.record.feedbacks.length>0},$scope.hasPhoto=function(){return null!=$scope.record&&null!=$scope.record.photo},$scope.getPhoto=function(){return null!=$scope.record&&null!=$scope.record.photo?ADDRESS_BACKEND+"image/"+$scope.record.photo:void 0},staticOnMapReady($scope,function(map){return $scope.map=map,addMarkerToMap()}),addMarkerToMap=function(){var bounds,latLng;return null!=$scope.map?null!=$scope.salesmanMarker||null!=$scope.customerMarker?(null!=$scope.salesmanMarker&&staticAddMarkerToMap($scope.map,$scope.salesmanMarker),null!=$scope.customerMarker&&staticAddMarkerToMap($scope.map,$scope.customerMarker),null!=$scope.salesmanMarker&&null!=$scope.customerMarker?(bounds=new MyLatLngBounds,bounds.extend($scope.salesmanMarker.getPosition()),bounds.extend($scope.customerMarker.getPosition()),$scope.map.fitBounds(bounds)):($scope.map.panTo(null!=$scope.salesmanMarker?$scope.salesmanMarker.getPosition():$scope.customerMarker.getPosition()),$scope.map.setZoom(CtrlUtilsService.getDefaultZoom()+2))):(latLng=new MyLatLng(CtrlUtilsService.getUserInfo().location.latitude,CtrlUtilsService.getUserInfo().location.longitude),$scope.map.setCenter(latLng),$scope.map.setZoom(CtrlUtilsService.getDefaultZoom())):void 0},$scope.reloadData=function(){var params;return params={who:$scope.who,category:"visit",id:$stateParams.id},CtrlUtilsService.loadSingleData(params,$scope.loadStatus.getStatusByDataName("data"),function(record){var latLng;return $scope.record=record,null!=$scope.record.location&&(latLng=new MyLatLng($scope.record.location.latitude,$scope.record.location.longitude),$scope.salesmanMarker=new MyMarker($filter("translate")("salesman.location")),$scope.salesmanMarker.setPosition(latLng),$scope.salesmanMarker.setDraggable(!1),$scope.salesmanMarker.setIcon("images/marker-salesman.png")),null!=$scope.record.customerLocation&&(latLng=new MyLatLng($scope.record.customerLocation.latitude,$scope.record.customerLocation.longitude),$scope.customerMarker=new MyMarker($filter("translate")("customer.location")),$scope.customerMarker.setPosition(latLng),$scope.customerMarker.setDraggable(!1),$scope.customerMarker.setIcon("images/marker-customer.png")),addMarkerToMap()},function(error){return 400===error.status?$state.go("404"):toast.logError($filter("translate")("loading.error"))})},$scope.addInitFunction(function(){return null==$stateParams.id&&$state.go("404"),$scope.map=null,$scope.salesmanMarker=null,$scope.customerMarker=null,$scope.reloadData()}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("OrderPendingCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams){return $scope.title="order.approval.title",$scope.filterChange=function(){return $scope.filter.currentPage=1,$scope.pageChange()},$scope.goToDetail=function(record){return $state.go("order-approval",{id:record.id,filter:$stateParams.filter})},$scope.getReloadDataParams=function(params){return params.category="order",params.subCategory="pending",params},CtrlInitiatorService.initPagingFilterViewCtrl($scope),$scope.addInitFunction(function(){return $scope.reloadData()}),$scope.init()}]).controller("OrderApprovalCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams){var doAction;return $scope.title="order.approval.title",$scope.defaultBackState="order-pending",CtrlInitiatorService.initCanBackViewCtrl($scope),$scope.printOrder=function(){return CtrlUtilsService.printOrder("order")},doAction=function(action,callbackSuccess,callbackFailure){var params,status;return status=$scope.loadStatus.getStatusByDataName("data"),params={who:$scope.who,category:"order",subCategory:"pending",id:$stateParams.id,action:action},CtrlUtilsService.doPut(params,status,null,callbackSuccess,callbackFailure,action)},$scope.approve=function(){return doAction("approve",function(){return $state.go("order-detail",{id:$scope.record.id,parent:"order-pending",filter:$stateParams.filter})})},$scope.reject=function(){return doAction("reject",function(){return $scope.back()})},$scope.reloadData=function(){var params;return params={who:$scope.who,category:"order",subCategory:"pending",id:$stateParams.id},CtrlUtilsService.loadSingleData(params,$scope.loadStatus.getStatusByDataName("data"),function(record){return $scope.record=record},function(error){return 400===error.status?$state.go("404"):toast.logError($filter("translate")("loading.error"))})},$scope.addInitFunction(function(){return null==$stateParams.id&&$state.go("404"),$scope.reloadData()}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("CustomerPendingCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams){return $scope.title="customer.approval.title",$scope.filterChange=function(){return $scope.filter.currentPage=1,$scope.pageChange()},$scope.goToDetail=function(record){return $state.go("customer-approval",{id:record.id,filter:$stateParams.filter})},
$scope.getReloadDataParams=function(params){return params.category="customer",params.subCategory="pending",params},CtrlInitiatorService.initPagingFilterViewCtrl($scope),$scope.addInitFunction(function(){return $scope.reloadData()}),$scope.init()}]).controller("CustomerApprovalCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams){var addMarkerToMap,doAction;return $scope.title="customer.approval.title",$scope.defaultBackState="customer-pending",CtrlInitiatorService.initCanBackViewCtrl($scope),doAction=function(action,callbackSuccess,callbackFailure){var params,status;return status=$scope.loadStatus.getStatusByDataName("data"),params={who:$scope.who,category:"customer",subCategory:"pending",id:$stateParams.id,action:action},CtrlUtilsService.doPut(params,status,null,callbackSuccess,callbackFailure,action)},$scope.approve=function(){return doAction("approve",function(){return $state.go("customer-schedule-single",{id:$stateParams.id})})},$scope.reject=function(){return doAction("reject",function(){return $scope.back()})},staticOnMapReady($scope,function(map){return $scope.map=map,addMarkerToMap()}),addMarkerToMap=function(){var latLng;return null!=$scope.map?null!=$scope.marker?(staticAddMarkerToMap($scope.map,$scope.marker),$scope.map.panTo($scope.marker.getPosition()),$scope.map.setZoom(CtrlUtilsService.getDefaultZoom()+1)):(latLng=new MyLatLng(CtrlUtilsService.getUserInfo().location.latitude,CtrlUtilsService.getUserInfo().location.longitude),$scope.map.setCenter(latLng),$scope.map.setZoom(CtrlUtilsService.getDefaultZoom())):void 0},$scope.reloadData=function(){var params;return params={who:$scope.who,category:"customer",subCategory:"pending",id:$stateParams.id},CtrlUtilsService.loadSingleData(params,$scope.loadStatus.getStatusByDataName("data"),function(record){var latLng;return $scope.record=record,null!=$scope.record.location&&(latLng=new MyLatLng($scope.record.location.latitude,$scope.record.location.longitude),$scope.marker=new MyMarker($filter("translate")("customer.location")),$scope.marker.setPosition(latLng),$scope.marker.setDraggable(!1),$scope.marker.setIcon("images/marker-customer.png")),addMarkerToMap()},function(error){return 400===error.status?$state.go("404"):toast.logError($filter("translate")("loading.error"))})},$scope.addInitFunction(function(){return null==$stateParams.id&&$state.go("404"),$scope.map=null,$scope.marker=null,$scope.reloadData()}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("FeedbackCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams){return $scope.title="feedback.title",$scope.filterChange=function(){return $scope.filter.currentPage=1,$scope.pageChange()},$scope.goToDetail=function(record){return $state.go("feedback-detail",{id:record.id,filter:$stateParams.filter})},$scope.getFeedbackDisplay=function(record){return null!=record.firstMessage?record.firstMessage:"N/A"},$scope.getTimeDisplay=function(isoTime){var date;return date=globalUtils.parseIsoTime(isoTime),$scope.today.getFullYear()===date.getFullYear()&&$scope.today.getMonth()===date.getMonth()&&$scope.today.getDate()===date.getDate()?moment(date).format("HH:mm"):moment(date).format(CtrlUtilsService.getUserInfo().dateFormat.toUpperCase())},$scope.getReloadDataParams=function(params){return params.category="feedback",null!=$scope.filter.orderForDP&&("normal"===$scope.filter.orderForDP?params.orderForDP=!1:"dp"===$scope.filter.orderForDP&&(params.orderForDP=!0)),params},CtrlInitiatorService.initPagingFilterViewCtrl($scope),$scope.addInitFunction(function(){return $scope.today=new Date,$scope.reloadData()}),$scope.init()}]).controller("FeedbackDetailCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams){return $scope.title="feedback.title",$scope.defaultBackState="feedback",CtrlInitiatorService.initCanBackViewCtrl($scope),$scope.reloadData=function(){var params;return params={who:$scope.who,category:"feedback",id:$stateParams.id},CtrlUtilsService.loadSingleData(params,$scope.loadStatus.getStatusByDataName("data"),function(record){return $scope.record=record},function(error){return 400===error.status?$state.go("404"):toast.logError($filter("translate")("loading.error"))})},$scope.addInitFunction(function(){return null==$stateParams.id&&$state.go("404"),$scope.reloadData()}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("OrderSearchCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","LoadingUtilsService","$filter","toast","$state","$modal",function($scope,CtrlUtilsService,CtrlInitiatorService,LoadingUtilsService,$filter,toast,$state,$modal){var checkDate,checkDateDuration,loadSalesmen;return $scope.title="order",$scope.isUseDistributorFilter=function(){return"distributor"!==CtrlUtilsService.getWho()},$scope.search=function(){var distributor,filter,params;return $scope.filter.searchByCode?null==$scope.filter.code?toast.logError($filter("translate")("error.data.input.not.valid")):(params={who:$scope.who,category:"order",subCategory:"by-code",code:$scope.filter.code},CtrlUtilsService.loadSingleData(params,$scope.loadStatus.getStatusByDataName("distributor"),function(record){var message;return null!=record&&null!=record.id?$state.go("order-detail",{id:record.id,parent:"order-search"}):(message=$filter("translate")("order")+" "+$scope.filter.code+" "+$filter("translate")("not.found"),toast.logError(message))},function(){return $state.go("500")})):$scope.isDisplayDistributor()&&null==$scope.filter.distributorId?toast.logError($filter("translate")("please.select.distributor")):checkDate()?checkDateDuration()?(distributor=_.find($scope.distributors,function(o){return o.id===$scope.filter.distributorId}),filter={fromDate:globalUtils.createIsoDate($scope.fromDate.date),toDate:globalUtils.createIsoDate($scope.toDate.date),distributorId:$scope.filter.distributorId,distributorName:null!=distributor?distributor.name:null},null!=$scope.filter.salesmanId&&"all"!==$scope.filter.salesmanId&&(filter.salesmanId=$scope.filter.salesmanId,filter.salesmanName=_.find($scope.salesmen,function(o){return o.id===$scope.filter.salesmanId}).fullname),null!=$scope.filter.customerId&&(filter.customerId=$scope.filter.customerId,filter.customerName=$scope.filter.customerName),$state.go("order-list",{filter:$scope.convertFilterAsString(filter)})):toast.logError($filter("translate")("max.duration.between.from.date.and.to.date.is.1.month")):toast.logError($filter("translate")("from.date.cannot.be.greater.than.to.date"))},checkDateDuration=function(){return!(moment($scope.fromDate.date).add(1,"months").toDate().getTime()<$scope.toDate.date.getTime())},checkDate=function(){return!!(null!=$scope.fromDate&&null!=$scope.fromDate.date&&$scope.toDate&&null!=$scope.toDate.date&&$scope.fromDate.date.getTime()<=$scope.toDate.date.getTime())},$scope.isDisplayCode=function(){return $scope.filter.searchByCode},$scope.isDisplayDate=function(){return!$scope.filter.searchByCode},$scope.isDisplayDistributor=function(){return $scope.isUseDistributorFilter()&&!$scope.filter.searchByCode},$scope.isDisplaySalesman=function(){return null!=$scope.filter.distributorId&&!$scope.filter.searchByCode},$scope.isDisplayCustomer=function(){return null!=$scope.filter.distributorId&&!$scope.filter.searchByCode},$scope.changeDistributor=function(){return $scope.filter.salesmanId="all",loadSalesmen(),$scope.clearCustomer()},loadSalesmen=function(){return LoadingUtilsService.loadSalesmenByDistributor($scope.who,$scope.filter.distributorId,$scope.loadStatus.getStatusByDataName("salesmen"),function(list){return $scope.salesmen=_.union([{id:"all",fullname:"-- "+$filter("translate")("all")+" --"}],list)})},$scope.openSelectCustomer=function(){var modalInstance;return modalInstance=$modal.open({templateUrl:"views/business/customer/customer-select-popup.html",controller:"CustomerSelectPopupCtrl",resolve:{distributorId:function(){return $scope.filter.distributorId},distributorName:function(){return _.find($scope.distributors,function(o){return o.id===$scope.filter.distributorId}).name}},backdrop:!0}),modalInstance.result.then(function(customer){return $scope.filter.customerId=customer.id,$scope.filter.customerName=customer.name})},$scope.clearCustomer=function(){return $scope.filter.customerId=null,$scope.filter.customerName="-- "+$filter("translate")("all")+" --"},CtrlInitiatorService.initFilterViewCtrl($scope),CtrlInitiatorService.initUseDatePickerCtrl($scope),$scope.addInitFunction(function(){return null==$scope.filter.searchByCode&&($scope.filter.searchByCode=!1),null!=$scope.filter.fromDate&&null!=$scope.filter.toDate?($scope.fromDate=$scope.createDatePickerModel(globalUtils.parseIsoDate($scope.filter.fromDate)),$scope.toDate=$scope.createDatePickerModel(globalUtils.parseIsoDate($scope.filter.toDate)),checkDate()&&checkDateDuration()||$state.go("404")):($scope.fromDate=$scope.createDatePickerModel(new Date),$scope.toDate=$scope.createDatePickerModel(new Date)),null==$scope.filter.salesmanId&&($scope.filter.salesmanId="all"),null==$scope.filter.customerId&&($scope.filter.customerName="-- "+$filter("translate")("all")+" --"),LoadingUtilsService.loadDistributors($scope.who,$scope.loadStatus.getStatusByDataName("distributors"),function(list){return $scope.distributors=list}),$scope.isDisplaySalesman()?loadSalesmen():void 0}),$scope.init()}]).controller("OrderListCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams",function($scope,CtrlUtilsService,CtrlInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams){var checkDate,checkDateDuration;return $scope.title="order",$scope.isUseDistributorFilter=function(){return"distributor"!==CtrlUtilsService.getWho()},$scope.defaultBackState="order-search",$scope.getParentFilter=function(){var parentFilter,_ref;return null==$stateParams.parent||"order-search"===$stateParams.parent?(parentFilter={searchByCode:!1,fromDate:$scope.filter.fromDate,toDate:$scope.filter.toDate,distributorId:$scope.filter.distributorId,salesmanId:$scope.filter.salesmanId,customerId:$scope.filter.customerId,customerName:$scope.filter.customerName},$scope.convertFilterAsString(parentFilter)):null!=(_ref=$stateParams.parentFilter)?_ref:$stateParams.filter},$scope.goToDetail=function(record){return $state.go("order-detail",{id:record.id,parent:"order-list",filter:$stateParams.filter})},checkDateDuration=function(){return!(moment($scope.fromDate).add(1,"months").toDate().getTime()<$scope.toDate.getTime())},checkDate=function(){return null!=$scope.fromDate&&null!=$scope.toDate&&$scope.fromDate.getTime()<=$scope.toDate.getTime()},$scope.isDisplaySalesman=function(){return null!=$scope.filter.salesmanId&&"all"!==$scope.filter.salesmanId},$scope.isDisplayCustomer=function(){return null!=$scope.filter.customerId},$scope.getReloadDataParams=function(params){return params.category="order",params.fromDate=$scope.filter.fromDate,params.toDate=$scope.filter.toDate,$scope.isUseDistributorFilter()&&(params.distributorId=$scope.filter.distributorId),$scope.isDisplaySalesman()&&(params.salesmanId=$scope.filter.salesmanId),$scope.isDisplayCustomer()&&(params.customerId=$scope.filter.customerId),params},CtrlInitiatorService.initPagingFilterViewCtrl($scope),CtrlInitiatorService.initCanBackViewCtrl($scope),$scope.addInitFunction(function(){var valid;return valid=!0,null!=$scope.filter.fromDate&&null!=$scope.filter.toDate?($scope.fromDate=globalUtils.parseIsoDate($scope.filter.fromDate),$scope.toDate=globalUtils.parseIsoDate($scope.filter.toDate),checkDate()||checkDateDuration()||(valid=!1,$state.go("404"))):(valid=!1,$state.go("404")),valid?$scope.reloadData():void 0}),$scope.init()}]).controller("OrderDetailCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams){return $scope.title="order.approval.title",$scope.defaultBackState="order-search",$scope.getParentFilter=function(){var _ref;return null==$stateParams.parent||"order-search"===$stateParams.parent?$scope.convertFilterAsString({searchByCode:!0,code:$scope.record.code}):null!=(_ref=$stateParams.parentFilter)?_ref:$stateParams.filter},CtrlInitiatorService.initFilterViewCtrl($scope),CtrlInitiatorService.initCanBackViewCtrl($scope),$scope.printOrder=function(){return CtrlUtilsService.printOrder("order")},$scope.reloadData=function(){var params;return params={who:$scope.who,category:"order",id:$stateParams.id},CtrlUtilsService.loadSingleData(params,$scope.loadStatus.getStatusByDataName("data"),function(record){return $scope.record=record},function(error){return 400===error.status?$state.go("404"):toast.logError($filter("translate")("loading.error"))})},$scope.addInitFunction(function(){return null==$stateParams.id&&$state.go("404"),$scope.reloadData()}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("VisitSearchCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","LoadingUtilsService","$filter","toast","$state","$modal",function($scope,CtrlUtilsService,CtrlInitiatorService,LoadingUtilsService,$filter,toast,$state,$modal){var checkDate,checkDateDuration,loadSalesmen;return $scope.title="visit",$scope.isUseDistributorFilter=function(){return"distributor"!==CtrlUtilsService.getWho()},$scope.search=function(){var filter;return $scope.isDisplayDistributor()&&null==$scope.filter.distributorId?toast.logError($filter("translate")("please.select.distributor")):checkDate()?checkDateDuration()?(filter={fromDate:globalUtils.createIsoDate($scope.fromDate.date),toDate:globalUtils.createIsoDate($scope.toDate.date),distributorId:$scope.filter.distributorId,distributorName:_.find($scope.distributors,function(o){return o.id===$scope.filter.distributorId}).name},null!=$scope.filter.salesmanId&&"all"!==$scope.filter.salesmanId&&(filter.salesmanId=$scope.filter.salesmanId,filter.salesmanName=_.find($scope.salesmen,function(o){return o.id===$scope.filter.salesmanId}).fullname),null!=$scope.filter.customerId&&(filter.customerId=$scope.filter.customerId,filter.customerName=$scope.filter.customerName),$state.go("visit-list",{filter:$scope.convertFilterAsString(filter)})):toast.logError($filter("translate")("max.duration.between.from.date.and.to.date.is.1.month")):toast.logError($filter("translate")("from.date.cannot.be.greater.than.to.date"))},checkDateDuration=function(){return!(moment($scope.fromDate.date).add(1,"months").toDate().getTime()<$scope.toDate.date.getTime())},checkDate=function(){return!!(null!=$scope.fromDate&&null!=$scope.fromDate.date&&$scope.toDate&&null!=$scope.toDate.date&&$scope.fromDate.date.getTime()<=$scope.toDate.date.getTime())},$scope.isDisplayDate=function(){return!0},$scope.isDisplayDistributor=function(){return $scope.isUseDistributorFilter()},$scope.isDisplaySalesman=function(){return null!=$scope.filter.distributorId},$scope.isDisplayCustomer=function(){return null!=$scope.filter.distributorId},$scope.changeDistributor=function(){return $scope.filter.salesmanId="all",loadSalesmen(),$scope.clearCustomer()},loadSalesmen=function(){return LoadingUtilsService.loadSalesmenByDistributor($scope.who,$scope.filter.distributorId,$scope.loadStatus.getStatusByDataName("salesmen"),function(list){return $scope.salesmen=_.union([{id:"all",fullname:"-- "+$filter("translate")("all")+" --"}],list)})},$scope.openSelectCustomer=function(){var modalInstance;return modalInstance=$modal.open({templateUrl:"views/business/customer/customer-select-popup.html",controller:"CustomerSelectPopupCtrl",resolve:{distributorId:function(){return $scope.filter.distributorId},distributorName:function(){return _.find($scope.distributors,function(o){return o.id===$scope.filter.distributorId}).name}},backdrop:!0}),modalInstance.result.then(function(customer){return $scope.filter.customerId=customer.id,$scope.filter.customerName=customer.name})},$scope.clearCustomer=function(){return $scope.filter.customerId=null,$scope.filter.customerName="-- "+$filter("translate")("all")+" --"},CtrlInitiatorService.initFilterViewCtrl($scope),CtrlInitiatorService.initUseDatePickerCtrl($scope),$scope.addInitFunction(function(){return null!=$scope.filter.fromDate&&null!=$scope.filter.toDate?($scope.fromDate=$scope.createDatePickerModel(globalUtils.parseIsoDate($scope.filter.fromDate)),$scope.toDate=$scope.createDatePickerModel(globalUtils.parseIsoDate($scope.filter.toDate)),checkDate()&&checkDateDuration()||$state.go("404")):($scope.fromDate=$scope.createDatePickerModel(new Date),$scope.toDate=$scope.createDatePickerModel(new Date)),null==$scope.filter.salesmanId&&($scope.filter.salesmanId="all"),null==$scope.filter.customerId&&($scope.filter.customerName="-- "+$filter("translate")("all")+" --"),LoadingUtilsService.loadDistributors($scope.who,$scope.loadStatus.getStatusByDataName("distributors"),function(list){return $scope.distributors=list}),$scope.isDisplaySalesman()?loadSalesmen():void 0}),$scope.init()}]).controller("VisitListCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams",function($scope,CtrlUtilsService,CtrlInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams){var checkDate,checkDateDuration;return $scope.title="visit",$scope.isUseDistributorFilter=function(){return"distributor"!==CtrlUtilsService.getWho()},$scope.defaultBackState="visit-search",$scope.getParentFilter=function(){var parentFilter,_ref;return null==$stateParams.parent||"visit-search"===$stateParams.parent?(parentFilter={fromDate:$scope.filter.fromDate,toDate:$scope.filter.toDate,distributorId:$scope.filter.distributorId,salesmanId:$scope.filter.salesmanId,customerId:$scope.filter.customerId,customerName:$scope.filter.customerName},$scope.convertFilterAsString(parentFilter)):null!=(_ref=$stateParams.parentFilter)?_ref:$stateParams.filter},$scope.goToDetail=function(record){return $state.go("visit-detail",{id:record.id,parent:"visit-list",filter:$stateParams.filter})},checkDateDuration=function(){return!(moment($scope.fromDate).add(1,"months").toDate().getTime()<$scope.toDate.getTime())},checkDate=function(){return null!=$scope.fromDate&&null!=$scope.toDate&&$scope.fromDate.getTime()<=$scope.toDate.getTime()},$scope.isDisplaySalesman=function(){return null!=$scope.filter.salesmanId&&"all"!==$scope.filter.salesmanId},$scope.isDisplayCustomer=function(){return null!=$scope.filter.customerId},$scope.getDurationDisplay=function(duration){var minute,second;return null!=duration?(minute=parseInt(duration/6e4),second=parseInt(duration/1e3%60),minute+"m "+second+"s"):""},$scope.getStartEndDisplay=function(record){return null!=record&&null!=record.startTime&&null!=record.endTime?$filter("isoTime")(record.startTime)+" - "+$filter("isoTime")(record.endTime):""},$scope.isDistanceNormal=function(record){return null!=record.locationStatus&&0===record.locationStatus},$scope.isDistanceTooFar=function(record){return null!=record.locationStatus&&1===record.locationStatus},$scope.isLocationSalesmanUndefined=function(record){return null!=record.locationStatus&&2===record.locationStatus},$scope.isLocationCustomerUndefined=function(record){return null!=record.locationStatus&&3===record.locationStatus},$scope.getDistanceDisplay=function(distance){return null!=distance?$filter("number")(1e3*distance,0)+" m":""},$scope.isNoOrder=function(record){return!(null!=record.hasOrder&&record.hasOrder)},$scope.isOrderApproved=function(record){return!$scope.isNoOrder(record)&&1===record.approveStatus},$scope.isOrderPending=function(record){return!$scope.isNoOrder(record)&&0===record.approveStatus},$scope.isOrderRejected=function(record){return!$scope.isNoOrder(record)&&2===record.approveStatus},$scope.getReloadDataParams=function(params){return params.category="visit",params.fromDate=$scope.filter.fromDate,params.toDate=$scope.filter.toDate,$scope.isUseDistributorFilter()&&(params.distributorId=$scope.filter.distributorId),$scope.isDisplaySalesman()&&(params.salesmanId=$scope.filter.salesmanId),$scope.isDisplayCustomer()&&(params.customerId=$scope.filter.customerId),params},CtrlInitiatorService.initPagingFilterViewCtrl($scope),CtrlInitiatorService.initCanBackViewCtrl($scope),$scope.addInitFunction(function(){var valid;return valid=!0,null!=$scope.filter.fromDate&&null!=$scope.filter.toDate?($scope.fromDate=globalUtils.parseIsoDate($scope.filter.fromDate),$scope.toDate=globalUtils.parseIsoDate($scope.filter.toDate),checkDate()||checkDateDuration()||(valid=!1,$state.go("404"))):(valid=!1,$state.go("404")),valid?$scope.reloadData():void 0}),$scope.init()}])}.call(this),function(){"use strict";var chartOptions;chartOptions={colors:["#26A69A","#607D8B","#26C6DA"],tooltip:{show:!0},tooltipOpts:{defaultTheme:!1},grid:{hoverable:!0,clickable:!0,tickColor:"#f9f9f9",borderWidth:1,borderColor:"#eeeeee"},yaxes:[{},{position:"right"}]},angular.module("app").controller("SalesReportCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state){return $scope.title="sales.report.title",$scope.isUseDistributorFilter=function(){return"distributor"!==CtrlUtilsService.getWho()},$scope.goToReport=function(){return $scope.filter.date=globalUtils.createIsoDate($scope.date.date),$scope.isDisplayDistributor()&&null==$scope.filter.distributorId?toast.logError($filter("translate")("please.select.distributor")):$scope.isDisplayProductCategory()&&null==$scope.filter.productCategoryId?toast.logError($filter("translate")("error.data.input.not.valid")):($scope.isDisplayDistributorAll()&&("all"===$scope.filter.distributorWithAllId?$scope.filter.distributorId=null:$scope.filter.distributorId=$scope.filter.distributorWithAllId),($scope.isDisplayDistributorAll()&&null==$scope.filter.distributorId||"distributor"===$scope.filter.reportType)&&toast.logWarning($filter("translate")("warning.request.take.time")),"daily"===$scope.filter.reportType?$state.go("sales-report-daily",{filter:$scope.getFilterAsString()}):"distributor"===$scope.filter.reportType?$state.go("sales-report-distributor",{filter:$scope.getFilterAsString()}):"product"===$scope.filter.reportType?$state.go("sales-report-product",{filter:$scope.getFilterAsString()}):"salesman"===$scope.filter.reportType?$state.go("sales-report-salesman",{filter:$scope.getFilterAsString()}):void 0)},$scope.isDisplayDistributor=function(){return"salesman"===$scope.filter.reportType},$scope.isDisplayDistributorAll=function(){return _.includes(["daily","product"],$scope.filter.reportType)},$scope.isDisplayProductCategory=function(){return"product"===$scope.filter.reportType},CtrlInitiatorService.initFilterViewCtrl($scope),CtrlInitiatorService.initUseDatePickerCtrl($scope),$scope.addInitFunction(function(){return null==$scope.filter.reportType&&($scope.filter.reportType="daily"),null!=$scope.filter.date?$scope.date=$scope.createDatePickerModel(globalUtils.parseIsoDate($scope.filter.date)):$scope.date=$scope.createDatePickerModel(new Date),$scope.filter.distributorWithAllId="all",LoadingUtilsService.loadProductCategories($scope.who,$scope.loadStatus.getStatusByDataName("productCategories"),function(list){return $scope.productCategories=list}),LoadingUtilsService.loadDistributors($scope.who,$scope.loadStatus.getStatusByDataName("distributors"),function(list){return $scope.distributors=list,$scope.distributorsWithAll=_.union([{id:"all",name:"-- "+$filter("translate")("all")+" --"}],list)})}),$scope.init()}]).controller("SalesReportDetailCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams){var afterLoad,checkFilter,tooltip;return $scope.title="",$scope.defaultBackState="sales-report",CtrlInitiatorService.initCanBackViewCtrl($scope),CtrlInitiatorService.initFilterViewCtrl($scope),tooltip=function(label,xval,yval,flotItem){return label+" - "+$scope.nameMap[xval-1]+": "+$filter("number")(yval,0)},afterLoad=function(){var data,dto,i,nbOrders,revenues,ticks,_i,_j,_len,_len1,_ref,_ref1;for(revenues=[],nbOrders=[],ticks=[],$scope.nameMap=[],$scope.total={revenue:0,nbOrder:0},_ref=$scope.records,i=_i=0,_len=_ref.length;_len>_i;i=++_i)dto=_ref[i],revenues.push([i+1,dto.salesResult.revenue]),nbOrders.push([i+1,dto.salesResult.nbOrder]),$scope.total.revenue+=dto.salesResult.revenue,$scope.total.nbOrder+=dto.salesResult.nbOrder,"daily"===$scope.filter.reportType?(i+1===1||(i+1)%5===0?ticks.push([i+1,""+(i+1)]):ticks.push([i+1,""]),$scope.nameMap.push(i+1+"/"+moment($scope.date).format("MM/YYYY"))):"distributor"===$scope.filter.reportType?(ticks.push([i+1,globalUtils.getChartLabel(dto.name)]),$scope.nameMap.push(globalUtils.escapeHTML(dto.name))):"product"===$scope.filter.reportType?(ticks.push([i+1,globalUtils.getChartLabel(dto.name)]),$scope.nameMap.push(globalUtils.escapeHTML(dto.name))):"salesman"===$scope.filter.reportType&&(ticks.push([i+1,globalUtils.getChartLabel(dto.fullname)]),$scope.nameMap.push(globalUtils.escapeHTML(dto.fullname)));for($scope.chart.data=[{data:revenues,label:$filter("translate")("revenue")},{data:nbOrders,label:$filter("translate")("order"),yaxis:2}],_ref1=$scope.chart.data,i=_j=0,_len1=_ref1.length;_len1>_j;i=++_j)data=_ref1[i],0===i&&revenues.length<20?data.bars={show:!0,fill:!0,barWidth:.1,align:"center"}:(data.lines={show:!0,fill:!1,fillColor:{colors:[{opacity:0},{opacity:.3}]}},data.points={show:!0,lineWidth:2,fill:!1,fillColor:"#ffffff",symbol:"circle",radius:5},0===i&&(data.lines.fill=!0));return $scope.chart.options.xaxis={autoscaleMargin:.1,ticks:ticks}},$scope.isDisplayChart=function(){return null!=$scope.chart.data&&null!=$scope.chart.data[0].data&&$scope.chart.data[0].data.length>1},$scope.reloadData=function(){var params;return params={who:$scope.who,category:"report",subCategory:"sales",month:$scope.date.getMonth(),year:$scope.date.getFullYear()},"daily"===$scope.filter.reportType?(params.param="daily",params.distributorId=$scope.filter.distributorId):"distributor"===$scope.filter.reportType?params.param="by-distributor":"product"===$scope.filter.reportType?(params.param="by-product",params.productCategoryId=$scope.filter.productCategoryId,params.distributorId=$scope.filter.distributorId):"salesman"===$scope.filter.reportType&&(params.param="by-salesman",params.distributorId=$scope.filter.distributorId),CtrlUtilsService.loadSingleData(params,$scope.loadStatus.getStatusByDataName("data"),function(data){return $scope.records=data.list,afterLoad()},function(error){return 400===error.status?$state.go("404"):toast.logError($filter("translate")("loading.error"))})},checkFilter=function(){return null==$scope.date?!1:"product"===$scope.filter.reportType&&null==$scope.filter.productCategoryId?!1:"salesman"!==$scope.filter.reportType||null!=$scope.filter.distributorId},$scope.addInitFunction(function(){var reportTitle;return $scope.chart={},$scope.chart.options=angular.copy(chartOptions),$scope.chart.options.tooltip.content=tooltip,null!=$scope.filter&&null!=$scope.filter.date?($scope.date=globalUtils.parseIsoDate($scope.filter.date),checkFilter()?(reportTitle=null,"daily"===$scope.filter.reportType?reportTitle=$filter("translate")("sales.report.daily.title"):"distributor"===$scope.filter.reportType?reportTitle=$filter("translate")("sales.report.distributor.title"):"product"===$scope.filter.reportType?reportTitle=$filter("translate")("sales.report.product.title"):"salesman"===$scope.filter.reportType&&(reportTitle=$filter("translate")("sales.report.salesman.title")),$scope.title=reportTitle+" - "+moment($scope.date).format("MM-YYYY"),$scope.reloadData()):$state.go("404")):$state.go("404")}),$scope.init()}])}.call(this),function(){"use strict";var chartOptions;chartOptions={colors:["#26A69A","#607D8B","#26C6DA"],tooltip:{show:!0},tooltipOpts:{defaultTheme:!1},grid:{hoverable:!0,clickable:!0,tickColor:"#f9f9f9",borderWidth:1,borderColor:"#eeeeee"}},angular.module("app").controller("VisitReportCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state){return $scope.title="visit.report.title",$scope.isUseDistributorFilter=function(){return"distributor"!==CtrlUtilsService.getWho()},$scope.goToReport=function(){return $scope.filter.date=globalUtils.createIsoDate($scope.date.date),$scope.isDisplayDistributor()&&null==$scope.filter.distributorId?toast.logError($filter("translate")("please.select.distributor")):($scope.isDisplayDistributorAll()&&("all"===$scope.filter.distributorWithAllId?$scope.filter.distributorId=null:$scope.filter.distributorId=$scope.filter.distributorWithAllId),($scope.isDisplayDistributorAll()&&null==$scope.filter.distributorId||"distributor"===$scope.filter.reportType)&&toast.logWarning($filter("translate")("warning.request.take.time")),"daily"===$scope.filter.reportType?$state.go("visit-report-daily",{filter:$scope.getFilterAsString()}):"distributor"===$scope.filter.reportType?$state.go("visit-report-distributor",{filter:$scope.getFilterAsString()}):"salesman"===$scope.filter.reportType?$state.go("visit-report-salesman",{filter:$scope.getFilterAsString()}):void 0)},$scope.isDisplayDistributor=function(){return"salesman"===$scope.filter.reportType},$scope.isDisplayDistributorAll=function(){return"daily"===$scope.filter.reportType},CtrlInitiatorService.initFilterViewCtrl($scope),CtrlInitiatorService.initUseDatePickerCtrl($scope),$scope.addInitFunction(function(){return null==$scope.filter.reportType&&($scope.filter.reportType="daily"),null!=$scope.filter.date?$scope.date=$scope.createDatePickerModel(globalUtils.parseIsoDate($scope.filter.date)):$scope.date=$scope.createDatePickerModel(new Date),$scope.filter.distributorWithAllId="all",LoadingUtilsService.loadDistributors($scope.who,$scope.loadStatus.getStatusByDataName("distributors"),function(list){return $scope.distributors=list,$scope.distributorsWithAll=_.union([{id:"all",name:"-- "+$filter("translate")("all")+" --"}],list)})}),$scope.init()}]).controller("VisitReportDetailCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams){var afterLoad,checkFilter,tooltip;return $scope.title="",$scope.defaultBackState="visit-report",tooltip=function(label,xval,yval,flotItem){return label+" - "+$scope.nameMap[xval-1]+": "+$filter("number")(yval,0)},CtrlInitiatorService.initCanBackViewCtrl($scope),CtrlInitiatorService.initFilterViewCtrl($scope),afterLoad=function(){var data,dto,i,nbVisitErrorDurations,nbVisitErrorPositions,nbVisits,ticks,_i,_j,_len,_len1,_ref,_ref1;for(nbVisits=[],nbVisitErrorDurations=[],
nbVisitErrorPositions=[],ticks=[],$scope.nameMap=[],$scope.total={nbVisit:0,nbVisitErrorDuration:0,nbVisitErrorPosition:0},_ref=$scope.records,i=_i=0,_len=_ref.length;_len>_i;i=++_i)dto=_ref[i],nbVisits.push([i+1,dto.visitResult.nbVisit]),nbVisitErrorDurations.push([i+1,dto.visitResult.nbVisitErrorDuration]),nbVisitErrorPositions.push([i+1,dto.visitResult.nbVisitErrorPosition]),$scope.total.nbVisit+=dto.visitResult.nbVisit,$scope.total.nbVisitErrorDuration+=dto.visitResult.nbVisitErrorDuration,$scope.total.nbVisitErrorPosition+=dto.visitResult.nbVisitErrorPosition,"daily"===$scope.filter.reportType?(i+1===1||(i+1)%5===0?ticks.push([i+1,""+(i+1)]):ticks.push([i+1,""]),$scope.nameMap.push(i+1+"/"+moment($scope.date).format("MM/YYYY"))):"distributor"===$scope.filter.reportType?(ticks.push([i+1,globalUtils.getChartLabel(dto.name)]),$scope.nameMap.push(globalUtils.escapeHTML(dto.name))):"salesman"===$scope.filter.reportType&&(ticks.push([i+1,globalUtils.getChartLabel(dto.fullname)]),$scope.nameMap.push(globalUtils.escapeHTML(dto.fullname)));for($scope.chart.data=[{data:nbVisits,label:$filter("translate")("visit")},{data:nbVisitErrorPositions,label:$filter("translate")("visit.error.duration")}],_ref1=$scope.chart.data,i=_j=0,_len1=_ref1.length;_len1>_j;i=++_j)data=_ref1[i],0===i&&nbVisits.length<20?data.bars={show:!0,fill:!0,barWidth:.1,align:"center"}:(data.lines={show:!0,fill:!1,fillColor:{colors:[{opacity:0},{opacity:.3}]}},data.points={show:!0,lineWidth:2,fill:!1,fillColor:"#ffffff",symbol:"circle",radius:5},0===i&&(data.lines.fill=!0));return $scope.chart.options.xaxis={autoscaleMargin:.1,ticks:ticks}},$scope.isDisplayChart=function(){return null!=$scope.chart.data&&null!=$scope.chart.data[0].data&&$scope.chart.data[0].data.length>1},$scope.reloadData=function(){var params;return params={who:$scope.who,category:"report",subCategory:"visit",month:$scope.date.getMonth(),year:$scope.date.getFullYear()},"daily"===$scope.filter.reportType?(params.param="daily",params.distributorId=$scope.filter.distributorId):"distributor"===$scope.filter.reportType?params.param="by-distributor":"salesman"===$scope.filter.reportType&&(params.param="by-salesman",params.distributorId=$scope.filter.distributorId),CtrlUtilsService.loadSingleData(params,$scope.loadStatus.getStatusByDataName("data"),function(data){return $scope.records=data.list,afterLoad()},function(error){return 400===error.status?$state.go("404"):toast.logError($filter("translate")("loading.error"))})},checkFilter=function(){return null==$scope.date?!1:"salesman"!==$scope.filter.reportType||null!=$scope.filter.distributorId},$scope.addInitFunction(function(){var reportTitle;return $scope.chart={},$scope.chart.options=angular.copy(chartOptions),$scope.chart.options.tooltip.content=tooltip,null!=$scope.filter&&null!=$scope.filter.date?($scope.date=globalUtils.parseIsoDate($scope.filter.date),checkFilter()?(reportTitle=null,"daily"===$scope.filter.reportType?reportTitle=$filter("translate")("visit.report.daily.title"):"distributor"===$scope.filter.reportType?reportTitle=$filter("translate")("visit.report.distributor.title"):"salesman"===$scope.filter.reportType&&(reportTitle=$filter("translate")("visit.report.salesman.title")),$scope.title=reportTitle+" - "+moment($scope.date).format("MM-YYYY"),$scope.reloadData()):$state.go("404")):$state.go("404")}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("SurveyReportCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams","ADDRESS_BACKEND","$token",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams,ADDRESS_BACKEND,$token){return $scope.title="survey.report.title",$scope.goToReport=function(record){return toast.logWarning($filter("translate")("warning.request.take.time")),$state.go("survey-report-detail",{id:record.id,filter:$stateParams.filter})},$scope["export"]=function(record){return toast.logWarning($filter("translate")("warning.request.take.time")),location.href=ADDRESS_BACKEND+$scope.who+"/report/survey/"+record.id+"/export?access_token="+$token.getAccessToken()+"&lang="+CtrlUtilsService.getUserLanguage()},$scope.getReloadDataParams=function(params){return params.category="report",params.subCategory="survey",params},CtrlInitiatorService.initPagingFilterViewCtrl($scope),$scope.addInitFunction(function(){return $scope.reloadData()}),$scope.init()}]).controller("SurveyReportDetailCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams){var afterLoad,pieOptions;return $scope.title="survey.report.title",$scope.defaultBackState="survey-report",CtrlInitiatorService.initCanBackViewCtrl($scope),CtrlInitiatorService.initFilterViewCtrl($scope),pieOptions={series:{pie:{show:!0}},legend:{show:!0},grid:{hoverable:!0,clickable:!1},colors:["#60CD9B","#66B5D7","#EEC95A","#E87352"],tooltip:!0,tooltipOpts:{content:"%p.0%, %s",defaultTheme:!1}},afterLoad=function(){var option,question,_i,_j,_len,_len1,_ref,_ref1,_results;if(null!=$scope.record&&null!=$scope.record.questions){for(_ref=$scope.record.questions,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)if(question=_ref[_i],question.data=[],question.option={},null!=question.options){for(_ref1=question.options,_j=0,_len1=_ref1.length;_len1>_j;_j++)option=_ref1[_j],question.data.push({label:globalUtils.escapeHTML(option.name)+" ("+option.result+") ",data:option.result});_results.push(question.option=pieOptions)}else _results.push(void 0);return _results}},$scope.reloadData=function(){var params;return params={who:$scope.who,category:"report",subCategory:"survey",id:$stateParams.id},CtrlUtilsService.loadSingleData(params,$scope.loadStatus.getStatusByDataName("data"),function(data){return $scope.record=data,afterLoad()},function(error){return 400===error.status?$state.go("404"):toast.logError($filter("translate")("loading.error"))})},$scope.addInitFunction(function(){return null==$stateParams.id?$state.go("404"):$scope.reloadData()}),$scope.init()}])}.call(this),function(){"use strict";var chartOptions;chartOptions={colors:["#26A69A","#607D8B","#26C6DA"],tooltip:{show:!0},tooltipOpts:{defaultTheme:!1},grid:{hoverable:!0,clickable:!0,tickColor:"#f9f9f9",borderWidth:1,borderColor:"#eeeeee"},yaxes:[{},{position:"right"}]},angular.module("app").controller("PerformanceReportCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state){return $scope.title="performance.report.title",$scope.isUseDistributorFilter=function(){return"distributor"!==CtrlUtilsService.getWho()},$scope.goToReport=function(){return $scope.filter.date=globalUtils.createIsoDate($scope.date.date),$scope.isUseDistributorFilter()&&null==$scope.filter.distributorId?toast.logError($filter("translate")("error.data.input.not.valid")):null==$scope.filter.salesmanId?toast.logError($filter("translate")("error.data.input.not.valid")):$state.go("performance-report-salesman",{filter:$scope.getFilterAsString()})},$scope.isDisplaySalesman=function(){return!$scope.isUseDistributorFilter()||null!=$scope.filter.distributorId},$scope.changeDistributor=function(){return $scope.filter.salesmanId=null,$scope.loadSalesmen()},$scope.loadSalesmen=function(){return LoadingUtilsService.loadSalesmenByDistributor($scope.who,$scope.filter.distributorId,$scope.loadStatus.getStatusByDataName("salesmen"),function(list){return $scope.salesmen=list})},CtrlInitiatorService.initFilterViewCtrl($scope),CtrlInitiatorService.initUseDatePickerCtrl($scope),$scope.addInitFunction(function(){return null!=$scope.filter.date?$scope.date=$scope.createDatePickerModel(globalUtils.parseIsoDate($scope.filter.date)):$scope.date=$scope.createDatePickerModel(new Date),$scope.isUseDistributorFilter()&&LoadingUtilsService.loadDistributors($scope.who,$scope.loadStatus.getStatusByDataName("distributors"),function(list){return $scope.distributors=list}),$scope.isDisplaySalesman()?$scope.loadSalesmen():void 0}),$scope.init()}]).controller("PerformanceReportSalesmanCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams","$token",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams,$token){var afterLoad,tooltip;return $scope.title="performance.report.salesman.title",$scope.defaultBackState="performance-report",tooltip=function(label,xval,yval,flotItem){return label+" - "+$scope.nameMap[xval-1]+": "+$filter("number")(yval,0)},afterLoad=function(){var data,i,nbOrders,revenues,salesResultDaily,ticks,_i,_j,_len,_len1,_ref,_ref1;for(revenues=[],nbOrders=[],ticks=[],$scope.nameMap=[],$scope.total={revenue:0,nbOrder:0},_ref=$scope.record.salesResultsDaily,i=_i=0,_len=_ref.length;_len>_i;i=++_i)salesResultDaily=_ref[i],revenues.push([i+1,salesResultDaily.salesResult.revenue]),nbOrders.push([i+1,salesResultDaily.salesResult.nbOrder]),i+1===1||(i+1)%5===0?ticks.push([i+1,""+(i+1)]):ticks.push([i+1,""]),$scope.nameMap.push($filter("isoDate")(salesResultDaily.date));for($scope.chart.data=[{data:revenues,label:$filter("translate")("revenue")},{data:nbOrders,label:$filter("translate")("order"),yaxis:2}],_ref1=$scope.chart.data,i=_j=0,_len1=_ref1.length;_len1>_j;i=++_j)data=_ref1[i],0===i&&revenues.length<20?data.bars={show:!0,fill:!0,barWidth:.1,align:"center"}:(data.lines={show:!0,fill:!1,fillColor:{colors:[{opacity:0},{opacity:.3}]}},data.points={show:!0,lineWidth:2,fill:!1,fillColor:"#ffffff",symbol:"circle",radius:5},0===i&&(data.lines.fill=!0));return $scope.chart.options.xaxis={autoscaleMargin:.1,ticks:ticks}},$scope.isDisplayChart=function(){return null!=$scope.chart.data&&null!=$scope.chart.data[0].data&&$scope.chart.data[0].data.length>1},$scope.getMonthDisplay=function(){return moment($scope.date).format("MM/YYYY")},$scope.clickOnProductCategory=function(productCategory){return null!=productCategory&&null!=productCategory.id?null!=$scope.productCategoriySalesQuantityId&&$scope.productCategoriySalesQuantityId===productCategory.id?$scope.productCategoriySalesQuantityId=null:$scope.productCategoriySalesQuantityId=productCategory.id:void 0},$scope.isProductCategoryOpened=function(productCategory){return null!=productCategory&&$scope.productCategoriySalesQuantityId===productCategory.id},CtrlInitiatorService.initCanBackViewCtrl($scope),CtrlInitiatorService.initFilterViewCtrl($scope),$scope.getProductivityUnit=function(){return null!=$token.getUserInfo()?$token.getUserInfo().productivityUnit:null},$scope.reloadData=function(){var params;return params={who:$scope.who,category:"performance",subCategory:"by-salesman",month:$scope.date.getMonth(),year:$scope.date.getFullYear(),salesmanId:$scope.filter.salesmanId},CtrlUtilsService.loadSingleData(params,$scope.loadStatus.getStatusByDataName("data"),function(data){return $scope.record=data,afterLoad()},function(error){return 400===error.status?$state.go("404"):toast.logError($filter("translate")("loading.error"))})},$scope.addInitFunction(function(){return $scope.chart={},$scope.chart.options=angular.copy(chartOptions),$scope.chart.options.tooltip.content=tooltip,$scope.productCategoriySalesQuantityId=null,null!=$scope.filter&&null!=$scope.filter.date?($scope.date=globalUtils.parseIsoDate($scope.filter.date),null==$scope.date||null==$scope.filter.salesmanId?$state.go("404"):$scope.reloadData()):$state.go("404")}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("InventoryReportCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state){return $scope.title="inventory.report.title",$scope.isUseDistributorFilter=function(){return"distributor"!==CtrlUtilsService.getWho()},$scope.goToReport=function(){return $scope.isDisplayDistributor()&&null==$scope.filter.distributorId?toast.logError($filter("translate")("please.select.distributor")):$scope.isDisplayProduct()&&null==$scope.filter.productId?toast.logError($filter("translate")("please.select.product")):("distributor"===$scope.filter.reportType&&$state.go("inventory-report-distributor",{filter:$scope.getFilterAsString()}),"product"===$scope.filter.reportType?$state.go("inventory-report-product",{filter:$scope.getFilterAsString()}):void 0)},$scope.isDisplayDistributor=function(){return"distributor"===$scope.filter.reportType&&$scope.isUseDistributorFilter()},$scope.isDisplayProduct=function(){return"product"===$scope.filter.reportType},CtrlInitiatorService.initFilterViewCtrl($scope),CtrlInitiatorService.initUseDatePickerCtrl($scope),$scope.addInitFunction(function(){return null==$scope.filter.reportType&&($scope.filter.reportType="distributor"),LoadingUtilsService.loadDistributors($scope.who,$scope.loadStatus.getStatusByDataName("distributors"),function(list){return $scope.distributors=list}),LoadingUtilsService.loadProductsByDistributor($scope.who,$scope.loadStatus.getStatusByDataName("products"),function(list){return $scope.products=list})}),$scope.init()}]).controller("InventoryReportDistributorCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams","ADDRESS_BACKEND","$token",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams,ADDRESS_BACKEND,$token){return $scope.title="inventory.report.title",$scope.defaultBackState="inventory-report",$scope.isUseDistributorFilter=function(){return"distributor"!==CtrlUtilsService.getWho()},CtrlInitiatorService.initCanBackViewCtrl($scope),CtrlInitiatorService.initFilterViewCtrl($scope),$scope.getLastInventoryUpdateTime=function(){return null!=$scope.record&&null!=$scope.record.lastInventory?$filter("isoDateTimeWithoutSecond")($scope.record.lastInventory.time):"N/A"},$scope.getPhotoLink=function(photoId){return ADDRESS_BACKEND+"image/"+photoId},$scope.getQuantityDisplay=function(quantity){return null!=quantity?$filter("number")(quantity,0):"N/A"},$scope["export"]=function(){var href;return href=ADDRESS_BACKEND+$scope.who+"/export/inventory-report/by-distributor",href=href+"?access_token="+$token.getAccessToken(),$scope.isUseDistributorFilter()&&null!=$scope.filter.distributorId&&(href=href+"&distributorId="+$scope.filter.distributorId),href=href+"&lang="+CtrlUtilsService.getUserLanguage(),location.href=href},$scope.reloadData=function(){var params;return params={who:$scope.who,category:"report",subCategory:"inventory",param:"by-distributor"},$scope.isUseDistributorFilter()&&null!=$scope.filter.distributorId&&(params.distributorId=$scope.filter.distributorId),CtrlUtilsService.loadSingleData(params,$scope.loadStatus.getStatusByDataName("data"),function(record){var categories,category,categoryMap,product,_i,_j,_len,_len1,_ref,_results;if($scope.record=record,$scope.products=[],null!=$scope.record.products){for(categories=[],categoryMap={},_ref=$scope.record.products,_i=0,_len=_ref.length;_len>_i;_i++)product=_ref[_i],null==categoryMap[product.productCategory.id]&&(categories.push(product.productCategory),categoryMap[product.productCategory.id]={},categoryMap[product.productCategory.id].name=product.productCategory.name,categoryMap[product.productCategory.id].products=[]),product.isCategory=!1,categoryMap[product.productCategory.id].products.push(product);for(categories=_.sortBy(categories,function(o){return o.name}),_results=[],_j=0,_len1=categories.length;_len1>_j;_j++)category=categories[_j],_results.push($scope.products=_.concat($scope.products,{isCategory:!0,name:categoryMap[category.id].name},_.sortBy(categoryMap[category.id].products,function(o){return o.name})));return _results}},function(error){return 400===error.status?$state.go("404"):toast.logError($filter("translate")("loading.error"))})},$scope.addInitFunction(function(){return null!=$scope.filter?$scope.isUseDistributorFilter()&&null==$scope.filter.distributorId?$state.go("404"):$scope.reloadData():$state.go("404")}),$scope.init()}]).controller("InventoryReportProductCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams","ADDRESS_BACKEND","$token",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams,ADDRESS_BACKEND,$token){return $scope.title="inventory.report.title",$scope.defaultBackState="inventory-report",CtrlInitiatorService.initCanBackViewCtrl($scope),CtrlInitiatorService.initFilterViewCtrl($scope),$scope["export"]=function(){var href;return href=ADDRESS_BACKEND+$scope.who+"/export/inventory-report/by-product",href=href+"?access_token="+$token.getAccessToken(),href=href+"&productId="+$scope.filter.productId,href=href+"&lang="+CtrlUtilsService.getUserLanguage(),location.href=href},$scope.getLastInventoryUpdateTime=function(distributor){return null!=distributor&&null!=distributor.lastInventory?$filter("isoDateTimeWithoutSecond")(distributor.lastInventory.time):"N/A"},$scope.getQuantityDisplay=function(quantity){return null!=quantity?$filter("number")(quantity,0):"N/A"},$scope.reloadData=function(){var params;return params={who:$scope.who,category:"report",subCategory:"inventory",param:"by-product",productId:$scope.filter.productId},CtrlUtilsService.loadSingleData(params,$scope.loadStatus.getStatusByDataName("data"),function(record){return $scope.record=record,null!=$scope.record.distributors?$scope.record.distributors=_.sortBy($scope.record.distributors,function(o){return o.name}):$scope.record.distributors=[]},function(error){return 400===error.status?$state.go("404"):toast.logError($filter("translate")("loading.error"))})},$scope.addInitFunction(function(){return null!=$scope.filter?null==$scope.filter.productId?$state.go("404"):$scope.reloadData():$state.go("404")}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("OrderExportCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","LoadingUtilsService","$filter","toast","$state","$modal","ADDRESS_BACKEND","$token",function($scope,CtrlUtilsService,CtrlInitiatorService,LoadingUtilsService,$filter,toast,$state,$modal,ADDRESS_BACKEND,$token){var checkDate,checkDateDuration,loadSalesmen;return $scope.title="order.export.title",$scope.isUseDistributorFilter=function(){return"distributor"!==CtrlUtilsService.getWho()},$scope["export"]=function(){var href;return $scope.isDisplayDistributor()&&null==$scope.filter.distributorId?toast.logError($filter("translate")("please.select.distributor")):checkDate()?checkDateDuration()?(href=ADDRESS_BACKEND+$scope.who+"/export/order",$scope.filter.isDetail&&(href+="/detail"),href=href+"?access_token="+$token.getAccessToken(),href=href+"&distributorId="+$scope.filter.distributorId,href=href+"&fromDate="+globalUtils.createIsoDate($scope.fromDate.date),href=href+"&toDate="+globalUtils.createIsoDate($scope.toDate.date),href=href+"&lang="+CtrlUtilsService.getUserLanguage(),null!=$scope.filter.salesmanId&&"all"!==$scope.filter.salesmanId&&(href=href+"&salesmanId="+$scope.filter.salesmanId),null!=$scope.filter.customerId&&(href=href+"&customerId="+$scope.filter.customerId),location.href=href):toast.logError($filter("translate")("max.duration.between.from.date.and.to.date.is.1.month")):toast.logError($filter("translate")("from.date.cannot.be.greater.than.to.date"))},checkDateDuration=function(){return!(moment($scope.fromDate.date).add(1,"months").toDate().getTime()<$scope.toDate.date.getTime())},checkDate=function(){return!!(null!=$scope.fromDate&&null!=$scope.fromDate.date&&$scope.toDate&&null!=$scope.toDate.date&&$scope.fromDate.date.getTime()<=$scope.toDate.date.getTime())},$scope.isDisplayDate=function(){return!0},$scope.isDisplayDistributor=function(){return $scope.isUseDistributorFilter()},$scope.isDisplaySalesman=function(){return null!=$scope.filter.distributorId},$scope.isDisplayCustomer=function(){return null!=$scope.filter.distributorId},$scope.changeDistributor=function(){return $scope.filter.salesmanId="all",loadSalesmen(),$scope.clearCustomer()},loadSalesmen=function(){return LoadingUtilsService.loadSalesmenByDistributor($scope.who,$scope.filter.distributorId,$scope.loadStatus.getStatusByDataName("salesmen"),function(list){return $scope.salesmen=_.union([{id:"all",fullname:"-- "+$filter("translate")("all")+" --"}],list)})},$scope.openSelectCustomer=function(){var modalInstance;return modalInstance=$modal.open({templateUrl:"views/business/customer/customer-select-popup.html",controller:"CustomerSelectPopupCtrl",resolve:{distributorId:function(){return $scope.filter.distributorId},distributorName:function(){return _.find($scope.distributors,function(o){return o.id===$scope.filter.distributorId}).name}},backdrop:!0}),modalInstance.result.then(function(customer){return $scope.filter.customerId=customer.id,$scope.filter.customerName=customer.name})},$scope.clearCustomer=function(){return $scope.filter.customerId=null,$scope.filter.customerName="-- "+$filter("translate")("all")+" --"},CtrlInitiatorService.initFilterViewCtrl($scope),CtrlInitiatorService.initUseDatePickerCtrl($scope),$scope.addInitFunction(function(){return null==$scope.filter.isDetail&&($scope.filter.isDetail=!1),null!=$scope.filter.fromDate&&null!=$scope.filter.toDate?($scope.fromDate=$scope.createDatePickerModel(globalUtils.parseIsoDate($scope.filter.fromDate)),$scope.toDate=$scope.createDatePickerModel(globalUtils.parseIsoDate($scope.filter.toDate)),checkDate()&&checkDateDuration()||$state.go("404")):($scope.fromDate=$scope.createDatePickerModel(new Date),$scope.toDate=$scope.createDatePickerModel(new Date)),null==$scope.filter.salesmanId&&($scope.filter.salesmanId="all"),null==$scope.filter.customerId&&($scope.filter.customerName="-- "+$filter("translate")("all")+" --"),LoadingUtilsService.loadDistributors($scope.who,$scope.loadStatus.getStatusByDataName("distributors"),function(list){return $scope.distributors=list}),$scope.isDisplaySalesman()?loadSalesmen():void 0}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("VisitExportCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","LoadingUtilsService","$filter","toast","$state","$modal","ADDRESS_BACKEND","$token",function($scope,CtrlUtilsService,CtrlInitiatorService,LoadingUtilsService,$filter,toast,$state,$modal,ADDRESS_BACKEND,$token){var checkDate,checkDateDuration,loadSalesmen;return $scope.title="visit.export.title",$scope.isUseDistributorFilter=function(){return"distributor"!==CtrlUtilsService.getWho()},$scope["export"]=function(){var href;return $scope.isDisplayDistributor()&&null==$scope.filter.distributorId?toast.logError($filter("translate")("please.select.distributor")):checkDate()?checkDateDuration()?(href=ADDRESS_BACKEND+$scope.who+"/export/visit",href=href+"?access_token="+$token.getAccessToken(),href=href+"&distributorId="+$scope.filter.distributorId,href=href+"&fromDate="+globalUtils.createIsoDate($scope.fromDate.date),href=href+"&toDate="+globalUtils.createIsoDate($scope.toDate.date),href=href+"&lang="+CtrlUtilsService.getUserLanguage(),null!=$scope.filter.salesmanId&&"all"!==$scope.filter.salesmanId&&(href=href+"&salesmanId="+$scope.filter.salesmanId),null!=$scope.filter.customerId&&(href=href+"&customerId="+$scope.filter.customerId),location.href=href):toast.logError($filter("translate")("max.duration.between.from.date.and.to.date.is.1.month")):toast.logError($filter("translate")("from.date.cannot.be.greater.than.to.date"))},checkDateDuration=function(){return!(moment($scope.fromDate.date).add(1,"months").toDate().getTime()<$scope.toDate.date.getTime())},checkDate=function(){return!!(null!=$scope.fromDate&&null!=$scope.fromDate.date&&$scope.toDate&&null!=$scope.toDate.date&&$scope.fromDate.date.getTime()<=$scope.toDate.date.getTime())},$scope.isDisplayDate=function(){return!0},$scope.isDisplayDistributor=function(){return $scope.isUseDistributorFilter()},$scope.isDisplaySalesman=function(){return null!=$scope.filter.distributorId},$scope.isDisplayCustomer=function(){return null!=$scope.filter.distributorId},$scope.changeDistributor=function(){return $scope.filter.salesmanId="all",loadSalesmen(),$scope.clearCustomer()},loadSalesmen=function(){return LoadingUtilsService.loadSalesmenByDistributor($scope.who,$scope.filter.distributorId,$scope.loadStatus.getStatusByDataName("salesmen"),function(list){return $scope.salesmen=_.union([{id:"all",fullname:"-- "+$filter("translate")("all")+" --"}],list)})},$scope.openSelectCustomer=function(){var modalInstance;return modalInstance=$modal.open({templateUrl:"views/business/customer/customer-select-popup.html",controller:"CustomerSelectPopupCtrl",resolve:{distributorId:function(){return $scope.filter.distributorId},distributorName:function(){return _.find($scope.distributors,function(o){return o.id===$scope.filter.distributorId}).name}},backdrop:!0}),modalInstance.result.then(function(customer){return $scope.filter.customerId=customer.id,$scope.filter.customerName=customer.name})},$scope.clearCustomer=function(){return $scope.filter.customerId=null,$scope.filter.customerName="-- "+$filter("translate")("all")+" --"},CtrlInitiatorService.initFilterViewCtrl($scope),CtrlInitiatorService.initUseDatePickerCtrl($scope),$scope.addInitFunction(function(){return null==$scope.filter.isDetail&&($scope.filter.isDetail=!1),null!=$scope.filter.fromDate&&null!=$scope.filter.toDate?($scope.fromDate=$scope.createDatePickerModel(globalUtils.parseIsoDate($scope.filter.fromDate)),$scope.toDate=$scope.createDatePickerModel(globalUtils.parseIsoDate($scope.filter.toDate)),checkDate()&&checkDateDuration()||$state.go("404")):($scope.fromDate=$scope.createDatePickerModel(new Date),$scope.toDate=$scope.createDatePickerModel(new Date)),null==$scope.filter.salesmanId&&($scope.filter.salesmanId="all"),null==$scope.filter.customerId&&($scope.filter.customerName="-- "+$filter("translate")("all")+" --"),LoadingUtilsService.loadDistributors($scope.who,$scope.loadStatus.getStatusByDataName("distributors"),function(list){return $scope.distributors=list}),$scope.isDisplaySalesman()?loadSalesmen():void 0}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("ExchangeReturnExportCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams","ADDRESS_BACKEND","$token",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams,ADDRESS_BACKEND,$token){var checkDate,checkDateDuration;return $scope.title="exchange.return.export.title",$scope.isUseDistributorFilter=function(){return"distributor"!==CtrlUtilsService.getWho()},$scope["export"]=function(){var href;return null==$scope.filter.distributorId&&$scope.isUseDistributorFilter()?toast.logError($filter("translate")("please.select.distributor")):checkDate()?checkDateDuration()?($scope.filter.fromDate=globalUtils.createIsoDate($scope.fromDate.date),$scope.filter.toDate=globalUtils.createIsoDate($scope.toDate.date),href=ADDRESS_BACKEND+$scope.who+"/export/exchange-return",href=href+"?access_token="+$token.getAccessToken(),null!=$scope.filter.distributorId&&"all"!==$scope.filter.distributorId&&(href=href+"&distributorId="+$scope.filter.distributorId),href=href+"&fromDate="+$scope.filter.fromDate,href=href+"&toDate="+$scope.filter.toDate,href=href+"&lang="+CtrlUtilsService.getUserLanguage(),location.href=href):toast.logError($filter("translate")("max.duration.between.from.date.and.to.date.is.1.month")):toast.logError($filter("translate")("from.date.cannot.be.greater.than.to.date"))},checkDate=function(){return!!(null!=$scope.fromDate&&null!=$scope.fromDate.date&&$scope.toDate&&null!=$scope.toDate.date&&$scope.fromDate.date.getTime()<=$scope.toDate.date.getTime())},checkDateDuration=function(){return!(moment($scope.fromDate.date).add(1,"months").toDate().getTime()<$scope.toDate.date.getTime())},CtrlInitiatorService.initUseDatePickerCtrl($scope),$scope.addInitFunction(function(){return $scope.filter={},$scope.filter.distributorId="all",$scope.fromDate=$scope.createDatePickerModel(new Date),$scope.toDate=$scope.createDatePickerModel(new Date),$scope.isUseDistributorFilter()?LoadingUtilsService.loadDistributors($scope.who,$scope.loadStatus.getStatusByDataName("distributors"),function(list){return $scope.distributors=_.union([{id:"all",name:"-- "+$filter("translate")("all")+" --"}],list)}):void 0}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("ImportCustomerCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams","ADDRESS_BACKEND","$token",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams,ADDRESS_BACKEND,$token){var importCustomer,initStep,verify;return $scope.title="import.customer.title",$scope.defaultBackState="customer",initStep=function(){return $scope.currentStep=0,$scope.steps=[{name:"import.step.select.distributor"},{name:"import.step.upload.file"},{name:"import.step.confirm"},{name:"import.step.finalisation"}]},$scope.isDoneStep=function(stepIndex){return stepIndex<$scope.currentStep},$scope.isCurrentStep=function(stepIndex){return $scope.currentStep===stepIndex},$scope.canNext=function(){return null!=$scope.currentStep&&$scope.currentStep>=0&&!$scope.isFinish()},$scope.isNextDisabled=function(){if($scope.canNext()){if(0===$scope.currentStep)return null===$scope.global.distributorId;if(1===$scope.currentStep)return null===$scope.global.excel;if(2===$scope.currentStep)return!1}return!0},$scope.nextStep=function(){var distributor,_i,_len,_ref;if($scope.canNext()){if(0===$scope.currentStep){for(_ref=$scope.distributors,_i=0,_len=_ref.length;_len>_i;_i++)distributor=_ref[_i],distributor.id===$scope.global.distributorId&&($scope.global.distributorName=distributor.name);return $scope.currentStep++}if(1===$scope.currentStep)return verify();if(2===$scope.currentStep)return importCustomer()}},$scope.canBack=function(){return null!=$scope.currentStep&&$scope.currentStep>=0&&!$scope.isFinish()},$scope.backStep=function(){return 0===$scope.currentStep?$scope.back():$scope.currentStep--},$scope.isFinish=function(){return $scope.currentStep>=3},$scope.finish=function(){return $scope.isFinish()?$scope.back():void 0},$scope.getTemplateLink=function(){return ADDRESS_BACKEND+$scope.who+"/import/customer/template?distributorId="+$scope.global.distributorId+"&access_token="+$token.getAccessToken()+"&lang="+CtrlUtilsService.getUserLanguage()},$scope.getRowErrorData=function(data){return _.isEmpty(data)?"<"+$filter("translate")("import.data.empty")+">":data},verify=function(){var onSuccess,params,status;return $scope.global.confirm={},status=$scope.loadStatus.getStatusByDataName("data"),params={who:$scope.who,category:"import",subCategory:"customer",param:"verify",distributorId:$scope.global.distributorId,fileId:$scope.global.excel.fileId},onSuccess=function(data){return $scope.global.confirm=data,$scope.currentStep++},CtrlUtilsService.loadSingleData(params,status,onSuccess,null)},importCustomer=function(){var onSuccess,params,status;
return $scope.global.result={},status=$scope.loadStatus.getStatusByDataName("data"),params={who:$scope.who,category:"import",subCategory:"customer",param:"import",distributorId:$scope.global.distributorId,fileId:$scope.global.excel.fileId},onSuccess=function(data){return $scope.global.result=data,$scope.currentStep++},CtrlUtilsService.doPost(params,status,{photos:$scope.global.photos},onSuccess,null,"save")},CtrlInitiatorService.initCanBackViewCtrl($scope),$scope.addInitFunction(function(){return LoadingUtilsService.loadDistributors($scope.who,$scope.loadStatus.getStatusByDataName("distributors"),function(list){return $scope.distributors=angular.copy(list)}),initStep(),$scope.global={},$scope.global.distributorId=null,$scope.global.distributorName=null,$scope.global.excel=null,$scope.global.confirm=null,$scope.global.result=null}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("ImportProductCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams","ADDRESS_BACKEND","$token",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams,ADDRESS_BACKEND,$token){var getValidRows,importProduct,initStep,verify;return $scope.title="import.product.title",$scope.defaultBackState="product",$scope.getProductivityUnit=function(){return null!=$token.getUserInfo()?$token.getUserInfo().productivityUnit:null},initStep=function(){return $scope.currentStep=0,$scope.steps=[{name:"import.step.upload.file"},{name:"import.step.confirm"},{name:"import.step.add.photo"},{name:"import.step.finalisation"}]},$scope.isDoneStep=function(stepIndex){return stepIndex<$scope.currentStep},$scope.isCurrentStep=function(stepIndex){return $scope.currentStep===stepIndex},$scope.canNext=function(){return null!=$scope.currentStep&&$scope.currentStep>=0&&!$scope.isFinish()},$scope.isNextDisabled=function(){if($scope.canNext()){if(0===$scope.currentStep)return null===$scope.global.excel;if(1===$scope.currentStep)return null!==$scope.global.confirm.rowDatas&&$scope.global.confirm.rowDatas.length>=$scope.global.confirm.total||$scope.global.confirm.total<=0;if(2===$scope.currentStep)return!$scope.isFormValid("form")}return!0},$scope.nextStep=function(){if($scope.canNext()){if(0===$scope.currentStep)return verify();if(1===$scope.currentStep)return getValidRows();if(2===$scope.currentStep)return importProduct()}},$scope.canBack=function(){return null!=$scope.currentStep&&$scope.currentStep>=0&&!$scope.isFinish()},$scope.backStep=function(){return 0===$scope.currentStep?$scope.back():$scope.currentStep--},$scope.isFinish=function(){return $scope.currentStep>=3},$scope.finish=function(){return $scope.isFinish()?$scope.back():void 0},$scope.getTemplateLink=function(){return ADDRESS_BACKEND+$scope.who+"/import/product/template?access_token="+$token.getAccessToken()+"&lang="+CtrlUtilsService.getUserLanguage()},$scope.getRowErrorData=function(data){return _.isEmpty(data)?"<"+$filter("translate")("import.data.empty")+">":data},verify=function(){var onSuccess,params,status;return $scope.global.confirm={},status=$scope.loadStatus.getStatusByDataName("data"),params={who:$scope.who,category:"import",subCategory:"product",param:"verify",fileId:$scope.global.excel.fileId},onSuccess=function(data){return $scope.global.confirm=data,$scope.currentStep++},CtrlUtilsService.loadSingleData(params,status,onSuccess,null)},getValidRows=function(){var onSuccess,params,status;return $scope.global.data={},$scope.global.photos=[],status=$scope.loadStatus.getStatusByDataName("data"),params={who:$scope.who,category:"import",subCategory:"product",param:"confirm",fileId:$scope.global.excel.fileId},onSuccess=function(data){return $scope.global.data=data,$scope.global.photos=new Array(data.rowDatas.length),$scope.currentStep++},CtrlUtilsService.loadSingleData(params,status,onSuccess,null)},importProduct=function(){var onSuccess,params,status;return $scope.global.result={},status=$scope.loadStatus.getStatusByDataName("data"),params={who:$scope.who,category:"import",subCategory:"product",param:"import",fileId:$scope.global.excel.fileId},onSuccess=function(data){return $scope.global.result=data,$scope.currentStep++},CtrlUtilsService.doPost(params,status,{photos:$scope.global.photos},onSuccess,null,"save")},CtrlInitiatorService.initCanBackViewCtrl($scope),$scope.addInitFunction(function(){return initStep(),$scope.global={},$scope.global.distributorId=null,$scope.global.distributorName=null,$scope.global.excel=null,$scope.global.confirm=null}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("ImportCustomerScheduleCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams","ADDRESS_BACKEND","$token",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams,ADDRESS_BACKEND,$token){var importCustomerSchedule,initStep,verify;return $scope.title="import.customer.schedule.title",$scope.defaultBackState="customer-schedule",$scope.isUseDistributorFilter=function(){return"distributor"!==CtrlUtilsService.getWho()},initStep=function(){return $scope.currentStep=0,$scope.isUseDistributorFilter()?$scope.steps=[{name:"import.step.select.distributor"},{name:"import.step.upload.file"},{name:"import.step.confirm"},{name:"import.step.finalisation"}]:$scope.steps=[{name:"import.step.upload.file"},{name:"import.step.confirm"},{name:"import.step.finalisation"}]},$scope.isDoneStep=function(stepIndex){return stepIndex<$scope.currentStep},$scope.isCurrentStep=function(stepIndex){return $scope.currentStep===stepIndex},$scope.canNext=function(){return null!=$scope.currentStep&&$scope.currentStep>=0&&!$scope.isFinish()},$scope.isNextDisabled=function(){if($scope.canNext()){if($scope.currentStep===$scope.steps.length-4)return null===$scope.global.distributorId;if($scope.currentStep===$scope.steps.length-3)return null===$scope.global.excel;if($scope.currentStep===$scope.steps.length-2)return!1}return!0},$scope.nextStep=function(){var distributor,_i,_len,_ref;if($scope.canNext()){if($scope.currentStep===$scope.steps.length-4){for(_ref=$scope.distributors,_i=0,_len=_ref.length;_len>_i;_i++)distributor=_ref[_i],distributor.id===$scope.global.distributorId&&($scope.global.distributorName=distributor.name);return $scope.currentStep++}if($scope.currentStep===$scope.steps.length-3)return verify();if($scope.currentStep===$scope.steps.length-2)return importCustomerSchedule()}},$scope.canBack=function(){return null!=$scope.currentStep&&$scope.currentStep>=0&&!$scope.isFinish()},$scope.backStep=function(){return 0===$scope.currentStep?$scope.back():$scope.currentStep--},$scope.isFinish=function(){return $scope.currentStep>=$scope.steps.length-1},$scope.finish=function(){return $scope.isFinish()?$scope.back():void 0},$scope.getTemplateLink=function(){return ADDRESS_BACKEND+$scope.who+"/import/customer-schedule/template?distributorId="+$scope.global.distributorId+"&access_token="+$token.getAccessToken()+"&lang="+CtrlUtilsService.getUserLanguage()},$scope.getRowErrorData=function(data){return _.isEmpty(data)?"<"+$filter("translate")("import.data.empty")+">":data},verify=function(){var onSuccess,params,status;return $scope.global.confirm={},status=$scope.loadStatus.getStatusByDataName("data"),params={who:$scope.who,category:"import",subCategory:"customer-schedule",param:"verify",distributorId:$scope.global.distributorId,fileId:$scope.global.excel.fileId},onSuccess=function(data){return $scope.global.confirm=data,$scope.currentStep++},CtrlUtilsService.loadSingleData(params,status,onSuccess,null)},importCustomerSchedule=function(){var onSuccess,params,status;return $scope.global.result={},status=$scope.loadStatus.getStatusByDataName("data"),params={who:$scope.who,category:"import",subCategory:"customer-schedule",param:"import",distributorId:$scope.global.distributorId,fileId:$scope.global.excel.fileId},onSuccess=function(data){return $scope.global.result=data,$scope.currentStep++},CtrlUtilsService.doPost(params,status,{photos:$scope.global.photos},onSuccess,null,"save")},CtrlInitiatorService.initCanBackViewCtrl($scope),$scope.addInitFunction(function(){return $scope.isUseDistributorFilter()&&LoadingUtilsService.loadDistributors($scope.who,$scope.loadStatus.getStatusByDataName("distributors"),function(list){return $scope.distributors=angular.copy(list)}),initStep(),$scope.global={},$scope.global.distributorId=null,$scope.global.distributorName=null,$scope.global.excel=null,$scope.global.confirm=null,$scope.global.result=null}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("DistributorPriceListCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams){return $scope.title="distributor.price.list.title",$scope.goToImport=function(){return $state.go("import-price-list",{filter:$stateParams.filter})},$scope.reloadData=function(){var params;return $scope.datas=[],params={who:$scope.who,category:"price-list"},CtrlUtilsService.loadListData(params,$scope.loadStatus.getStatusByDataName("data"),function(records){var productCategory,productCategoryMap;productCategoryMap=_.groupBy(records,function(product){return product.productCategory.name}),$scope.datas=[];for(productCategory in productCategoryMap)$scope.datas.push({name:productCategory,products:productCategoryMap[productCategory]});return $scope.datas=_.orderBy($scope.datas,["name"],["asc"])},function(){return toast.logError($filter("translate")("loading.error"))})},$scope.isEmpty=function(){return _.isEmpty($scope.datas)},$scope.checkBeforeSave=function(){return $scope.isFormValid("form")?!0:(toast.logError($filter("translate")("error.data.input.not.valid")),!1)},$scope.getObjectToSave=function(){var data,product,saveData,_i,_j,_len,_len1,_ref,_ref1;for(saveData={priceList:{}},_ref=$scope.datas,_i=0,_len=_ref.length;_len>_i;_i++)for(data=_ref[_i],_ref1=data.products,_j=0,_len1=_ref1.length;_len1>_j;_j++)product=_ref1[_j],null!=product.distributorPrice&&(saveData.priceList[product.id]=product.distributorPrice);return saveData},$scope.getSaveParams=function(params){return params.category="price-list",params},$scope.onSaveSuccess=function(){},$scope.onSaveFailure=function(){},$scope.isPost=function(){return!1},CtrlInitiatorService.initCanSaveViewCtrl($scope),$scope.addInitFunction(function(){return $scope.reloadData()}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("ImportDistributorPriceListCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams","ADDRESS_BACKEND","$token",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams,ADDRESS_BACKEND,$token){var doImport,initStep,verify;return $scope.title="import.distributor.price.list.title",$scope.defaultBackState="distributor-price-list",initStep=function(){return $scope.currentStep=0,$scope.steps=[{name:"import.step.upload.file"},{name:"import.step.confirm"},{name:"import.step.finalisation"}]},$scope.isDoneStep=function(stepIndex){return stepIndex<$scope.currentStep},$scope.isCurrentStep=function(stepIndex){return $scope.currentStep===stepIndex},$scope.canNext=function(){return null!=$scope.currentStep&&$scope.currentStep>=0&&!$scope.isFinish()},$scope.isNextDisabled=function(){if($scope.canNext()){if($scope.currentStep===$scope.steps.length-3)return null===$scope.global.excel;if($scope.currentStep===$scope.steps.length-2)return!1}return!0},$scope.nextStep=function(){if($scope.canNext()){if($scope.currentStep===$scope.steps.length-3)return verify();if($scope.currentStep===$scope.steps.length-2)return doImport()}},$scope.canBack=function(){return null!=$scope.currentStep&&$scope.currentStep>=0&&!$scope.isFinish()},$scope.backStep=function(){return 0===$scope.currentStep?$scope.back():$scope.currentStep--},$scope.isFinish=function(){return $scope.currentStep>=$scope.steps.length-1},$scope.finish=function(){return $scope.isFinish()?$scope.back():void 0},$scope.getTemplateLink=function(){return ADDRESS_BACKEND+$scope.who+"/import/price-list/template?access_token="+$token.getAccessToken()+"&lang="+CtrlUtilsService.getUserLanguage()},$scope.getRowErrorData=function(data){return _.isEmpty(data)?"<"+$filter("translate")("import.data.empty")+">":data},verify=function(){var onSuccess,params,status;return $scope.global.confirm={},status=$scope.loadStatus.getStatusByDataName("data"),params={who:$scope.who,category:"import",subCategory:"price-list",param:"verify",fileId:$scope.global.excel.fileId},onSuccess=function(data){return $scope.global.confirm=data,$scope.currentStep++},CtrlUtilsService.loadSingleData(params,status,onSuccess,null)},doImport=function(){var onSuccess,params,status;return $scope.global.result={},status=$scope.loadStatus.getStatusByDataName("data"),params={who:$scope.who,category:"import",subCategory:"price-list",param:"import",fileId:$scope.global.excel.fileId},onSuccess=function(data){return $scope.global.result=data,$scope.currentStep++},CtrlUtilsService.doPost(params,status,null,onSuccess,null,"save")},CtrlInitiatorService.initCanBackViewCtrl($scope),$scope.addInitFunction(function(){return initStep(),$scope.global={},$scope.global.excel=null,$scope.global.confirm=null,$scope.global.result=null}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("VanSalesCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams){return $scope.title="van.sales.title",$scope.reloadData=function(){var params;return $scope.records=[],params={who:$scope.who,category:"van-sales"},CtrlUtilsService.loadListData(params,$scope.loadStatus.getStatusByDataName("data"),function(records){return $scope.records=records},function(){return toast.logError($filter("translate")("loading.error"))})},$scope.isEmpty=function(){return _.isEmpty($scope.records)},$scope.checkBeforeSave=function(){return!0},$scope.getObjectToSave=function(){var record,saveData,_i,_len,_ref;for(saveData={},_ref=$scope.records,_i=0,_len=_ref.length;_len>_i;_i++)record=_ref[_i],saveData[record.id]=record.vanSales;return saveData},$scope.getSaveParams=function(params){return params.category="van-sales",params},$scope.onSaveSuccess=function(){},$scope.onSaveFailure=function(){},$scope.isPost=function(){return!1},CtrlInitiatorService.initCanSaveViewCtrl($scope),$scope.addInitFunction(function(){return $scope.reloadData()}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("VisitPhotoCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams","ADDRESS_BACKEND","$modal","$token",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams,ADDRESS_BACKEND,$modal,$token){var checkDate,checkDateDuration;return $scope.title="visit.photo.title",$scope.isUseDistributorFilter=function(){return"distributor"!==CtrlUtilsService.getWho()},$scope.mustSelectDistributor=function(){return $scope.isUseDistributorFilter()&&null==$scope.filter.distributorId},$scope.mustSelectSalesman=function(){return null==$scope.filter.salesmanId},$scope.changeDistributor=function(){return $scope.filter.salesmanId=null,LoadingUtilsService.loadSalesmenByDistributor($scope.who,$scope.filter.distributorId,$scope.loadStatus.getStatusByDataName("salesmen"),function(list){return $scope.salesmen=list})},$scope.search=function(){return checkDate()?checkDateDuration()?$scope.mustSelectDistributor()?toast.logError($filter("translate")("please.select.distributor")):$scope.mustSelectSalesman()?toast.logError($filter("translate")("please.select.salesman")):($scope.filter.fromDate=globalUtils.createIsoDate($scope.fromDate.date),$scope.filter.toDate=globalUtils.createIsoDate($scope.toDate.date),$scope.reloadForNewFilter()):toast.logError($filter("translate")("max.duration.between.from.date.and.to.date.is.1.month")):toast.logError($filter("translate")("from.date.cannot.be.greater.than.to.date"))},checkDateDuration=function(){return!(moment($scope.fromDate.date).add(1,"months").toDate().getTime()<$scope.toDate.date.getTime())},checkDate=function(){return!!(null!=$scope.fromDate&&null!=$scope.fromDate.date&&$scope.toDate&&null!=$scope.toDate.date&&$scope.fromDate.date.getTime()<=$scope.toDate.date.getTime())},$scope.isEmpty=function(){return!(null!=$scope.dates&&$scope.dates.length>0)},$scope.download=function(){var href;return href=ADDRESS_BACKEND+$scope.who+"/visit-photo/zip",href=href+"?access_token="+$token.getAccessToken(),href=href+"&salesmanId="+$scope.filter.salesmanId,href=href+"&fromDate="+globalUtils.createIsoDate($scope.fromDate.date),href=href+"&toDate="+globalUtils.createIsoDate($scope.toDate.date),location.href=href},$scope.reloadData=function(){var params;return $scope.mustSelectDistributor()||$scope.mustSelectSalesman()?void 0:(params={who:$scope.who,category:"visit-photo",salesmanId:$scope.filter.salesmanId,fromDate:globalUtils.createIsoDate($scope.fromDate.date),toDate:globalUtils.createIsoDate($scope.toDate.date)},$scope.map={},$scope.dates=[],CtrlUtilsService.loadListData(params,$scope.loadStatus.getStatusByDataName("data"),function(records){var date,record,visitPhotos,_i,_len,_results;for(_results=[],_i=0,_len=records.length;_len>_i;_i++)record=records[_i],date=$filter("isoDate")(record.createdTime),visitPhotos=$scope.map[date],null==visitPhotos&&(visitPhotos=[],$scope.dates.push(date)),visitPhotos.push(record),_results.push($scope.map[date]=visitPhotos);return _results},function(error){return 400===error.status?$state.go("404"):toast.logError($filter("translate")("loading.error"))}))},$scope.getPhoto=function(visitPhoto){return null!=visitPhoto&&null!=visitPhoto.photo?ADDRESS_BACKEND+"image/"+visitPhoto.photo:void 0},$scope.zoomPhoto=function(visitPhoto){return $modal.open({templateUrl:"views/common/photo-popup.html",controller:"PhotoPopupCtrl",resolve:{title:function(){return visitPhoto.customer.name},subTitle:function(){return $filter("isoDate")(visitPhoto.createdTime)},photoLink:function(){return $scope.getPhoto(visitPhoto)}},backdrop:!0})},$scope.getVisitLink=function(visitPhoto){return"#/visit-detail?id="+visitPhoto.id+"&parent=visit-photo&filter="+$scope.getFilterAsString()},CtrlInitiatorService.initFilterViewCtrl($scope),CtrlInitiatorService.initUseDatePickerCtrl($scope),$scope.addInitFunction(function(){return $scope.map={},$scope.dates=[],null!=$scope.filter.fromDate&&null!=$scope.filter.toDate?($scope.fromDate=$scope.createDatePickerModel(globalUtils.parseIsoDate($scope.filter.fromDate)),$scope.toDate=$scope.createDatePickerModel(globalUtils.parseIsoDate($scope.filter.toDate)),checkDate()&&checkDateDuration()||$state.go("404")):($scope.fromDate=$scope.createDatePickerModel(new Date),$scope.toDate=$scope.createDatePickerModel(new Date)),$scope.isUseDistributorFilter()&&LoadingUtilsService.loadDistributors($scope.who,$scope.loadStatus.getStatusByDataName("distributors"),function(list){return $scope.distributors=list}),$scope.mustSelectDistributor()||LoadingUtilsService.loadSalesmenByDistributor($scope.who,$scope.filter.distributorId,$scope.loadStatus.getStatusByDataName("salesmen"),function(list){return $scope.salesmen=list}),$scope.reloadData()}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("InventoryCtrl",["$scope","CtrlCategoryInitiatorService",function($scope,CtrlCategoryInitiatorService){return $scope.title="inventory.update.list.title",$scope.categoryName="inventory",$scope.usePopup=!1,$scope.isBigData=!0,$scope.isUseDistributorFilter=function(){return!1},$scope.importState="import-inventory",CtrlCategoryInitiatorService.initCategoryListViewCtrl($scope),$scope.init()}]).controller("InventoryDetailCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","ADDRESS_BACKEND","toast","$filter",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,ADDRESS_BACKEND,toast,$filter){return $scope.title="inventory.update.title",$scope.categoryName="inventory",$scope.isIdRequire=function(){return!0},$scope.defaultBackState="inventory",$scope.onLoadSuccess=function(){var categories,category,categoryMap,product,_i,_j,_len,_len1,_ref,_results;if(($scope.isNew()||$scope.isDraft())&&LoadingUtilsService.loadProductsByDistributor($scope.who,$scope.loadStatus.getStatusByDataName("products"),function(list){var categories,category,categoryMap,product,productQuantityMap,_i,_j,_k,_len,_len1,_len2,_ref,_results;if(productQuantityMap={},null!=$scope.record&&null!=$scope.record.details)for(_ref=$scope.record.details,_i=0,_len=_ref.length;_len>_i;_i++)product=_ref[_i],productQuantityMap[product.id]=product;for(categories=[],categoryMap={},_j=0,_len1=list.length;_len1>_j;_j++)product=list[_j],null==categoryMap[product.productCategory.id]&&(categories.push(product.productCategory),categoryMap[product.productCategory.id]={},categoryMap[product.productCategory.id].name=product.productCategory.name,categoryMap[product.productCategory.id].products=[]),product.isCategory=!1,product.quantity=null!=productQuantityMap[product.id]?productQuantityMap[product.id].quantity:null,categoryMap[product.productCategory.id].products.push(product);for(categories=_.sortBy(categories,function(o){return o.name}),$scope.products=[],_results=[],_k=0,_len2=categories.length;_len2>_k;_k++)category=categories[_k],_results.push($scope.products=_.concat($scope.products,{isCategory:!0,name:categoryMap[category.id].name},categoryMap[category.id].products));return _results}),$scope.isNew()&&($scope.date=$scope.createDatePickerModel(new Date),$scope.date.time=new Date),null!=$scope.record&&(null!=$scope.record.time&&($scope.date=$scope.createDatePickerModel(globalUtils.parseIsoDate($scope.record.time)),$scope.date.time=globalUtils.parseIsoTime($scope.record.time)),!$scope.isDraft())){for(categories=[],categoryMap={},_ref=$scope.record.details,_i=0,_len=_ref.length;_len>_i;_i++)product=_ref[_i],null==categoryMap[product.productCategory.id]&&(categories.push(product.productCategory),categoryMap[product.productCategory.id]={},categoryMap[product.productCategory.id].name=product.productCategory.name,categoryMap[product.productCategory.id].products=[]),product.isCategory=!1,categoryMap[product.productCategory.id].products.push(product);for(categories=_.sortBy(categories,function(o){return o.name}),$scope.products=[],_results=[],_j=0,_len1=categories.length;_len1>_j;_j++)category=categories[_j],_results.push($scope.products=_.concat($scope.products,{isCategory:!0,name:categoryMap[category.id].name},_.sortBy(categoryMap[category.id].products,function(o){return o.name})));return _results}},$scope.getPhotoLink=function(photoId){return ADDRESS_BACKEND+"image/"+photoId},$scope.getIsoTime=function(){return $scope.date.time.setSeconds(0),globalUtils.createIsoTime($scope.date.date,$scope.date.time)},$scope.checkBeforeSave=function(){return null==$scope.date.date?(toast.logError($filter("translate")("error.data.input.not.valid")),!1):!0},$scope.getObjectToSave=function(){var objectToSave,product,_i,_len,_ref;for(objectToSave={},objectToSave.time=$scope.getIsoTime(),objectToSave.details=[],_ref=$scope.products,_i=0,_len=_ref.length;_len>_i;_i++)product=_ref[_i],!product.isCategory&&null!=product.quantity&&product.quantity>=0&&objectToSave.details.push({productId:product.id,quantity:product.quantity});return objectToSave},CtrlInitiatorService.initUseDatePickerCtrl($scope),CtrlCategoryInitiatorService.initCategoryDetailViewCtrl($scope),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("ImportInventoryCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams","ADDRESS_BACKEND","$token",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams,ADDRESS_BACKEND,$token){var doImport,initStep,verify;return $scope.title="import.inventory.update.title",$scope.defaultBackState="inventory",initStep=function(){return $scope.currentStep=0,$scope.steps=[{name:$filter("translate")("import.step.select.time")+" & "+$filter("translate")("import.step.upload.file")},{name:"import.step.confirm"},{name:"import.step.finalisation"}]},$scope.isDoneStep=function(stepIndex){return stepIndex<$scope.currentStep},$scope.isCurrentStep=function(stepIndex){return $scope.currentStep===stepIndex},$scope.canNext=function(){return null!=$scope.currentStep&&$scope.currentStep>=0&&!$scope.isFinish()},$scope.isNextDisabled=function(){if($scope.canNext()){if(0===$scope.currentStep)return null==$scope.getIsoTime()&&null==$scope.global.excel;if(1===$scope.currentStep)return $scope.global.confirm.rowDatas.length>0}return!0},$scope.nextStep=function(){if($scope.canNext()){if(0===$scope.currentStep)return verify();if(1===$scope.currentStep)return doImport()}},$scope.canBack=function(){return null!=$scope.currentStep&&$scope.currentStep>=0&&!$scope.isFinish()},$scope.backStep=function(){return 0===$scope.currentStep?$scope.back():$scope.currentStep--},$scope.isFinish=function(){return $scope.currentStep>=2},$scope.finish=function(){return $scope.isFinish()?$state.go("inventory-detail",{id:$scope.global.result.id}):void 0},$scope.getTemplateLink=function(){return ADDRESS_BACKEND+$scope.who+"/inventory/template?access_token="+$token.getAccessToken()+"&lang="+CtrlUtilsService.getUserLanguage()},$scope.getRowErrorData=function(data){return _.isEmpty(data)?"<"+$filter("translate")("import.data.empty")+">":data},verify=function(){var onFailure,onSuccess,params,status;return $scope.global.confirm={},status=$scope.loadStatus.getStatusByDataName("data"),params={who:$scope.who,category:"inventory",param:"verify",fileId:$scope.global.excel.fileId,time:$scope.getIsoTime()},onSuccess=function(data){return $scope.global.confirm=data,$scope.currentStep++},onFailure=function(error){return 400===error.status?(status.error=!1,toast.logError($filter("translate")(error.data.meta.error_message))):void 0},CtrlUtilsService.loadSingleData(params,status,onSuccess,onFailure)},doImport=function(){var onSuccess,params,status;return $scope.global.result={},status=$scope.loadStatus.getStatusByDataName("data"),params={who:$scope.who,category:"inventory",param:"import",fileId:$scope.global.excel.fileId,time:$scope.getIsoTime()},onSuccess=function(data){return $scope.global.result=data,$scope.currentStep++},CtrlUtilsService.doPost(params,status,{photos:$scope.global.photos},onSuccess,null,"save")},CtrlInitiatorService.initUseDatePickerCtrl($scope),CtrlInitiatorService.initCanBackViewCtrl($scope),$scope.getIsoTime=function(){return $scope.global.date.time.setSeconds(0),globalUtils.createIsoTime($scope.global.date.date,$scope.global.date.time)},$scope.addInitFunction(function(){return initStep(),$scope.global={},$scope.global.date=$scope.createDatePickerModel(new Date),$scope.global.date.time=new Date,$scope.global.excel=null,$scope.global.confirm=null,$scope.global.result=null}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("CheckInSearchCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","LoadingUtilsService","$filter","toast","$state","$modal",function($scope,CtrlUtilsService,CtrlInitiatorService,LoadingUtilsService,$filter,toast,$state,$modal){var checkDate,checkDateDuration;return $scope.title="check.in.search.title",$scope.search=function(){var createdBy,filter;return null==$scope.filter.createdById?toast.logError($filter("translate")("please.select.created.by")):$scope.isDisplayFromDateToDate()&&!checkDate()?toast.logError($filter("translate")("from.date.cannot.be.greater.than.to.date")):$scope.isDisplayFromDateToDate()&&!checkDateDuration()?toast.logError($filter("translate")("max.duration.between.from.date.and.to.date.is.1.month")):!$scope.isDisplayDate()||null!=$scope.date&&null!=$scope.date.date?(createdBy=_.find($scope.createdByList,function(o){return o.id===$scope.filter.createdById}),filter={createdById:$scope.filter.createdById,createdByName:null!=createdBy?createdBy.fullname:null},$scope.isDisplayFromDateToDate()?(filter.fromDate=globalUtils.createIsoDate($scope.fromDate.date),filter.toDate=globalUtils.createIsoDate($scope.toDate.date),$state.go("check-in-list",{filter:$scope.convertFilterAsString(filter)})):(filter.date=globalUtils.createIsoDate($scope.date.date),$state.go("check-in-timeline",{filter:$scope.convertFilterAsString(filter)}))):toast.logError($filter("translate")("please.select.date"))},checkDateDuration=function(){return!(moment($scope.fromDate.date).add(1,"months").toDate().getTime()<$scope.toDate.date.getTime())},checkDate=function(){return!!(null!=$scope.fromDate&&null!=$scope.fromDate.date&&$scope.toDate&&null!=$scope.toDate.date&&$scope.fromDate.date.getTime()<=$scope.toDate.date.getTime())},$scope.isDisplayDate=function(){return $scope.filter.viewOnMap},$scope.isDisplayFromDateToDate=function(){return!$scope.filter.viewOnMap},CtrlInitiatorService.initFilterViewCtrl($scope),CtrlInitiatorService.initUseDatePickerCtrl($scope),$scope.addInitFunction(function(){return null==$scope.filter.viewOnMap&&($scope.filter.viewOnMap=!1),null!=$scope.filter.fromDate&&null!=$scope.filter.toDate?($scope.fromDate=$scope.createDatePickerModel(globalUtils.parseIsoDate($scope.filter.fromDate)),$scope.toDate=$scope.createDatePickerModel(globalUtils.parseIsoDate($scope.filter.toDate)),checkDate()&&checkDateDuration()||$state.go("404")):($scope.fromDate=$scope.createDatePickerModel(new Date),$scope.toDate=$scope.createDatePickerModel(new Date)),null!=$scope.filter.date?$scope.date=$scope.createDatePickerModel(globalUtils.parseIsoDate($scope.filter.date)):$scope.date=$scope.createDatePickerModel(new Date),$scope.createdByList=[],LoadingUtilsService.loadSupervisors($scope.who,$scope.loadStatus.getStatusByDataName("supervisors"),function(list){return $scope.createdByList=_.sortBy(_.union($scope.createdByList,list),function(o){return o.fullname})}),LoadingUtilsService.loadObservers($scope.who,$scope.loadStatus.getStatusByDataName("observers"),function(list){return $scope.createdByList=_.sortBy(_.union($scope.createdByList,list),function(o){return o.fullname})})}),$scope.init()}]).controller("CheckInListCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams",function($scope,CtrlUtilsService,CtrlInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams){var checkDate,checkDateDuration;return $scope.title="check.in.list.title",$scope.defaultBackState="check-in-search",$scope.getParentFilter=function(){var parentFilter,_ref;return null==$stateParams.parent||"check-in-search"===$stateParams.parent?(parentFilter={viewOnMap:!1,fromDate:$scope.filter.fromDate,toDate:$scope.filter.toDate,createdById:$scope.filter.createdById},$scope.convertFilterAsString(parentFilter)):null!=(_ref=$stateParams.parentFilter)?_ref:$stateParams.filter},$scope.goToDetail=function(record){return $state.go("check-in-detail",{id:record.id,parent:"check-in-list",
filter:$stateParams.filter})},checkDateDuration=function(){return!(moment($scope.fromDate).add(1,"months").toDate().getTime()<$scope.toDate.getTime())},checkDate=function(){return null!=$scope.fromDate&&null!=$scope.toDate&&$scope.fromDate.getTime()<=$scope.toDate.getTime()},$scope.isLocationUndefined=function(record){return!(null!=record&&null!=record.location)},$scope.isAddressUndefined=function(record){return!(null!=record&&null!=record.location&&null!=record.province)},$scope.getLocationDisplay=function(record){return $scope.isLocationUndefined(record)?$filter("translate")("location.undefined"):$scope.isAddressUndefined(record)?$filter("translate")("address.undefined"):record.province.name},$scope.hasPhoto=function(record){return null!=record&&null!=record.nbPhoto&&record.nbPhoto>0},$scope.getReloadDataParams=function(params){return params.category="check-in",params.fromDate=$scope.filter.fromDate,params.toDate=$scope.filter.toDate,params.createdById=$scope.filter.createdById,params},CtrlInitiatorService.initPagingFilterViewCtrl($scope),CtrlInitiatorService.initCanBackViewCtrl($scope),$scope.addInitFunction(function(){var valid;return valid=!0,null!=$scope.filter.createdById&&null!=$scope.filter.fromDate&&null!=$scope.filter.toDate?($scope.fromDate=globalUtils.parseIsoDate($scope.filter.fromDate),$scope.toDate=globalUtils.parseIsoDate($scope.filter.toDate),checkDate()||checkDateDuration()||(valid=!1,$state.go("404"))):(valid=!1,$state.go("404")),valid?$scope.reloadData():void 0}),$scope.init()}]).controller("CheckInTimelineCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams","ADDRESS_BACKEND","$modal",function($scope,CtrlUtilsService,CtrlInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams,ADDRESS_BACKEND,$modal){var addMarkerToMap,showInfoWindow;return $scope.title="SET_LATER",$scope.defaultBackState="check-in-search",$scope.getParentFilter=function(){var parentFilter,_ref;return null==$stateParams.parent||"check-in-search"===$stateParams.parent?(parentFilter={viewOnMap:!0,date:$scope.filter.date,createdById:$scope.filter.createdById},$scope.convertFilterAsString(parentFilter)):null!=(_ref=$stateParams.parentFilter)?_ref:$stateParams.filter},$scope.goToDetail=function(record){return $state.go("check-in-detail",{id:record.id,parent:"check-in-list",filter:$stateParams.filter})},$scope.isEmpty=function(){return!(null!=$scope.records&&$scope.records.length>0)},$scope.isLocationUndefined=function(record){return!(null!=record&&null!=record.location)},$scope.isAddressUndefined=function(record){return!(null!=record&&null!=record.location&&null!=record.province)},$scope.getLocationDisplay=function(record){return $scope.isLocationUndefined(record)?$filter("translate")("location.undefined"):$scope.isAddressUndefined(record)?$filter("translate")("address.undefined"):record.province.name},$scope.isDisplayPhoto=function(record){return null!=record&&null!=record.photos&&record.photos.length>0},$scope.getPhotoLink=function(photo){return ADDRESS_BACKEND+"image/"+photo},$scope.getWarningCheckInIcon=function(record){return $scope.isLocationUndefined(record)},$scope.getNormalCheckInIcon=function(record){return!$scope.getWarningCheckInIcon(record)&&!$scope.getCameraCheckInIcon(record)},$scope.getCameraCheckInIcon=function(record){return!$scope.getWarningCheckInIcon(record)&&null!=record.photos&&record.photos.length>0},$scope.zoomPhoto=function(photo){return $modal.open({templateUrl:"views/common/photo-popup.html",controller:"PhotoPopupCtrl",windowClass:"modal-transparent",resolve:{title:function(){return null},subTitle:function(){return null},photoLink:function(){return $scope.getPhotoLink(photo)}},backdrop:!0})},$scope.getCheckInDetailLink=function(checkIn){return"#/check-in-detail?id="+checkIn.id+"&parent=check-in-timeline&filter="+$scope.getFilterAsString()},showInfoWindow=function(latLng){var checkIn,content,i,marker,_i,_len,_ref;if(null!=$scope.markers)for(_ref=$scope.markers,i=_i=0,_len=_ref.length;_len>_i;i=++_i)if(marker=_ref[i],marker.getPosition().lat()===latLng.lat()&&marker.getPosition().lng()===latLng.lng())return checkIn=$scope.recordsHasMarker[i],content="<strong> "+$filter("isoTime")(checkIn.createdTime)+" </strong><br/>",content=content+'<a class="underline-link" href="'+$scope.getCheckInDetailLink(checkIn)+'">'+$filter("translate")("detail")+"</a>",$scope.infowindow.setContent(content),void $scope.infowindow.open($scope.map,marker.getPosition());return $scope.infowindow.close()},staticOnMapReady($scope,function(map){return $scope.map=map,addMarkerToMap()}),addMarkerToMap=function(){var bounds,latLng,marker,userInfo,_i,_len,_ref;if(null!=$scope.map){if(null!=$scope.markers&&$scope.markers.length>0){for(bounds=new MyLatLngBounds,_ref=$scope.markers,_i=0,_len=_ref.length;_len>_i;_i++)marker=_ref[_i],staticAddMarkerToMap($scope.map,marker),bounds.extend(marker.getPosition());return $scope.map.fitBounds(bounds)}return userInfo=CtrlUtilsService.getUserInfo(),latLng=new MyLatLng(userInfo.location.latitude,userInfo.location.longitude),$scope.map.setCenter(latLng),$scope.map.setZoom(CtrlUtilsService.getDefaultZoom())}},$scope.getReloadDataParams=function(params){return params.category="check-in",params.subCategory="by-date",params.date=$scope.filter.date,params.createdById=$scope.filter.createdById,params},$scope.reloadData=function(){var params;return params={who:$scope.who,category:"check-in",subCategory:"by-date",date:$scope.filter.date,createdById:$scope.filter.createdById},$scope.records=[],$scope.recordsHasMarker=[],$scope.markers=[],$scope.infowindow=new MyInfoWindow,CtrlUtilsService.loadListData(params,$scope.loadStatus.getStatusByDataName("data"),function(list){var latLng,marker,record,_i,_len,_ref;for($scope.records=list,_ref=$scope.records,_i=0,_len=_ref.length;_len>_i;_i++)record=_ref[_i],null!=record.location&&(latLng=new MyLatLng(record.location.latitude,record.location.longitude),marker=new MyMarker($filter("isoTime")(record.createdTime)),marker.setPosition(latLng),marker.setDraggable(!1),marker.addClickListener(function(latLng){return showInfoWindow(latLng)}),$scope.markers.push(marker),$scope.recordsHasMarker.push(record));return addMarkerToMap()},function(error){return 400===error.status?$state.go("404"):toast.logError($filter("translate")("loading.error"))})},CtrlInitiatorService.initFilterViewCtrl($scope),CtrlInitiatorService.initCanBackViewCtrl($scope),$scope.addInitFunction(function(){var valid;return valid=!0,null!=$scope.filter.createdById&&null!=$scope.filter.date?($scope.date=globalUtils.parseIsoDate($scope.filter.date),null==$scope.date&&(valid=!1,$state.go("404"))):(valid=!1,$state.go("404")),valid?($scope.reloadData(),$scope.title=$scope.filter.createdByName+" - "+$filter("isoDate")($scope.filter.date)):void 0}),$scope.init()}]).controller("CheckInDetailCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","CtrlCategoryInitiatorService","LoadingUtilsService","$filter","toast","$state","$stateParams","ADDRESS_BACKEND","$modal",function($scope,CtrlUtilsService,CtrlInitiatorService,CtrlCategoryInitiatorService,LoadingUtilsService,$filter,toast,$state,$stateParams,ADDRESS_BACKEND,$modal){var addMarkerToMap;return $scope.title="check.in.detail.title",$scope.defaultBackState="check-in-list",CtrlInitiatorService.initFilterViewCtrl($scope),CtrlInitiatorService.initCanBackViewCtrl($scope),$scope.isLocationUndefined=function(record){return!(null!=record&&null!=record.location)},$scope.isAddressUndefined=function(record){return!(null!=record&&null!=record.location&&null!=record.province)},$scope.getLocationDisplay=function(record){return $scope.isLocationUndefined(record)?$filter("translate")("location.undefined"):$scope.isAddressUndefined(record)?$filter("translate")("address.undefined"):record.province.name},$scope.isDisplayMap=function(){return null!=$scope.record&&null!=$scope.record.location},$scope.isDisplayPhoto=function(){return null!=$scope.record&&null!=$scope.record.photos&&$scope.record.photos.length>0},$scope.getPhotoLink=function(photo){return ADDRESS_BACKEND+"image/"+photo},staticOnMapReady($scope,function(map){return $scope.map=map,addMarkerToMap()}),addMarkerToMap=function(){var latLng;return null!=$scope.map?null!=$scope.marker?(staticAddMarkerToMap($scope.map,$scope.marker),$scope.map.panTo($scope.marker.getPosition()),$scope.map.setZoom(CtrlUtilsService.getDefaultZoom()+2)):(latLng=new MyLatLng(CtrlUtilsService.getUserInfo().location.latitude,CtrlUtilsService.getUserInfo().location.longitude),$scope.map.setCenter(latLng),$scope.map.setZoom(CtrlUtilsService.getDefaultZoom())):void 0},$scope.zoomPhoto=function(photo){return $modal.open({templateUrl:"views/common/photo-popup.html",controller:"PhotoPopupCtrl",windowClass:"modal-transparent",resolve:{title:function(){return null},subTitle:function(){return null},photoLink:function(){return $scope.getPhotoLink(photo)}},backdrop:!0})},$scope.reloadData=function(){var params;return params={who:$scope.who,category:"check-in",id:$stateParams.id},CtrlUtilsService.loadSingleData(params,$scope.loadStatus.getStatusByDataName("data"),function(record){var latLng;return $scope.record=record,null!=$scope.record.location&&(latLng=new MyLatLng($scope.record.location.latitude,$scope.record.location.longitude),$scope.marker=new MyMarker($filter("translate")("check.in.location")),$scope.marker.setPosition(latLng),$scope.marker.setDraggable(!1)),addMarkerToMap()},function(error){return 400===error.status?$state.go("404"):toast.logError($filter("translate")("loading.error"))})},$scope.addInitFunction(function(){return null==$stateParams.id&&$state.go("404"),$scope.reloadData()}),$scope.init()}])}.call(this),function(){"use strict";angular.module("app").controller("CheckInExportCtrl",["$scope","CtrlUtilsService","CtrlInitiatorService","LoadingUtilsService","$filter","toast","$state","$modal","ADDRESS_BACKEND","$token",function($scope,CtrlUtilsService,CtrlInitiatorService,LoadingUtilsService,$filter,toast,$state,$modal,ADDRESS_BACKEND,$token){var checkDate,checkDateDuration;return $scope.title="check.in.export.title",$scope["export"]=function(){var href;return null==$scope.filter.createdById?toast.logError($filter("translate")("please.select.created.by")):checkDate()?checkDateDuration()?(href=ADDRESS_BACKEND+$scope.who+"/export/check-in",href=href+"?access_token="+$token.getAccessToken(),href=href+"&createdById="+$scope.filter.createdById,href=href+"&fromDate="+globalUtils.createIsoDate($scope.fromDate.date),href=href+"&toDate="+globalUtils.createIsoDate($scope.toDate.date),href=href+"&lang="+CtrlUtilsService.getUserLanguage(),location.href=href):toast.logError($filter("translate")("max.duration.between.from.date.and.to.date.is.1.month")):toast.logError($filter("translate")("from.date.cannot.be.greater.than.to.date"))},checkDateDuration=function(){return!(moment($scope.fromDate.date).add(1,"months").toDate().getTime()<$scope.toDate.date.getTime())},checkDate=function(){return!!(null!=$scope.fromDate&&null!=$scope.fromDate.date&&$scope.toDate&&null!=$scope.toDate.date&&$scope.fromDate.date.getTime()<=$scope.toDate.date.getTime())},CtrlInitiatorService.initFilterViewCtrl($scope),CtrlInitiatorService.initUseDatePickerCtrl($scope),$scope.addInitFunction(function(){return null!=$scope.filter.fromDate&&null!=$scope.filter.toDate?($scope.fromDate=$scope.createDatePickerModel(globalUtils.parseIsoDate($scope.filter.fromDate)),$scope.toDate=$scope.createDatePickerModel(globalUtils.parseIsoDate($scope.filter.toDate)),checkDate()&&checkDateDuration()||$state.go("404")):($scope.fromDate=$scope.createDatePickerModel(new Date),$scope.toDate=$scope.createDatePickerModel(new Date)),$scope.createdByList=[],LoadingUtilsService.loadSupervisors($scope.who,$scope.loadStatus.getStatusByDataName("supervisors"),function(list){return $scope.createdByList=_.sortBy(_.union($scope.createdByList,list),function(o){return o.fullname})}),LoadingUtilsService.loadObservers($scope.who,$scope.loadStatus.getStatusByDataName("observers"),function(list){return $scope.createdByList=_.sortBy(_.union($scope.createdByList,list),function(o){return o.fullname})})}),$scope.init()}])}.call(this),angular.module("app").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("views/header.html",'<header class="clearfix"><!-- Logo --><div class="logo"><a href="#/"><!--<img src="images/salesquick.png" alt="" style="width: 156px; height: 40px;"/>--><img src="images/dmsplus.png" alt="" style="width: 156px; height: 40px"></a></div><!-- needs to be put after logo to make it working--><div class="menu-button" toggle-off-canvas><span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></div><div class="top-nav"><ul class="nav-left list-unstyled"><li><a href="#/" data-toggle-min-nav class="toggle-min"><i class="fa fa-bars"></i></a></li><li class="dropdown text-normal nav-profile" dropdown is-open="status.isopenProfile"><a href="javascript:;" class="dropdown-toggle" dropdown-toggle ng-disabled="disabled"><img src="images/user.png" alt="" class="img-circle img30_30"> <span class="hidden-xs"><span>{{ main.name() }}</span></span></a><ul class="dropdown-menu dropdown-dark with-arrow"><li><a ng-click="changePassword()"><i class="fa fa-lock"></i> <span>{{ \'header.user.change.password\' | translate }}</span></a></li><li><a ng-click="logout()"><i class="fa fa-sign-out"></i> <span>{{ \'header.user.logout\' | translate }}</span></a></li></ul></li><li ng-controller="LangCtrl" class="dropdown langs text-normal" dropdown is-open="status.isopenLang"><a href="javascript:;" class="dropdown-toggle active-flag" dropdown-toggle ng-disabled="disabled"><div class="flag {{ getFlag() }}"></div></a><ul class="dropdown-menu dropdown-dark with-arrow list-langs" role="menu"><li ng-show="isShowLangInDropDown(\'vi\')"><a href="javascript:;" data-ng-click="setLang(\'vi\')"><div class="flag flags-vietnam"></div>Tiếng Việt</a></li><li ng-show="isShowLangInDropDown(\'en\')"><a href="javascript:;" data-ng-click="setLang(\'en\')"><div class="flag flags-british"></div>English</a></li><li ng-show="isShowLangInDropDown(\'zh\')"><a href="javascript:;" data-ng-click="setLang(\'zh\')"><div class="flag flags-china"></div>中文</a></li></ul></li></ul><ul ng-controller="NotificationCtrl" class="nav-right pull-right list-unstyled"><li class="dropdown" dropdown is-open="status.isOpenNeedApproveCustomer" ng-if="canApproveCustomer()"><a href="javascript:;" class="dropdown-toggle bg-danger" dropdown-toggle ng-disabled="disabled"><i class="fa fa-user-plus"></i> <span class="badge badge-info">{{ data.customers.count }}</span></a><div class="dropdown-menu pull-right with-arrow panel panel-default"><div class="panel-heading">{{ \'header.notification.customer.count\' | translate:{count: data.customers.count} }}</div><ul class="list-group" ng-show="data.customers.count > 0"><li ng-repeat="customer in data.customers.display" class="list-group-item"><a href="javascript:;" class="media" ng-click="gotoCustomerPendingDetail(customer)"><span class="media-left media-icon"><span class="square-icon sm bg-info"><i class="fa fa-user"></i></span></span><div class="media-body"><span class="block">{{ customer.name }}</span> <span class="text-muted">{{ customer.customerType.name }}</span></div></a></li></ul><div class="panel-footer" ng-show="data.customers.count > 0"><a href="javascript:;" ng-click="gotoCustomerPending()">{{ \'header.notification.customer.show.all\' | translate }}</a></div></div></li><li class="dropdown" dropdown is-open="status.isOpenUnreadFeedback" ng-if="canReadFeedback()"><a href="javascript:;" class="dropdown-toggle bg-warning" dropdown-toggle ng-disabled="disabled"><i class="fa fa-comment-o"></i> <span class="badge badge-info">{{ data.feedbacks.count }}</span></a><div class="dropdown-menu pull-right with-arrow panel panel-default"><div class="panel-heading">{{ \'header.notification.feedback.count\' | translate:{count: data.feedbacks.count} }}</div><ul class="list-group" ng-show="data.feedbacks.count > 0"><li ng-repeat="feedback in data.feedbacks.display" class="list-group-item"><a href="javascript:;" class="media" ng-click="gotoFeedbackDetail(feedback)"><span class="media-left media-icon"><span class="square-icon sm bg-warning"><i class="fa fa-envelope-o"></i></span></span><div class="media-body"><span class="block">{{ feedback.firstMessage }}</span> <span class="text-muted block">{{ feedback.customer }}</span></div></a></li></ul><div class="panel-footer" ng-show="data.feedbacks.count > 0" ng-click="gotoFeedbackList()"><a href="javascript:;">{{ \'header.notification.feedback.show.all\' | translate }}</a></div></div></li><li class="dropdown" dropdown is-open="status.isOpenNeedApproveOrder" ng-if="canApproveOrder()"><a href="javascript:;" class="dropdown-toggle bg-success" dropdown-toggle ng-disabled="disabled"><i class="fa fa-cart-plus nav-icon"></i> <span class="badge badge-info">{{ data.orders.count }}</span></a><div class="dropdown-menu pull-right with-arrow panel panel-default"><div class="panel-heading">{{ \'header.notification.order.count\' | translate:{count: data.orders.count} }}</div><ul class="list-group" ng-show="data.orders.count > 0"><li ng-repeat="order in data.orders.display" class="list-group-item"><a href="javascript:;" class="media" ng-click="gotoOrderApproveDetail(order)"><span class="media-left media-icon"><span class="square-icon sm bg-success"><i class="fa fa-bell-o"></i></span></span><div class="media-body"><span class="block">{{ order.customer.name }}</span> <span class="text-muted block">{{ order.grandTotal | number }}</span></div></a></li></ul><div class="panel-footer" ng-show="data.orders.count > 0" ng-click="gotoApproveOrderList()"><a href="javascript:;">{{ \'header.notification.order.show.all\' | translate }}</a></div></div></li><li ng-hide="true"><a href="#/tasks" class="bg-info"><i class="fa fa-tasks"></i></a></li></ul></div></header>'),$templateCache.put("views/nav.html",'<div id="nav-wrapper"><ul id="nav" slim-scroll collapse-nav><li ng-repeat="menu in menus" nav-menu="menu" ng-class="{\'active\' : isMenuActive(menu)}" ng-if="checkMenu(menu)"><a ng-href="{{menu.href != null ? menu.href : \'javascript:void(0)\'}}"><i ng-class="menu.icon"></i> <span>{{ menu.name | translate }}</span></a><ul><li ng-repeat="child in menu.children" ng-class="{\'active\' : isMenuActive(child)}" ng-if="checkMenu(child)"><a ng-href="{{child.href}}"><i class="fa fa-circle"></i> <span>{{ child.name | translate }}</span></a></li></ul><i class="fa fa-caret-right icon-has-ul" ng-if="menu.children != null"></i> <i class="fa fa-caret-down icon-has-ul" ng-if="menu.children != null"></i></li></ul></div>'),$templateCache.put("views/business/approval/customer-approval.html",'<basic-view class="customer-approval use-map"><div><div class="row title-bar"><div class="col-xs-8"><h3>{{ title | translate }}</h3></div><div class="col-xs-4 title-btn-bar"><button class="btn btn-warning" ng-click="back()"><span class="fa fa-arrow-left"></span></button> <button class="btn btn-danger" ng-click="reject()" confirm="{{ \'customer.approval.are.you.sure.reject\' | translate }}" confirm-title="{{ \'confirm.dialog.title\' | translate }}" confirm-ok="{{ \'confirm.dialog.ok\' | translate }}" confirm-cancel="{{ \'confirm.dialog.cancel\' | translate }}" confirm-settings="{ size: \'sm\' }"><span class="fa fa-remove"></span></button> <button class="btn btn-primary" ng-click="approve()" confirm="{{ \'customer.approval.are.you.sure.approve\' | translate }}" confirm-title="{{ \'confirm.dialog.title\' | translate }}" confirm-ok="{{ \'confirm.dialog.ok\' | translate }}" confirm-cancel="{{ \'confirm.dialog.cancel\' | translate }}" confirm-settings="{ size: \'sm\' }"><span class="fa fa-check"></span></button></div></div><div class="row"><div class="col-lg-6"><section class="panel panel-default"><div class="panel-heading"><strong><span class="glyphicon glyphicon-th"></span> {{ \'info\' | translate }}</strong></div><div class="panel-body"><div class="media"><div class="media-body"><ul class="list-unstyled list-info"><li><span class="icon glyphicon glyphicon-home"></span><label>{{ \'distributor\' | translate }}</label>{{ record.distributor.name }}</li><li><span class="icon glyphicon glyphicon-inbox"></span><label>{{ \'area\' | translate }}</label>{{ record.area.name }}</li><li><span class="icon glyphicon glyphicon-font"></span><label>{{ \'name\' | translate }}</label>{{ record.name }}</li><li><span class="icon glyphicon glyphicon-barcode"></span><label>{{ \'code\' | translate }}</label>{{ record.code }}</li><li><span class="icon glyphicon glyphicon-tag"></span><label>{{ \'customer.type\' | translate }}</label>{{ record.customerType.name }}</li><li><span class="icon glyphicon glyphicon-phone"></span><label>{{ \'customer.mobile\' | translate }}</label>{{ record.mobile }}</li><li><span class="icon glyphicon glyphicon-earphone"></span><label>{{ \'customer.phone\' | translate }}</label>{{ record.phone }}</li><li><span class="icon glyphicon glyphicon-briefcase"></span><label>{{ \'customer.contact\' | translate }}</label>{{ record.contact }}</li><li><span class="icon glyphicon glyphicon-envelope"></span><label>{{ \'customer.email\' | translate }}</label>{{ record.email }}</li><li><span class="icon glyphicon glyphicon-user"></span><label>{{ \'created.by\' | translate }}</label>{{ record.createdBy.fullname }}</li><li><span class="icon glyphicon glyphicon-time"></span><label>{{ \'created.time\' | translate }}</label>{{ record.createdTime | isoDateTime }}</li></ul></div></div></div></section></div><div class="col-lg-6"><section class="panel panel-default"><div class="panel-heading"><strong><span class="glyphicon glyphicon-map-marker"></span> {{ \'map\' | translate }}</strong></div><div class="panel-body"><div ng-include=" \'map.html\' "></div></div></section></div></div></div></basic-view>'),$templateCache.put("views/business/approval/customer-pending.html",'<basic-view><div><div class="row title-bar"><div class="col-xs-9"><h3>{{ title | translate }}</h3></div><div class="col-xs-3 title-btn-bar"><button type="button" class="btn btn-info" ng-click="refresh()"><span class="fa fa-refresh"></span></button></div></div><section class="panel panel-default table-dynamic"><table class="table table-middle"><thead class="hidden-xs"><tr><th>{{ \'distributor\' | translate }}</th><th>{{ \'name\' | translate }}</th><th>{{ \'code\' | translate }}</th><th>{{ \'customer.type\' | translate }}</th><th>{{ \'area\' | translate }}</th><th>{{ \'customer.mobile\' | translate }}</th><th>{{ \'created.by\' | translate }}</th><th>{{ \'created.time\' | translate }}</th><th class="w-xxs"></th></tr></thead><tbody><tr ng-repeat="record in records"><td>{{ record.distributor.name }}</td><td>{{ record.name }}</td><th>{{ record.code }}</th><td>{{ record.customerType.name }}</td><td>{{ record.area.name }}</td><td>{{ record.mobile }}</td><td>{{ record.createdBy.fullname }}</td><td>{{ record.createdTime | isoDateTime }}</td><td class="text-right no-padder col-action"><button class="btn" ng-click="goToDetail(record)"><span class="fa fa-2x fa-angle-right"></span></button></td></tr><tr ng-if="isEmpty()"><td colspan="8">{{ \'no.data\' | translate }}</td></tr></tbody></table><div class="wrapper-sm pagination-container"><div class="row"><div class="col-xs-12"><hr class="m-b-sm m-t-none m-l-n-sm m-r-n-sm"></div><div class="col-xs-12 text-right"><pagination class="pagination pagination-sm pagination-right m-n" boundary-links="true" total-items="pagingData.count" max-size="pagingData.pagingMaxSize" items-per-page="pagingData.itemsPerPage" ng-model="pagingData.currentPage" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" ng-change="pageChange()"></pagination></div></div></div></section></div></basic-view>'),$templateCache.put("views/business/approval/order-approval.html",'<basic-view><div><div class="row title-bar"><div class="col-xs-12 title-btn-bar"><button class="btn btn-warning" ng-click="back()"><span class="fa fa-arrow-left"></span></button> <button class="btn btn-dark" ng-click="printOrder()"><span class="fa fa-print"></span></button> <button class="btn btn-danger" ng-click="reject()" confirm="{{ \'order.approval.are.you.sure.reject\' | translate }}" confirm-title="{{ \'confirm.dialog.title\' | translate }}" confirm-ok="{{ \'confirm.dialog.ok\' | translate }}" confirm-cancel="{{ \'confirm.dialog.cancel\' | translate }}" confirm-settings="{ size: \'sm\' }"><span class="fa fa-remove"></span></button> <button class="btn btn-primary" ng-click="approve()" confirm="{{ \'order.approval.are.you.sure.approve\' | translate }}" confirm-title="{{ \'confirm.dialog.title\' | translate }}" confirm-ok="{{ \'confirm.dialog.ok\' | translate }}" confirm-cancel="{{ \'confirm.dialog.cancel\' | translate }}" confirm-settings="{ size: \'sm\' }"><span class="fa fa-check"></span></button></div></div><section class="panel panel-default"><div class="wrapper-sm"><order id="order" data="record"></order></div></section></div></basic-view>'),$templateCache.put("views/business/approval/order-pending.html",'<basic-view><div><div class="row title-bar"><div class="col-xs-9"><h3>{{ title | translate }}</h3></div><div class="col-xs-3 title-btn-bar"><button type="button" class="btn btn-info" ng-click="refresh()"><span class="fa fa-refresh"></span></button></div></div><section class="panel panel-default table-dynamic"><table class="table table-middle table-border-top"><thead class="hidden-xs"><tr><th>{{ \'created.time\' | translate }}</th><th>{{ \'order.no\' | translate }}</th><th>{{ \'distributor\' | translate }}</th><th>{{ \'customer\' | translate }}</th><th>{{ \'salesman\' | translate }}</th><th>{{ \'order.total\' | translate }}</th><th class="w-xxs"></th></tr></thead><tbody><tr ng-repeat="record in records"><td>{{ record.createdTime | isoDateTime }}</td><td>{{ record.code }}</td><td>{{ record.distributor.name }}</td><td>{{ record.customer.name }}</td><td>{{ record.createdBy.fullname }}</td><td>{{ record.grandTotal | number }}</td><td class="text-right no-padder col-action"><button class="btn" ng-click="goToDetail(record)"><span class="fa fa-2x fa-angle-right"></span></button></td></tr><tr ng-if="isEmpty()"><td colspan="{{ 2 + columns.length }}">{{ \'no.data\' | translate }}</td></tr></tbody></table><div class="wrapper-sm pagination-container hide-when-must-select-distributor"><div class="row"><div class="col-xs-12"><hr class="m-b-sm m-t-none m-l-n-sm m-r-n-sm"></div><div class="col-xs-12 text-right"><pagination class="pagination pagination-sm pagination-right m-n" boundary-links="true" total-items="pagingData.count" max-size="pagingData.pagingMaxSize" items-per-page="pagingData.itemsPerPage" ng-model="pagingData.currentPage" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" ng-change="pageChange()"></pagination></div></div></div></section></div></basic-view>'),$templateCache.put("views/business/check-in/check-in-detail.html",'<basic-view class="use-map check-in-detail"><div class="row title-bar"><div class="col-xs-9"><h3>{{ title | translate }}</h3></div><div class="col-xs-3 title-btn-bar"><button class="btn btn-warning" ng-click="back()"><span class="fa fa-arrow-left"></span></button></div></div><div class="row"><div class="col-sm-6"><div class="row"><div class="col-lg-12"><div class="panel panel-profile"><div class="panel-heading bg-primary clearfix"><h3>{{ record.createdBy.fullname }}</h3></div><div class="panel-body"><ul class="list-unstyled list-info"><li><span class="icon glyphicon glyphicon-time"></span><label class="w-md">{{ \'time\' | translate }}</label>{{ record.createdTime | isoDateTime }}</li><li><span class="icon glyphicon glyphicon-pushpin"></span><label class="w-md">{{ \'location\' | translate }}</label>{{ getLocationDisplay(record) }}</li><li><span class="icon glyphicon glyphicon-comment"></span><label class="w-md">{{ \'check.in.note\' | translate }}</label>{{ record.note }}</li></ul></div></div></div></div></div><!--MAP--><div class="col-sm-6"><section class="panel panel-default"><div class="panel-heading"><strong><span class="glyphicon glyphicon-map-marker"></span> {{ \'map\' | translate }}</strong></div><div class="panel-body"><div ng-include=" \'map.html\' "></div></div></section></div><div class="col-xs-12" ng-show="isDisplayPhoto()"><div class="panel panel-default"><div class="panel-heading"><strong><span class="glyphicon glyphicon-camera"></span> {{ \'check.in.photo\' | translate }}</strong></div><div class="panel-body"><div class="photo-container" ng-repeat="photo in record.photos"><div class="img-crop img120_120" style="{{ \'background-image:url(\\\'\' + getPhotoLink(photo) + \'\\\')\' }}"></div><button type="button" class="btn" ng-click="zoomPhoto(photo)"><span class="fa fa-3x fa-search-plus"></span></button></div></div></div></div></div></basic-view>'),$templateCache.put("views/business/check-in/check-in-list.html",'<basic-view class="check-in-list"><div><div class="row title-bar"><div class="col-xs-9"><h3>{{ title | translate }}</h3></div><div class="col-xs-3 title-btn-bar"><button class="btn btn-warning" ng-click="back()"><span class="fa fa-arrow-left"></span></button> <button type="button" class="btn btn-info" ng-click="refresh()"><span class="fa fa-refresh"></span></button></div></div><section class="panel panel-default table-dynamic"><div class="wrapper-sm"><div class="row"><div class="col-xs-6 col-sm-6 col-md-3 m-b-xs"><strong>{{ \'from.date\' | translate }}:&nbsp;</strong> {{ filter.fromDate | isoDate }}</div><div class="col-xs-6 col-sm-6 col-md-3 m-b-xs"><strong>{{ \'to.date\' | translate }}:&nbsp;</strong> {{ filter.toDate | isoDate }}</div><div class="col-xs-12 col-sm-12 col-md-6 m-b-xs"><strong>{{ \'created.by\' | translate }}:&nbsp;</strong> {{ filter.createdByName }}</div></div></div></section><section class="panel panel-default table-dynamic"><table class="table table-middle"><thead class="hidden-xs"><tr><th class="w">{{ \'check.in.created.time\' | translate }}</th><th>{{ \'check.in.note\' | translate }}</th><th class="w text-center">{{ \'check.in.photo\' | translate }}</th><th class="w">{{ \'location\' | translate }}</th><th class="w-3x"></th></tr></thead><tbody><tr ng-repeat="record in records"><td>{{ record.createdTime | isoDateTime }}</td><td><div class="w-xl text-ellipsis">{{ record.note }}</div></td><td class="text-center"><span class="status-icon" ng-class="{ \'color-success\': hasPhoto(record) }"><i class="fa fa-camera-retro"></i></span></td><td><p ng-class="{\n                             \'text-danger\':isLocationUndefined(record),\n                             \'text-success\':isAddressUndefined(record)}">{{ getLocationDisplay(record) }}</p></td><td class="text-right no-padder col-action"><button class="btn" ng-click="goToDetail(record)"><span class="fa fa-2x fa-angle-right"></span></button></td></tr><tr ng-if="isEmpty()"><td colspan="4">{{ \'no.data\' | translate }}</td></tr></tbody></table><div class="wrapper-sm pagination-container"><div class="row"><div class="col-xs-12"><hr class="m-b-sm m-t-none m-l-n-sm m-r-n-sm"></div><div class="col-xs-12 text-right"><pagination class="pagination pagination-sm pagination-right m-n" boundary-links="true" total-items="pagingData.count" max-size="pagingData.pagingMaxSize" items-per-page="pagingData.itemsPerPage" ng-model="pagingData.currentPage" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" ng-change="pageChange()"></pagination></div></div></div></section></div></basic-view>'),$templateCache.put("views/business/check-in/check-in-search.html",'<basic-view><div class="row title-bar"><div class="col-xs-12"><h3>{{ title | translate }}</h3></div></div><section class="panel panel-default wrapper"><form name="form"><div class="max-w-md margin-auto"><div class="row"><div class="col-xs-12"><div class="form-group"><label>{{ \'view.on.map\' | translate }}</label><div class="switch-form-control no-select"><label class="switch switch-success"><input type="checkbox" checked="checked" ng-model="filter.viewOnMap"> <i></i></label></div></div></div></div><div class="row" ng-if="isDisplayDate()"><div class="col-xs-12"><div class="form-group"><label>{{ \'date\' | translate }}</label><div class="input-group ui-datepicker"><input type="text" class="form-control" datepicker-popup="{{ dateFormat }}" ng-model="date.date" is-open="date.opened" datepicker-options="dateOptions" close-text="{{ \'close\' | translate }}" required> <span class="input-group-addon" ng-click="open($event, date)"><i class="fa fa-calendar"></i></span></div></div></div></div><div class="row" ng-if="isDisplayFromDateToDate()"><div class="col-xs-12 col-sm-6"><div class="form-group"><label>{{ \'from.date\' | translate }}</label><div class="input-group ui-datepicker"><input type="text" class="form-control" datepicker-popup="{{ dateFormat }}" ng-model="fromDate.date" is-open="fromDate.opened" datepicker-options="dateOptions" close-text="{{ \'close\' | translate }}" required> <span class="input-group-addon" ng-click="open($event, fromDate)"><i class="fa fa-calendar"></i></span></div></div></div><div class="col-xs-12 col-sm-6"><div class="form-group"><label>{{ \'to.date\' | translate }}</label><div class="input-group ui-datepicker"><input type="text" class="form-control" datepicker-popup="{{ dateFormat }}" ng-model="toDate.date" is-open="toDate.opened" datepicker-options="dateOptions" close-text="{{ \'close\' | translate }}" required> <span class="input-group-addon" ng-click="open($event, toDate)"><i class="fa fa-calendar"></i></span></div></div></div></div><div class="row"><div class="col-xs-12"><div class="form-group"><label>{{ \'created.by\' | translate }} *</label><user-combobox placeholder="{{ \'please.select.created.by\' | translate }}" ng-model="filter.createdById" datas="createdByList" required></user-combobox></div></div></div><div class="row"><div class="col-xs-12 text-right"><button class="btn btn-primary" ng-click="search()">{{ \'search\' | translate }}</button></div></div></div></form></section></basic-view>'),
$templateCache.put("views/business/check-in/check-in-timeline.html",'<basic-view class="use-map check-in-timeline"><div class="row title-bar"><div class="col-xs-9"><h3>{{ title | translate }}</h3></div><div class="col-xs-3 title-btn-bar"><button class="btn btn-warning" ng-click="back()"><span class="fa fa-arrow-left"></span></button></div></div><div class="row"><div class="col-xs-12"><section class="panel panel-default"><div class="panel-body"><div ng-include=" \'map.html\' "></div></div></section></div></div><div class="row" ng-if="isEmpty()"><div class="col-xs-12"><strong>{{ \'no.data\' | translate }}</strong></div></div><div class="page" ng-if="!isEmpty()"><div><section class="ui-timeline"><article class="tl-item"><div class="tl-body"><div class="tl-entry"><div class="tl-caption"><a href="javascript:;" class="btn btn-primary btn-block">{{ filter.date | isoDate }}</a></div></div></div></article><article class="tl-item" ng-repeat="record in records" ng-class="{\'alt\' : $index % 2 == 1}"><div class="tl-body"><div class="tl-entry"><div class="tl-time">{{ record.createdTime | isoTime }}</div><div class="tl-icon square-icon sm" ng-class="{\n                                 \'bg-danger\':getWarningCheckInIcon(record),\n                                 \'bg-info\':getNormalCheckInIcon(record),\n                                 \'bg-success\':getCameraCheckInIcon(record)}"><i class="fa" ng-class="{\n                                   \'fa-exclamation-circle\':getWarningCheckInIcon(record),\n                                   \'fa-asterisk\':getNormalCheckInIcon(record),\n                                   \'fa-camera\':getCameraCheckInIcon(record)}"></i></div><div class="tl-content"><h4 class="tl-tile" ng-class="{\n                                     \'text-danger\':isLocationUndefined(record),\n                                     \'text-success\':isAddressUndefined(record),\n                                     \'text-primary\':!isLocationUndefined(record) && !isAddressUndefined(record)}">{{ getLocationDisplay(record) }}</h4><p>{{ record.note }}</p><div ng-if="isDisplayPhoto(record)"><!--<div class="m-xs inline img-crop img64_64 pos-rlt"--><!--ng-repeat="photo in record.photos"--><!--style="{{ \'background-image:url(\\\'\' + getPhotoLink(photo) + \'\\\')\' }}">--><!--<button class="zoom-photo-button"></button>--><!--</div>--><div class="photo-container" ng-repeat="photo in record.photos"><div class="img-crop img64_64" style="{{ \'background-image:url(\\\'\' + getPhotoLink(photo) + \'\\\')\' }}"></div><button type="button" class="btn" ng-click="zoomPhoto(photo)"><span class="fa fa-2x fa-search-plus"></span></button></div></div><a ng-href="{{ getCheckInDetailLink(record) }}" class="color-success">{{ \'detail\' | translate }}</a></div></div></div></article></section></div></div></basic-view>'),$templateCache.put("views/business/customer/customer-detail.html",'<category-detail class="use-map"><section class="panel panel-default wrapper"><form name="form"><div class="row"><div class="col-sm-6 col-xs-12"><div class="form-group"><label>{{ \'distributor\' | translate }} *</label><name-category-combobox ng-model="record.distributorId" datas="distributors" ng-change="changeDistributor()" ng-readonly="!isDraft()" readonly-name="record.distributor.name" required></name-category-combobox></div></div><div class="col-sm-6 col-xs-12" ng-show="record.distributorId != null"><div class="form-group"><label>{{ \'area\' | translate }} *</label><name-category-combobox ng-model="record.areaId" datas="areas" ng-change="changeStatus.markAsChanged()" ng-readonly="!isDraft()" readonly-name="record.area.name" required></name-category-combobox></div></div></div><div class="row"><div class="col-md-6 col-sm-12"><div class="form-group"><label>{{ \'name\' | translate }} *</label><input type="text" class="form-control" ng-model="record.name" ng-change="changeStatus.markAsChanged()" ng-readonly="!isDraft()" ng-maxlength="100" required></div></div><div class="col-md-3 col-sm-6 col-xs-12"><div class="form-group"><label>{{ \'code\' | translate }}</label><input type="text" class="form-control" ng-model="record.code" readonly="readonly"></div></div><div class="col-md-3 col-sm-6 col-xs-12"><div class="form-group"><label>{{ \'customer.type\' | translate }} *</label><name-category-combobox ng-model="record.customerTypeId" datas="customerTypes" ng-change="changeStatus.markAsChanged()" ng-readonly="!isDraft()" readonly-name="record.customerType.name" required></name-category-combobox></div></div></div><div class="row"><div class="col-sm-6 col-xs-12"><div class="form-group"><label>{{ \'customer.mobile\' | translate }} *</label><input type="text" class="form-control" ng-model="record.mobile" ng-change="changeStatus.markAsChanged()" ng-maxlength="15" required></div></div><div class="col-sm-6 col-xs-12"><div class="form-group"><label>{{ \'customer.phone\' | translate }}</label><input type="text" class="form-control" ng-model="record.phone" ng-change="changeStatus.markAsChanged()" ng-maxlength="15"></div></div><div class="col-sm-6 col-xs-12"><div class="form-group"><label>{{ \'customer.contact\' | translate }}</label><input type="text" class="form-control" ng-model="record.contact" ng-change="changeStatus.markAsChanged()" ng-maxlength="30"></div></div><div class="col-sm-6 col-xs-12"><div class="form-group"><label>{{ \'customer.email\' | translate }}</label><input type="text" class="form-control" ng-model="record.email" ng-change="changeStatus.markAsChanged()" ng-maxlength="30"></div></div><div class="col-xs-12"><label>{{ \'customer.location\' | translate }} *</label><location-selector ng-model="record.location" ng-change="changeStatus.markAsChanged()" marker-title="\'customer.location\'" required></location-selector></div></div></form></section></category-detail>'),$templateCache.put("views/business/customer/customer-select-popup.html",'<div class="modal-header"><h3 class="modal-title">{{ title | translate }} &nbsp;-&nbsp; {{ distributorName | translate }}</h3></div><div class="modal-body customer-select-popup"><!--FILTER--><div class="row"><div class="col-xs-12 m-b-sm"><search-box ng-model="filter.searchText" ng-change="search()" placeholder="{{ \'search\' | translate }}"></search-box></div></div><div ng-if="!isEmpty()"><div class="customer-list"><div class="row" ng-repeat="record in records"><div class="col-xs-12"><hr class="m-n"></div><div class="col-xs-10"><div class="m-t-sm m-b-sm"><div><strong>{{ record.name }}</strong></div><div>{{ record.code }} &nbsp;-&nbsp; {{ record.customerType.name }}</div><div>{{ record.area.name }}</div></div></div><div class="col-xs-2 col-action"><button class="btn" ng-click="selectCustomer(record)"><span class="fa fa-lg fa-check text-success"></span></button></div></div></div><!--PAGING--><div class="row"><div class="col-xs-12"><hr class="m-b-sm m-t-none m-l-n-sm m-r-n-sm"></div><div class="col-xs-12 text-right"><pagination class="pagination pagination-sm pagination-right m-n" boundary-links="true" total-items="pagingData.count" max-size="pagingData.pagingMaxSize" items-per-page="pagingData.itemsPerPage" ng-model="pagingData.currentPage" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" ng-change="reloadData()"></pagination></div></div></div><div ng-if="isEmpty()"><strong>{{ \'no.data\' | translate }}</strong></div></div><div class="modal-footer"><button class="btn btn-warning" ng-click="cancel()"><span class="fa fa-close"></span></button></div>'),$templateCache.put("views/business/dashboard/dashboard.html",'<basic-view class="dashboard"><div class="row"><!--TODAY--><div class="dashboard-right col-lg-4 col-lg-push-8"><div class="panel panel-default today"><div class="panel-heading"><div class="row"><div class="col-xs-6"><p class="size-h4 m-n">{{ \'today\' | translate }}</p></div><div class="col-xs-6 text-right"><p class="size-h4 m-n">{{ record.today | isoDate }}</p></div></div></div><div class="panel-body no-padder"><div class="mini-box"><span class="box-icon bg-primary-light"><i class="fa fa-dollar"></i></span><div class="box-info"><p class="size-h2">{{ record.todayResult.revenue.actual | number:0 }}</p><p class="text-muted">{{ \'revenue\' | translate }}</p></div></div><div class="mini-box"><span class="box-icon bg-primary-light"><i class="fa fa-street-view"></i></span><div class="box-info"><p class="size-h2">{{ record.todayResult.visit.actual | number:0 }} &nbsp;/&nbsp; {{ record.todayResult.visit.plan | number:0 }}</p><p class="text-muted">{{ \'visit\' | translate }}</p></div></div><div class="padder-md"><hr></div><div class="row wrapper-md detail-data"><div class="col-xs-12"><div class="row m-n"><div class="col-xs-3 no-padder"><h1 class="m-n color-info"><strong>{{ record.todayResult.orderNoVisit.actual | number:0 }}</strong></h1></div><div class="col-xs-7 no-padder"><p class="data-label text-ellipsis">{{ \'dashboard.order.no.visit\' | translate }}</p></div><div class="col-xs-2 no-padder text-right"><i class="data-icon fa fa-2x fa-hand-o-right color-info"></i></div></div></div><div class="col-xs-12 m-t-md"><div class="row m-n"><div class="col-xs-3 no-padder"><h1 class="m-n color-success"><strong>{{ record.todayResult.visitHasOrder.actual | number:0 }}</strong></h1></div><div class="col-xs-7 no-padder"><p class="data-label text-ellipsis">{{ \'dashboard.visit.has.order\' | translate }}</p></div><div class="col-xs-2 no-padder text-right"><i class="data-icon fa fa-2x fa-truck color-success"></i></div></div></div><div class="col-xs-12 m-t-md"><div class="row m-n"><div class="col-xs-3 no-padder"><h1 class="m-n color-warning"><strong>{{ record.todayResult.visitErrorDuration.actual | number:0 }}</strong></h1></div><div class="col-xs-7 no-padder"><p class="data-label text-ellipsis">{{ \'dashboard.visit.error.duration\' | translate }}</p></div><div class="col-xs-2 no-padder text-right"><i class="data-icon fa fa-2x fa-clock-o color-warning"></i></div></div></div><div class="col-xs-12 m-t-md"><div class="row m-n"><div class="col-xs-3 no-padder"><h1 class="m-n color-danger"><strong>{{ record.todayResult.visitErrorPosition.actual | number:0 }}</strong></h1></div><div class="col-xs-7 no-padder"><p class="data-label text-ellipsis">{{ \'dashboard.visit.error.position\' | translate }}</p></div><div class="col-xs-2 no-padder text-right"><i class="data-icon fa fa-2x fa-map-marker color-danger"></i></div></div></div></div></div></div></div><div class="dashboard-left col-lg-8 col-lg-pull-4"><!--LAST MONTH COMPARISON--><div class="row"><div class="col-sm-4"><div class="bg-warning"><div class="row"><div class="col-xs-12 text-center m-t-sm"><p class="size-h4">{{ \'order\' | translate }} &nbsp;/&nbsp; {{ \'day\' | translate }}</p></div><div class="col-xs-12 text-center"><i class="fa size-h1" ng-class="getComparisonIcon(record.lastMonthResult.orderByDay, record.thisMonthResult.orderByDay)"></i> &nbsp;<label class="size-h1">{{ record.thisMonthResult.orderByDay | bigNumber }}</label></div><div class="col-xs-12 text-center">{{ \'dashboard.last.month\' | translate }} &nbsp;<label class="size-h3">{{ record.lastMonthResult.orderByDay | bigNumber }}</label></div></div></div></div><div class="col-sm-4"><div class="bg-success"><div class="row"><div class="col-xs-12 text-center m-t-sm"><p class="size-h4">{{ \'revenue\' | translate }} &nbsp;/&nbsp; {{ \'order\' | translate }}</p></div><div class="col-xs-12 text-center"><i class="fa size-h1" ng-class="getComparisonIcon(record.lastMonthResult.revenueByOrder, record.thisMonthResult.revenueByOrder)"></i> &nbsp;<label class="size-h1">{{ record.thisMonthResult.revenueByOrder | bigNumber }}</label></div><div class="col-xs-12 text-center">{{ \'dashboard.last.month\' | translate }} &nbsp;<label class="size-h3">{{ record.lastMonthResult.revenueByOrder | bigNumber }}</label></div></div></div></div><div class="col-sm-4"><div class="bg-info"><div class="row"><div class="col-xs-12 text-center m-t-sm"><p class="size-h4">{{ \'visit\' | translate }} &nbsp;/&nbsp; {{ \'day\' | translate }}</p></div><div class="col-xs-12 text-center"><i class="fa size-h1" ng-class="getComparisonIcon(record.lastMonthResult.visitByDay, record.thisMonthResult.visitByDay)"></i> &nbsp;<label class="size-h1">{{ record.thisMonthResult.visitByDay | bigNumber }}</label></div><div class="col-xs-12 text-center">{{ \'dashboard.last.month\' | translate }} &nbsp;<label class="size-h3">{{ record.lastMonthResult.visitByDay | bigNumber }}</label></div></div></div></div></div><!--REVENUE--><div class="row m-t"><div class="col-md-12"><div class="panel mini-box"><span class="box-icon bg-success"><i class="fa fa-dollar"></i></span><div class="box-info"><p class="size-h2">{{ record.thisMonthResult.revenue.actual | number:0 }}</p><p class="text-muted">{{ \'revenue\' | translate }}</p></div></div></div></div><!--FIVE BEST AND WORST--><div class="row"><!--Progress Warning--><div class="col-sm-6 progress-warning" ng-if="isDisplayProgressWarning()"><section class="panel panel-box"><div class="panel-top bg-bright"><div class="size-h3 text-left">{{ \'dashboard.progress.warning\' | translate }}</div></div><div class="panel-icon bg-danger"><i class="fa fa-exclamation"></i></div><div class="panel-bottom bg-reverse"><ul class="list-group text-left"><li class="list-group-item" ng-repeat="warning in record.progressWarnings"><div class="row"><div class="col-xs-9"><p class="size-h4">{{ warning.name }}</p><progressbar max="warning.progress.plan" value="warning.progress.actual" type="danger"><span>{{ warning.progress.actual | number:0 }}&nbsp;/&nbsp;{{ warning.progress.plan | number:0 }}</span></progressbar></div><div class="col-xs-3 percentage"><span class="badge bg-reverse size-h3 pull-right color-danger">{{ warning.progress.percentage }}%</span></div></div></li></ul></div></section></div><!--PRODUCT BEST SALES--><div class="col-sm-6 best-sellers" ng-if="isDisplayBestSellers()"><section class="panel panel-box"><div class="panel-top bg-bright"><div class="size-h3 text-left">{{ \'dashboard.best.sellers\' | translate }}</div></div><div class="panel-icon bg-warning"><i class="fa fa-gift"></i></div><div class="panel-bottom bg-reverse"><ul class="list-group text-left"><li class="list-group-item" ng-repeat="item in record.bestSellers"><div class="row item-row"><div class="col-xs-8 item-name"><p class="size-h4 text-ellipsis">{{ item.name }}</p></div><div class="col-xs-4 item-quantity"><span class="badge badge-warning size-h4 pull-right">{{ item.result | bigNumber }}</span></div></div></li></ul></div></section></div></div></div></div></basic-view>'),$templateCache.put("views/business/export/check-in-export.html",'<basic-view><div class="row title-bar"><div class="col-xs-12"><h3>{{ title | translate }}</h3></div></div><section class="panel panel-default wrapper"><form name="form"><div class="max-w-md margin-auto"><div class="row"><div class="col-xs-12 col-sm-6"><div class="form-group"><label>{{ \'from.date\' | translate }}</label><div class="input-group ui-datepicker"><input type="text" class="form-control" datepicker-popup="{{ dateFormat }}" ng-model="fromDate.date" is-open="fromDate.opened" datepicker-options="dateOptions" close-text="{{ \'close\' | translate }}" required> <span class="input-group-addon" ng-click="open($event, fromDate)"><i class="fa fa-calendar"></i></span></div></div></div><div class="col-xs-12 col-sm-6"><div class="form-group"><label>{{ \'to.date\' | translate }}</label><div class="input-group ui-datepicker"><input type="text" class="form-control" datepicker-popup="{{ dateFormat }}" ng-model="toDate.date" is-open="toDate.opened" datepicker-options="dateOptions" close-text="{{ \'close\' | translate }}" required> <span class="input-group-addon" ng-click="open($event, toDate)"><i class="fa fa-calendar"></i></span></div></div></div></div><div class="row"><div class="col-xs-12"><div class="form-group"><label>{{ \'created.by\' | translate }} *</label><user-combobox placeholder="{{ \'please.select.created.by\' | translate }}" ng-model="filter.createdById" datas="createdByList" required></user-combobox></div></div></div><div class="row"><div class="col-xs-12 text-right"><button class="btn btn-primary" ng-click="export()">{{ \'export\' | translate }}</button></div></div></div></form></section></basic-view>'),$templateCache.put("views/business/export/exchange-return-export.html",'<basic-view><div class="row title-bar"><div class="col-xs-12"><h3>{{ title | translate }}</h3></div></div><section class="panel panel-default wrapper"><form name="form"><div class="max-w-md margin-auto"><div class="row"><div class="col-xs-12 form-group" ng-show="isUseDistributorFilter()"><label>{{ \'distributor\' | translate }} *</label><name-category-combobox ng-model="filter.distributorId" datas="distributors" placeholder="{{ \'please.select.distributor\' | translate }}" required></name-category-combobox></div><div class="col-sm-6 col-xs-12 form-group"><label>{{ \'from.date\' | translate }} *</label><div class="input-group ui-datepicker"><input type="text" class="form-control" datepicker-popup="{{ dateFormat }}" ng-model="fromDate.date" is-open="fromDate.opened" datepicker-options="dateOptions" close-text="{{ \'close\' | translate }}" required> <span class="input-group-addon" ng-click="open($event, fromDate)"><i class="fa fa-calendar"></i></span></div><div class="w-full m-t-sm hidden-lg hidden-md"></div></div><div class="col-sm-6 col-xs-12 form-group"><label>{{ \'to.date\' | translate }} *</label><div class="input-group ui-datepicker"><input type="text" class="form-control" datepicker-popup="{{ dateFormat }}" ng-model="toDate.date" is-open="toDate.opened" datepicker-options="dateOptions" close-text="{{ \'close\' | translate }}" required> <span class="input-group-addon" ng-click="open($event, toDate)"><i class="fa fa-calendar"></i></span></div></div><div class="col-xs-12 text-right"><button class="btn btn-primary" ng-click="export()">{{ \'export\' | translate }}</button></div></div></div></form></section></basic-view>'),$templateCache.put("views/business/export/order-export.html",'<basic-view><div class="row title-bar"><div class="col-xs-12"><h3>{{ title | translate }}</h3></div></div><section class="panel panel-default wrapper"><form name="form"><div class="max-w-md margin-auto"><div class="row"><div class="col-xs-12"><div class="form-group"><label>{{ \'order.export.detail\' | translate }}</label><div class="switch-form-control no-select"><label class="switch switch-success"><input type="checkbox" checked="checked" ng-model="filter.isDetail"> <i></i></label></div></div></div></div><div class="row" ng-if="isDisplayDate()"><div class="col-xs-12 col-sm-6"><div class="form-group"><label>{{ \'from.date\' | translate }}</label><div class="input-group ui-datepicker"><input type="text" class="form-control" datepicker-popup="{{ dateFormat }}" ng-model="fromDate.date" is-open="fromDate.opened" datepicker-options="dateOptions" close-text="{{ \'close\' | translate }}" required> <span class="input-group-addon" ng-click="open($event, fromDate)"><i class="fa fa-calendar"></i></span></div></div></div><div class="col-xs-12 col-sm-6"><div class="form-group"><label>{{ \'to.date\' | translate }}</label><div class="input-group ui-datepicker"><input type="text" class="form-control" datepicker-popup="{{ dateFormat }}" ng-model="toDate.date" is-open="toDate.opened" datepicker-options="dateOptions" close-text="{{ \'close\' | translate }}" required> <span class="input-group-addon" ng-click="open($event, toDate)"><i class="fa fa-calendar"></i></span></div></div></div></div><div class="row" ng-if="isDisplayDistributor()"><div class="col-xs-12"><div class="form-group"><label>{{ \'distributor\' | translate }} *</label><name-category-combobox placeholder="{{ \'please.select.distributor\' | translate }}" ng-model="filter.distributorId" ng-change="changeDistributor()" datas="distributors" required></name-category-combobox></div></div></div><div class="row" ng-if="isDisplaySalesman()"><div class="col-xs-12"><div class="form-group"><label>{{ \'salesman\' | translate }}</label><user-combobox ng-model="filter.salesmanId" datas="salesmen"></user-combobox></div></div></div><div class="row" ng-if="isDisplayCustomer()"><div class="col-xs-12"><div class="form-group"><label>{{ \'customer\' | translate }}</label><div class="input-group"><input type="text" class="form-control" ng-model="filter.customerName" disabled="disabled"> <span class="input-group-btn"><button class="btn btn-danger" type="button" ng-click="clearCustomer()"><i class="fa fa-close"></i></button> <button class="btn btn-primary" type="button" ng-click="openSelectCustomer()"><i class="fa fa-search"></i></button></span></div></div></div></div><div class="row"><div class="col-xs-12 text-right"><button class="btn btn-primary" ng-click="export()">{{ \'export\' | translate }}</button></div></div></div></form></section></basic-view>'),$templateCache.put("views/business/export/visit-export.html",'<basic-view><div class="row title-bar"><div class="col-xs-12"><h3>{{ title | translate }}</h3></div></div><section class="panel panel-default wrapper"><form name="form"><div class="max-w-md margin-auto"><div class="row" ng-if="isDisplayDate()"><div class="col-xs-12 col-sm-6"><div class="form-group"><label>{{ \'from.date\' | translate }}</label><div class="input-group ui-datepicker"><input type="text" class="form-control" datepicker-popup="{{ dateFormat }}" ng-model="fromDate.date" is-open="fromDate.opened" datepicker-options="dateOptions" close-text="{{ \'close\' | translate }}" required> <span class="input-group-addon" ng-click="open($event, fromDate)"><i class="fa fa-calendar"></i></span></div></div></div><div class="col-xs-12 col-sm-6"><div class="form-group"><label>{{ \'to.date\' | translate }}</label><div class="input-group ui-datepicker"><input type="text" class="form-control" datepicker-popup="{{ dateFormat }}" ng-model="toDate.date" is-open="toDate.opened" datepicker-options="dateOptions" close-text="{{ \'close\' | translate }}" required> <span class="input-group-addon" ng-click="open($event, toDate)"><i class="fa fa-calendar"></i></span></div></div></div></div><div class="row" ng-if="isDisplayDistributor()"><div class="col-xs-12"><div class="form-group"><label>{{ \'distributor\' | translate }} *</label><name-category-combobox placeholder="{{ \'please.select.distributor\' | translate }}" ng-model="filter.distributorId" ng-change="changeDistributor()" datas="distributors" required></name-category-combobox></div></div></div><div class="row" ng-if="isDisplaySalesman()"><div class="col-xs-12"><div class="form-group"><label>{{ \'salesman\' | translate }}</label><user-combobox ng-model="filter.salesmanId" datas="salesmen"></user-combobox></div></div></div><div class="row" ng-if="isDisplayCustomer()"><div class="col-xs-12"><div class="form-group"><label>{{ \'customer\' | translate }}</label><div class="input-group"><input type="text" class="form-control" ng-model="filter.customerName" disabled="disabled"> <span class="input-group-btn"><button class="btn btn-danger" type="button" ng-click="clearCustomer()"><i class="fa fa-close"></i></button> <button class="btn btn-primary" type="button" ng-click="openSelectCustomer()"><i class="fa fa-search"></i></button></span></div></div></div></div><div class="row"><div class="col-xs-12 text-right"><button class="btn btn-primary" ng-click="export()">{{ \'export\' | translate }}</button></div></div></div></form></section></basic-view>'),$templateCache.put("views/business/feedback/feedback-detail.html",'<basic-view><div><div class="row title-bar"><div class="col-xs-9"><h3>{{ title | translate }}</h3></div><div class="col-xs-3 title-btn-bar"><button class="btn btn-warning" ng-click="back()"><span class="fa fa-arrow-left"></span></button></div></div><section class="panel panel-default mail-container"><div class="panel-body"><div class="mail-header row"><div class="col-md-8"><h3>{{ record.customer }}</h3></div><div class="col-md-4"><div class="pull-right"></div></div></div><div class="mail-info"><div class="row"><div class="col-md-8"><strong>{{ record.salesman }}</strong></div><div class="col-md-4"><div class="pull-right">{{ record.createdTime | isoDateTime }}</div></div></div></div><div class="mail-content"><div ng-repeat="message in record.feedbacks track by $index"><h4>#{{ $index + 1 }}</h4><p>{{ message }}</p></div></div></div></section></div></basic-view>'),$templateCache.put("views/business/feedback/feedback.html",'<basic-view><div class="row title-bar"><div class="col-xs-9"><h3>{{ title | translate }}</h3></div><div class="col-xs-3 title-btn-bar"><button type="button" class="btn btn-info" ng-click="refresh()"><span class="fa fa-refresh"></span></button></div></div><section class="panel panel-default mail-container"><table class="table table-hover hover-underline"><tr ng-repeat="record in records track by $index" ng-class="{\'mail-unread\': (!record.feedbacksReaded)}" ng-click="goToDetail(record)" ng-if="records.length > 0"><td class="w-xxs"><i class="fa fa-circle color-info" ng-if="!record.feedbacksReaded"></i></td><td>{{ record.customer }}</td><td style="white-space: nowrap; text-overflow: ellipsis; overflow: hidden; max-width: 400px">{{ getFeedbackDisplay(record) }}</td><td>{{ getTimeDisplay(record.createdTime) }}</td></tr><tr ng-if="records.length == 0"><td colspan="4">{{ \'feedback.empty\' | translate }}</td></tr></table><div class="wrapper-sm pagination-container"><div class="row"><div class="col-xs-12"><hr class="m-b-sm m-t-none m-l-n-sm m-r-n-sm"></div><div class="col-xs-12 text-right"><pagination class="pagination pagination-sm pagination-right m-n" boundary-links="true" total-items="pagingData.count" max-size="pagingData.pagingMaxSize" items-per-page="pagingData.itemsPerPage" ng-model="pagingData.currentPage" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" ng-change="pageChange()"></pagination></div></div></div></section></basic-view>'),$templateCache.put("views/business/history/order-detail.html",'<basic-view><div><div class="row title-bar"><div class="col-xs-12 title-btn-bar"><button class="btn btn-warning" ng-click="back()"><span class="fa fa-arrow-left"></span></button> <button class="btn btn-dark" ng-click="printOrder()"><span class="fa fa-print"></span></button></div></div><section class="panel panel-default"><div class="wrapper-sm"><order id="order" data="record"></order></div></section></div></basic-view>'),$templateCache.put("views/business/history/order-list.html",'<basic-view><div><div class="row title-bar"><div class="col-xs-9"><h3>{{ title | translate }}</h3></div><div class="col-xs-3 title-btn-bar"><button class="btn btn-warning" ng-click="back()"><span class="fa fa-arrow-left"></span></button> <button type="button" class="btn btn-info" ng-click="refresh()"><span class="fa fa-refresh"></span></button></div></div><section class="panel panel-default table-dynamic"><div class="wrapper-sm"><div class="row"><div class="col-xs-6 col-sm-6 col-md-3 m-b-xs"><strong>{{ \'from.date\' | translate }}:&nbsp;</strong> {{ filter.fromDate | isoDate }}</div><div class="col-xs-6 col-sm-6 col-md-3 m-b-xs"><strong>{{ \'to.date\' | translate }}:&nbsp;</strong> {{ filter.toDate | isoDate }}</div><div class="col-xs-12 col-sm-12 col-md-6 m-b-xs" ng-if="isUseDistributorFilter()"><strong>{{ \'distributor\' | translate }}:&nbsp;</strong> {{ filter.distributorName }}</div><div class="col-xs-12 col-sm-12 col-md-6" ng-if="isDisplaySalesman()"><strong>{{ \'salesman\' | translate }}:&nbsp;</strong> {{ filter.salesmanName }}</div><div class="col-xs-12 col-sm-12 col-md-6" ng-if="isDisplayCustomer()"><strong>{{ \'customer\' | translate }}:&nbsp;</strong> {{ filter.customerName }}</div></div></div></section><section class="panel panel-default table-dynamic"><table class="table table-middle"><thead class="hidden-xs"><tr><th>{{ \'order.created.date\' | translate }}</th><th>{{ \'order.no\' | translate }}</th><th>{{ \'distributor\' | translate }}</th><th>{{ \'customer\' | translate }}</th><th>{{ \'salesman\' | translate }}</th><th>{{ \'order.total\' | translate }}</th><th class="w-3x"></th><th class="w-3x"></th></tr></thead><tbody><tr ng-repeat="record in records"><td>{{ record.createdTime | isoDate }}</td><td>{{ record.code }}</td><td>{{ record.distributor.name }}</td><td>{{ record.customer.name }}</td><td>{{ record.createdBy.fullname }}</td><td>{{ record.grandTotal | number }}</td><td class="text-center"><span class="status-icon color-primary" ng-if="record.vanSales"><i class="fa fa-lg fa-truck"></i></span></td><td class="text-right no-padder col-action"><button class="btn" ng-click="goToDetail(record)"><span class="fa fa-2x fa-angle-right"></span></button></td></tr><tr ng-if="isEmpty()"><td colspan="8">{{ \'no.data\' | translate }}</td></tr></tbody></table><div class="wrapper-sm pagination-container"><div class="row"><div class="col-xs-12"><hr class="m-b-sm m-t-none m-l-n-sm m-r-n-sm"></div><div class="col-xs-12 text-right"><pagination class="pagination pagination-sm pagination-right m-n" boundary-links="true" total-items="pagingData.count" max-size="pagingData.pagingMaxSize" items-per-page="pagingData.itemsPerPage" ng-model="pagingData.currentPage" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" ng-change="pageChange()"></pagination></div></div></div></section></div></basic-view>'),$templateCache.put("views/business/history/order-search.html",'<basic-view><div class="row title-bar"><div class="col-xs-12"><h3>{{ title | translate }}</h3></div></div><section class="panel panel-default wrapper"><form name="form"><div class="max-w-md margin-auto"><div class="row"><div class="col-xs-12"><div class="form-group"><label>{{ \'search.by.code\' | translate }}</label><div class="switch-form-control no-select"><label class="switch switch-success"><input type="checkbox" checked="checked" ng-model="filter.searchByCode"> <i></i></label></div></div></div></div><div class="row" ng-if="isDisplayCode()"><div class="col-xs-12"><div class="form-group"><label>{{ \'code\' | translate }}</label><input type="text" class="form-control" ng-model="filter.code" required></div></div></div><div class="row" ng-if="isDisplayDate()"><div class="col-xs-12 col-sm-6"><div class="form-group"><label>{{ \'from.date\' | translate }}</label><div class="input-group ui-datepicker"><input type="text" class="form-control" datepicker-popup="{{ dateFormat }}" ng-model="fromDate.date" is-open="fromDate.opened" datepicker-options="dateOptions" close-text="{{ \'close\' | translate }}" required> <span class="input-group-addon" ng-click="open($event, fromDate)"><i class="fa fa-calendar"></i></span></div></div></div><div class="col-xs-12 col-sm-6"><div class="form-group"><label>{{ \'to.date\' | translate }}</label><div class="input-group ui-datepicker"><input type="text" class="form-control" datepicker-popup="{{ dateFormat }}" ng-model="toDate.date" is-open="toDate.opened" datepicker-options="dateOptions" close-text="{{ \'close\' | translate }}" required> <span class="input-group-addon" ng-click="open($event, toDate)"><i class="fa fa-calendar"></i></span></div></div></div></div><div class="row" ng-if="isDisplayDistributor()"><div class="col-xs-12"><div class="form-group"><label>{{ \'distributor\' | translate }} *</label><name-category-combobox placeholder="{{ \'please.select.distributor\' | translate }}" ng-model="filter.distributorId" ng-change="changeDistributor()" datas="distributors" required></name-category-combobox></div></div></div><div class="row" ng-if="isDisplaySalesman()"><div class="col-xs-12"><div class="form-group"><label>{{ \'salesman\' | translate }}</label><user-combobox ng-model="filter.salesmanId" datas="salesmen"></user-combobox></div></div></div><div class="row" ng-if="isDisplayCustomer()"><div class="col-xs-12"><div class="form-group"><label>{{ \'customer\' | translate }}</label><div class="input-group"><input type="text" class="form-control" ng-model="filter.customerName" disabled="disabled"> <span class="input-group-btn"><button class="btn btn-danger" type="button" ng-click="clearCustomer()"><i class="fa fa-close"></i></button> <button class="btn btn-primary" type="button" ng-click="openSelectCustomer()"><i class="fa fa-search"></i></button></span></div></div></div></div><div class="row"><div class="col-xs-12 text-right"><button class="btn btn-primary" ng-click="search()">{{ \'search\' | translate }}</button></div></div></div></form></section></basic-view>'),
$templateCache.put("views/business/history/visit-list.html",'<basic-view class="visit-list"><div><div class="row title-bar"><div class="col-xs-9"><h3>{{ title | translate }}</h3></div><div class="col-xs-3 title-btn-bar"><button class="btn btn-warning" ng-click="back()"><span class="fa fa-arrow-left"></span></button> <button type="button" class="btn btn-info" ng-click="refresh()"><span class="fa fa-refresh"></span></button></div></div><section class="panel panel-default table-dynamic"><div class="wrapper-sm"><div class="row"><div class="col-xs-6 col-sm-6 col-md-3 m-b-xs"><strong>{{ \'from.date\' | translate }}:&nbsp;</strong> {{ filter.fromDate | isoDate }}</div><div class="col-xs-6 col-sm-6 col-md-3 m-b-xs"><strong>{{ \'to.date\' | translate }}:&nbsp;</strong> {{ filter.toDate | isoDate }}</div><div class="col-xs-12 col-sm-12 col-md-6 m-b-xs" ng-if="isUseDistributorFilter()"><strong>{{ \'distributor\' | translate }}:&nbsp;</strong> {{ filter.distributorName }}</div><div class="col-xs-12 col-sm-12 col-md-6" ng-if="isDisplaySalesman()"><strong>{{ \'salesman\' | translate }}:&nbsp;</strong> {{ filter.salesmanName }}</div><div class="col-xs-12 col-sm-12 col-md-6" ng-if="isDisplayCustomer()"><strong>{{ \'customer\' | translate }}:&nbsp;</strong> {{ filter.customerName }}</div></div></div></section><section class="panel panel-default table-dynamic"><table class="table table-middle visit-info"><thead class="hidden-xs"><tr><th>{{ \'date\' | translate }}</th><th>{{ \'salesman\' | translate }}</th><th>{{ \'customer\' | translate }}</th><th class="w-sm text-center">{{ \'visit.time\' | translate }}</th><th class="w-sm text-center">{{ \'visit.distance\' | translate }}</th><th class="w-sm text-center">{{ \'order\' | translate }}</th><th class="w-sm text-center">{{ \'visit.status\' | translate }}</th><th class="w-xxs"></th></tr></thead><tbody><tr ng-repeat="record in records"><td>{{ record.startTime | isoDate }}</td><td><div><div>{{ record.salesman.fullname }}</div><div>{{ record.distributor.name }}</div></div></td><td>{{ record.customer.name }}</td><td class="text-center"><div><span class="color-success" ng-if="!record.errorDuration"><i class="fa fa-thumbs-up"></i></span> <span class="color-danger" ng-if="record.errorDuration"><i class="fa fa-warning"></i></span> {{ getDurationDisplay(record.duration) }}</div>{{ getStartEndDisplay(record) }}</td><td class="text-center"><div ng-if="isDistanceNormal(record) || isDistanceTooFar(record)"><span class="color-success" ng-if="isDistanceNormal(record)"><i class="fa fa-thumbs-up"></i></span> <span class="color-danger" ng-if="isDistanceTooFar(record)"><i class="fa fa-warning"></i></span> {{ getDistanceDisplay(record.distance) }}</div><span class="label label-danger" ng-if="isLocationSalesmanUndefined(record)">{{ \'visit.salesman.location.undefined\' | translate }}</span> <span class="label label-danger" ng-if="isLocationCustomerUndefined(record)">{{ \'visit.customer.location.undefined\' | translate }}</span></td><td class="text-center"><div class="has-distance" ng-if="!isNoOrder(record)"><span class="color-success" ng-if="isOrderApproved(record)"><i class="fa fa-check"></i></span> <span class="color-info" ng-if="isOrderPending(record)"><i class="fa fa-clock-o"></i></span> <span class="color-danger" ng-if="isOrderRejected(record)"><i class="fa fa-ban"></i></span> {{ record.grandTotal | number }}</div><span class="label label-warning" ng-if="isNoOrder(record)">{{ \'visit.no.order\' | translate }}</span></td><td class="text-center"><div class="status-container text-left"><img class="status-icon closed" src="images/visit-closed.svg" ng-if="record.closed"> <span class="status-icon color-success" ng-if="!record.closed && record.photo != null"><i class="fa fa-camera-retro"></i></span> <span class="status-icon color-primary" ng-if="record.vanSales"><i class="fa fa-truck"></i></span></div></td><td class="text-right no-padder col-action"><button class="btn" ng-click="goToDetail(record)"><span class="fa fa-2x fa-angle-right"></span></button></td></tr><tr ng-if="isEmpty()"><td colspan="6">{{ \'no.data\' | translate }}</td></tr></tbody></table><div class="wrapper-sm pagination-container"><div class="row"><div class="col-xs-12"><hr class="m-b-sm m-t-none m-l-n-sm m-r-n-sm"></div><div class="col-xs-12 text-right"><pagination class="pagination pagination-sm pagination-right m-n" boundary-links="true" total-items="pagingData.count" max-size="pagingData.pagingMaxSize" items-per-page="pagingData.itemsPerPage" ng-model="pagingData.currentPage" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" ng-change="pageChange()"></pagination></div></div></div></section></div></basic-view>'),$templateCache.put("views/business/history/visit-search.html",'<basic-view><div class="row title-bar"><div class="col-xs-12"><h3>{{ title | translate }}</h3></div></div><section class="panel panel-default wrapper"><form name="form"><div class="max-w-md margin-auto"><div class="row" ng-if="isDisplayDate()"><div class="col-xs-12 col-sm-6"><div class="form-group"><label>{{ \'from.date\' | translate }}</label><div class="input-group ui-datepicker"><input type="text" class="form-control" datepicker-popup="{{ dateFormat }}" ng-model="fromDate.date" is-open="fromDate.opened" datepicker-options="dateOptions" close-text="{{ \'close\' | translate }}" required> <span class="input-group-addon" ng-click="open($event, fromDate)"><i class="fa fa-calendar"></i></span></div></div></div><div class="col-xs-12 col-sm-6"><div class="form-group"><label>{{ \'to.date\' | translate }}</label><div class="input-group ui-datepicker"><input type="text" class="form-control" datepicker-popup="{{ dateFormat }}" ng-model="toDate.date" is-open="toDate.opened" datepicker-options="dateOptions" close-text="{{ \'close\' | translate }}" required> <span class="input-group-addon" ng-click="open($event, toDate)"><i class="fa fa-calendar"></i></span></div></div></div></div><div class="row" ng-if="isDisplayDistributor()"><div class="col-xs-12"><div class="form-group"><label>{{ \'distributor\' | translate }} *</label><name-category-combobox placeholder="{{ \'please.select.distributor\' | translate }}" ng-model="filter.distributorId" ng-change="changeDistributor()" datas="distributors" required></name-category-combobox></div></div></div><div class="row" ng-if="isDisplaySalesman()"><div class="col-xs-12"><div class="form-group"><label>{{ \'salesman\' | translate }}</label><user-combobox ng-model="filter.salesmanId" datas="salesmen"></user-combobox></div></div></div><div class="row" ng-if="isDisplayCustomer()"><div class="col-xs-12"><div class="form-group"><label>{{ \'customer\' | translate }}</label><div class="input-group"><input type="text" class="form-control" ng-model="filter.customerName" disabled="disabled"> <span class="input-group-btn"><button class="btn btn-danger" type="button" ng-click="clearCustomer()"><i class="fa fa-close"></i></button> <button class="btn btn-primary" type="button" ng-click="openSelectCustomer()"><i class="fa fa-search"></i></button></span></div></div></div></div><div class="row"><div class="col-xs-12 text-right"><button class="btn btn-primary" ng-click="search()">{{ \'search\' | translate }}</button></div></div></div></form></section></basic-view>'),$templateCache.put("views/business/import/import-customer-schedule.html",'<basic-view class="import-view"><div class="row title-bar"><div class="col-sm-12"><h3>{{ title | translate }}</h3></div></div><section class="panel panel-default wrapper"><div class="wizard"><div class="row"><div ng-class="{\'col-xs-3\':isUseDistributorFilter(), \'col-xs-4\':!isUseDistributorFilter()}" ng-repeat="step in steps"><div class="wizard-element" ng-class="{done: isDoneStep($index), current: isCurrentStep($index)}">{{ ($index + 1) }}.&nbsp;{{ step.name | translate }}</div></div></div></div><hr><div ng-if="currentStep == (steps.length - 4)"><div class="row"><div class="col-xs-12"><label>{{ \'distributor\' | translate }}</label><ui-select ng-model="global.distributorId" required><ui-select-match placeholder="--">{{$select.selected.name}}</ui-select-match><ui-select-choices repeat="data.id as data in distributors | propsFilter: {name: $select.search}"><div>{{ data.name }}</div></ui-select-choices></ui-select></div></div></div><div ng-if="currentStep == (steps.length - 3)"><div class="row"><div class="col-xs-12" ng-if="isUseDistributorFilter()"><h4>{{ \'distributor\' | translate}}:&nbsp;{{ global.distributorName }}</h4><hr></div><div class="col-xs-12"><label>{{ \'import.step.upload.file\' | translate }}</label><single-file ng-model="global.excel" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" required></single-file></div><div class="col-xs-12"><a class="btn btn-tumblr" ng-href="{{ getTemplateLink() }}" style="margin-top: 15px"><span class="fa fa-file-excel-o"></span> {{ \'import.download.customer.list\' | translate }}</a></div></div></div><div ng-if="currentStep == (steps.length - 2)"><div class="row"><div class="col-xs-12" ng-if="isUseDistributorFilter()"><h4>{{ \'distributor\' | translate}}:&nbsp;{{ global.distributorName }}</h4><hr></div><div class="col-xs-12" ng-if="global.confirm.rowDatas == null || global.confirm.rowDatas.length == 0"><div class="mini-box"><span class="box-icon bg-success"><i class="fa fa-thumbs-o-up"></i></span><div class="box-info"><p class="size-h2">{{ global.confirm.total }}</p><p class="text-muted">{{ \'import.record.to.import\' | translate }}</p></div></div></div><div class="col-xs-12" ng-if="global.confirm.rowDatas.length > 0"><div class="mini-box"><span class="box-icon bg-danger"><i class="fa fa-exclamation-triangle"></i></span><div class="box-info"><p class="size-h2">{{ global.confirm.rowDatas.length }}&nbsp;/&nbsp;{{ global.confirm.total }}</p><p class="text-muted">{{ \'import.record.to.import.error\' | translate }}</p></div></div><table class="table table-bordered table-middle text-center table-striped"><thead><tr><th rowspan="2" class="text-center">{{ \'import.row.in.excel\' | translate }}</th><th colspan="6" class="text-center">{{ \'import.error\' | translate }}</th></tr><tr><th class="text-center">{{ \'code\' | translate }}</th><th class="text-center">{{ \'name\' | translate }}</th><th class="text-center">{{ \'area\' | translate }}</th><th class="text-center">{{ \'route\' | translate }}</th></tr></thead><tbody><tr ng-repeat="rowError in global.confirm.rowDatas"><td>{{ rowError.rowNumber }}</td><td ng-class="{\'color-danger\' : rowError.errors[0]}">{{ getRowErrorData(rowError.dataTexts[0]) }}</td><td ng-class="{\'color-danger\' : rowError.errors[1]}">{{ getRowErrorData(rowError.dataTexts[1]) }}</td><td ng-class="{\'color-danger\' : rowError.errors[2]}">{{ getRowErrorData(rowError.dataTexts[2]) }}</td><td ng-class="{\'color-danger\' : rowError.errors[3]}">{{ getRowErrorData(rowError.dataTexts[3]) }}</td></tr></tbody></table></div></div></div><div ng-if="currentStep == (steps.length - 1)"><div class="col-xs-12" ng-if="isUseDistributorFilter()"><h4>{{ \'distributor\' | translate}}:&nbsp;{{ global.distributorName }}</h4><hr></div><div class="col-xs-12"><div class="mini-box"><span class="box-icon bg-info"><i class="fa fa-info"></i></span><div class="box-info"><p class="size-h2">{{ global.result.success }}&nbsp;/&nbsp;{{ global.result.total }}</p><p class="text-muted">{{ \'import.record.has.imported\' | translate }}</p></div></div></div></div><hr><div class="row"><div class="col-xs-12 text-right"><button class="btn btn-warning" ng-if="canBack()" ng-click="backStep()">{{ \'import.back\' | translate }}</button> <button class="btn btn-primary" ng-if="canNext()" ng-disabled="isNextDisabled()" ng-click="nextStep()">{{ \'import.next\' | translate }}</button> <button class="btn btn-success" ng-if="isFinish()" ng-click="finish()">{{ \'import.finish\' | translate }}</button></div></div></section></basic-view>'),$templateCache.put("views/business/import/import-customer.html",'<basic-view class="import-view"><div class="row title-bar"><div class="col-sm-12"><h3>{{ title | translate }}</h3></div></div><section class="panel panel-default wrapper"><div class="wizard"><div class="row"><div class="col-xs-3" ng-repeat="step in steps"><div class="wizard-element" ng-class="{done: isDoneStep($index), current: isCurrentStep($index)}">{{ ($index + 1) }}.&nbsp;{{ step.name | translate }}</div></div></div></div><hr><div ng-if="currentStep == 0"><div class="row"><div class="col-xs-12"><label>{{ \'distributor\' | translate }}</label><ui-select ng-model="global.distributorId" required><ui-select-match placeholder="--">{{$select.selected.name}}</ui-select-match><ui-select-choices repeat="data.id as data in distributors | propsFilter: {name: $select.search}"><div>{{ data.name }}</div></ui-select-choices></ui-select></div></div></div><div ng-if="currentStep == 1"><div class="row"><div class="col-xs-12"><h4>{{ \'distributor\' | translate}}:&nbsp;{{ global.distributorName }}</h4><hr></div><div class="col-xs-12"><label>{{ \'import.step.upload.file\' | translate }}</label><single-file ng-model="global.excel" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" required></single-file></div><div class="col-xs-12"><a class="btn btn-tumblr" ng-href="{{ getTemplateLink() }}" style="margin-top: 15px"><span class="fa fa-file-excel-o"></span> {{ \'import.download.template\' | translate }}</a></div></div></div><div ng-if="currentStep == 2"><div class="row"><div class="col-xs-12"><h4>{{ \'distributor\' | translate}}:&nbsp;{{ global.distributorName }}</h4><hr></div><div class="col-xs-12" ng-if="global.confirm.rowDatas == null || global.confirm.rowDatas.length == 0"><div class="mini-box"><span class="box-icon bg-success"><i class="fa fa-thumbs-o-up"></i></span><div class="box-info"><p class="size-h2">{{ global.confirm.total }}</p><p class="text-muted">{{ \'import.record.to.import\' | translate }}</p></div></div></div><div class="col-xs-12" ng-if="global.confirm.rowDatas.length > 0"><div class="mini-box"><span class="box-icon bg-danger"><i class="fa fa-exclamation-triangle"></i></span><div class="box-info"><p class="size-h2">{{ global.confirm.rowDatas.length }}&nbsp;/&nbsp;{{ global.confirm.total }}</p><p class="text-muted">{{ \'import.record.to.import.error\' | translate }}</p></div></div><table class="table table-bordered table-middle text-center table-striped"><thead><tr><th rowspan="2" class="text-center">{{ \'import.row.in.excel\' | translate }}</th><th colspan="6" class="text-center">{{ \'import.error\' | translate }}</th></tr><tr><th class="text-center">{{ \'name\' | translate }}</th><th class="text-center">{{ \'customer.type\' | translate }}</th><th class="text-center">{{ \'area\' | translate }}</th><th class="text-center">{{ \'customer.mobile\' | translate }}</th><th class="text-center">{{ \'latitude\' | translate }}</th><th class="text-center">{{ \'longitude\' | translate }}</th></tr></thead><tbody><tr ng-repeat="rowError in global.confirm.rowDatas"><td>{{ rowError.rowNumber }}</td><td ng-class="{\'color-danger\' : rowError.errors[0]}">{{ getRowErrorData(rowError.dataTexts[0]) }}</td><td ng-class="{\'color-danger\' : rowError.errors[1]}">{{ getRowErrorData(rowError.dataTexts[1]) }}</td><td ng-class="{\'color-danger\' : rowError.errors[2]}">{{ getRowErrorData(rowError.dataTexts[2]) }}</td><td ng-class="{\'color-danger\' : rowError.errors[3]}">{{ getRowErrorData(rowError.dataTexts[3]) }}</td><td ng-class="{\'color-danger\' : rowError.errors[4]}">{{ getRowErrorData(rowError.dataTexts[4]) }}</td><td ng-class="{\'color-danger\' : rowError.errors[5]}">{{ getRowErrorData(rowError.dataTexts[5]) }}</td></tr></tbody></table></div></div></div><div ng-if="currentStep == 3"><div class="col-xs-12"><h4>{{ \'distributor\' | translate}}:&nbsp;{{ global.distributorName }}</h4><hr></div><div class="col-xs-12"><div class="mini-box"><span class="box-icon bg-info"><i class="fa fa-info"></i></span><div class="box-info"><p class="size-h2">{{ global.result.success }}&nbsp;/&nbsp;{{ global.result.total }}</p><p class="text-muted">{{ \'import.record.has.imported\' | translate }}</p></div></div></div></div><hr><div class="row"><div class="col-xs-12 text-right"><button class="btn btn-warning" ng-if="canBack()" ng-click="backStep()">{{ \'import.back\' | translate }}</button> <button class="btn btn-primary" ng-if="canNext()" ng-disabled="isNextDisabled()" ng-click="nextStep()">{{ \'import.next\' | translate }}</button> <button class="btn btn-success" ng-if="isFinish()" ng-click="finish()">{{ \'import.finish\' | translate }}</button></div></div></section></basic-view>'),$templateCache.put("views/business/import/import-distributor-price-list.html",'<basic-view class="import-view"><div class="row title-bar"><div class="col-sm-12"><h3>{{ title | translate }}</h3></div></div><section class="panel panel-default wrapper"><div class="wizard"><div class="row"><div class="col-xs-4" ng-repeat="step in steps"><div class="wizard-element" ng-class="{done: isDoneStep($index), current: isCurrentStep($index)}">{{ ($index + 1) }}.&nbsp;{{ step.name | translate }}</div></div></div></div><hr><div ng-if="currentStep == (steps.length - 3)"><div class="row"><div class="col-xs-12"><label>{{ \'import.step.upload.file\' | translate }}</label><single-file ng-model="global.excel" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" required></single-file></div><div class="col-xs-12"><a class="btn btn-tumblr" ng-href="{{ getTemplateLink() }}" style="margin-top: 15px"><span class="fa fa-file-excel-o"></span> {{ \'import.download.product.list\' | translate }}</a></div></div></div><div ng-if="currentStep == (steps.length - 2)"><div class="row"><div class="col-xs-12" ng-if="global.confirm.rowDatas == null || global.confirm.rowDatas.length == 0"><div class="mini-box"><span class="box-icon bg-success"><i class="fa fa-thumbs-o-up"></i></span><div class="box-info"><p class="size-h2">{{ global.confirm.total }}</p><p class="text-muted">{{ \'import.record.to.import\' | translate }}</p></div></div></div><div class="col-xs-12" ng-if="global.confirm.rowDatas.length > 0"><div class="mini-box"><span class="box-icon bg-danger"><i class="fa fa-exclamation-triangle"></i></span><div class="box-info"><p class="size-h2">{{ global.confirm.rowDatas.length }}&nbsp;/&nbsp;{{ global.confirm.total }}</p><p class="text-muted">{{ \'import.record.to.import.error\' | translate }}</p></div></div><table class="table table-bordered table-middle text-center table-striped"><thead><tr><th rowspan="2" class="text-center">{{ \'import.row.in.excel\' | translate }}</th><th colspan="6" class="text-center">{{ \'import.error\' | translate }}</th></tr><tr><th class="text-center">{{ \'code\' | translate }}</th><th class="text-center">{{ \'name\' | translate }}</th><th class="text-center">{{ \'product.category\' | translate }}</th><th class="text-center">{{ \'uom.short\' | translate }}</th><th class="text-center">{{ \'price.list.company.price\' | translate }}</th><th class="text-center">{{ \'price.list.distributor.price\' | translate }}</th></tr></thead><tbody><tr ng-repeat="rowError in global.confirm.rowDatas"><td>{{ rowError.rowNumber }}</td><td ng-class="{\'color-danger\' : rowError.errors[0]}">{{ getRowErrorData(rowError.dataTexts[0]) }}</td><td ng-class="{\'color-danger\' : rowError.errors[1]}">{{ getRowErrorData(rowError.dataTexts[1]) }}</td><td ng-class="{\'color-danger\' : rowError.errors[2]}">{{ getRowErrorData(rowError.dataTexts[2]) }}</td><td ng-class="{\'color-danger\' : rowError.errors[3]}">{{ getRowErrorData(rowError.dataTexts[3]) }}</td><td ng-class="{\'color-danger\' : rowError.errors[4]}">{{ getRowErrorData(rowError.dataTexts[4]) }}</td><td ng-class="{\'color-danger\' : rowError.errors[5]}">{{ getRowErrorData(rowError.dataTexts[5]) }}</td></tr></tbody></table></div></div></div><div ng-if="currentStep == (steps.length - 1)"><div class="col-xs-12"><div class="mini-box"><span class="box-icon bg-info"><i class="fa fa-info"></i></span><div class="box-info"><p class="size-h2">{{ global.result.success }}&nbsp;/&nbsp;{{ global.result.total }}</p><p class="text-muted">{{ \'import.record.has.imported\' | translate }}</p></div></div></div></div><hr><div class="row"><div class="col-xs-12 text-right"><button class="btn btn-warning" ng-if="canBack()" ng-click="backStep()">{{ \'import.back\' | translate }}</button> <button class="btn btn-primary" ng-if="canNext()" ng-disabled="isNextDisabled()" ng-click="nextStep()">{{ \'import.next\' | translate }}</button> <button class="btn btn-success" ng-if="isFinish()" ng-click="finish()">{{ \'import.finish\' | translate }}</button></div></div></section></basic-view>'),$templateCache.put("views/business/import/import-inventory.html",'<basic-view class="import-view"><div class="row title-bar"><div class="col-sm-12"><h3>{{ title | translate }}</h3></div></div><section class="panel panel-default wrapper"><div class="wizard"><div class="row"><div class="col-xs-12 col-sm-4" ng-repeat="step in steps"><div class="wizard-element" ng-class="{done: isDoneStep($index), current: isCurrentStep($index)}">{{ ($index + 1) }}.&nbsp;{{ step.name | translate }}</div></div></div></div><hr><div ng-if="currentStep == 0"><div class="max-w-md margin-auto"><div class="row"><div class="col-xs-12"><div class="date-time-picker"><div class="form-group"><label>{{ \'inventory.time\' | translate }}</label><div class="input-group ui-datepicker"><input type="text" class="form-control" ng-class="{\'ng-invalid\': global.date.date == null}" datepicker-popup="{{ dateFormat }}" ng-model="global.date.date" is-open="global.date.opened" datepicker-options="dateOptions" close-text="{{ \'close\' | translate }}"> <span class="input-group-addon" ng-click="open($event, global.date)"><i class="fa fa-calendar"></i></span></div></div><div class="time-picker-container"><timepicker ng-model="global.date.time" show-meridian="false"></timepicker></div></div></div></div><div class="row"><div class="col-xs-12"><label>{{ \'import.step.upload.file\' | translate }}</label><single-file ng-model="global.excel" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" required></single-file></div><div class="col-xs-12"><a class="btn btn-tumblr" ng-href="{{ getTemplateLink() }}" style="margin-top: 15px"><span class="fa fa-file-excel-o"></span> {{ \'import.download.template\' | translate }}</a></div></div></div></div><div ng-if="currentStep == 1"><div class="row"><div class="col-xs-12"><h4>{{ \'inventory.time\' | translate}}:&nbsp;{{ getIsoTime() | isoDateTime }}</h4><hr></div><div class="col-xs-12" ng-if="global.confirm.rowDatas == null || global.confirm.rowDatas.length == 0"><div class="mini-box"><span class="box-icon bg-success"><i class="fa fa-thumbs-o-up"></i></span><div class="box-info"><p class="size-h2">{{ global.confirm.total }}</p><p class="text-muted">{{ \'import.record.to.import\' | translate }}</p></div></div></div><div class="col-xs-12" ng-if="global.confirm.rowDatas.length > 0"><div class="mini-box"><span class="box-icon bg-danger"><i class="fa fa-exclamation-triangle"></i></span><div class="box-info"><p class="size-h2">{{ global.confirm.rowDatas.length }}&nbsp;/&nbsp;{{ global.confirm.total }}</p><p class="text-muted">{{ \'import.record.to.import.error\' | translate }}</p></div></div><table class="table table-bordered table-middle text-center table-striped"><thead><tr><th rowspan="2" class="text-center">{{ \'import.row.in.excel\' | translate }}</th><th colspan="3" class="text-center">{{ \'import.error\' | translate }}</th></tr><tr><th class="text-center">{{ \'product\' | translate }}</th><th class="text-center">{{ \'code\' | translate }}</th><th class="text-center">{{ \'quantity\' | translate }}</th></tr></thead><tbody><tr ng-repeat="rowError in global.confirm.rowDatas"><td>{{ rowError.rowNumber }}</td><td ng-class="{\'color-danger\' : rowError.errors[0]}">{{ getRowErrorData(rowError.dataTexts[0]) }}</td><td ng-class="{\'color-danger\' : rowError.errors[1]}">{{ getRowErrorData(rowError.dataTexts[1]) }}</td><td ng-class="{\'color-danger\' : rowError.errors[2]}">{{ getRowErrorData(rowError.dataTexts[2]) }}</td></tr></tbody></table></div></div></div><div ng-if="currentStep == 2"><div class="col-xs-12"><h4>{{ \'inventory.time\' | translate}}:&nbsp;{{ getIsoTime() | isoDateTime }}</h4><hr></div><div class="col-xs-12"><div class="mini-box"><span class="box-icon bg-info"><i class="fa fa-info"></i></span><div class="box-info"><p class="size-h2">{{ global.result.success }}&nbsp;/&nbsp;{{ global.result.total }}</p><p class="text-muted">{{ \'import.record.has.imported\' | translate }}</p></div></div></div></div><hr><div class="row"><div class="col-xs-12 text-right"><button class="btn btn-warning" ng-if="canBack()" ng-click="backStep()">{{ \'import.back\' | translate }}</button> <button class="btn btn-primary" ng-if="canNext()" ng-disabled="isNextDisabled()" ng-click="nextStep()">{{ \'import.next\' | translate }}</button> <button class="btn btn-success" ng-if="isFinish()" ng-click="finish()">{{ \'import.finish\' | translate }}</button></div></div></section></basic-view>'),$templateCache.put("views/business/import/import-master-data.html",'<basic-view class="import-view"><div class="row title-bar"><div class="col-sm-12"><h3>{{ title | translate }}</h3></div></div><section class="panel panel-default wrapper"><div class="wizard"><div class="row"><div class="col-xs-4" ng-repeat="step in steps"><div class="wizard-element" ng-class="{done: isDoneStep($index), current: isCurrentStep($index)}">{{ ($index + 1) }}.&nbsp;{{ step.name | translate }}</div></div></div></div><hr><div ng-if="currentStep == 0"><div class="row"><div class="col-xs-12"><label>{{ \'import.step.upload.file\' | translate }}</label><single-file ng-model="global.excel" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" required></single-file></div><div class="col-xs-12"><a class="btn btn-tumblr" ng-href="{{ getTemplateLink() }}" style="margin-top: 15px"><span class="fa fa-file-excel-o"></span> {{ \'import.download.template\' | translate }}</a></div></div></div><div ng-if="currentStep == 1"><div class="row"><div class="col-xs-12" ng-if="global.confirm.rowDatas == null || global.confirm.rowDatas.length == 0"><div class="mini-box"><span class="box-icon bg-success"><i class="fa fa-thumbs-o-up"></i></span><div class="box-info"><p class="size-h2">OK</p><p class="text-muted">Data is correct</p></div></div></div><div class="col-xs-12" ng-if="global.confirm.rowDatas.length > 0"><div class="mini-box"><span class="box-icon bg-danger"><i class="fa fa-exclamation-triangle"></i></span><div class="box-info"><p class="size-h2">Error on sheet:&nbsp;{{ global.confirm.sheetName }}</p><p class="text-muted">Sheet number:&nbsp;{{ global.confirm.sheetIndex }}</p></div></div><table class="table table-bordered table-middle text-center table-striped"><thead><tr><th>#</th><th ng-repeat="index in columnIndex">{{ global.confirm.columns[index] }}</th></tr></thead><tbody><tr ng-repeat="rowError in global.confirm.rowDatas"><td>{{ rowError.rowNumber }}</td><td ng-repeat="index in columnIndex" ng-class="{\'color-danger\' : rowError.errors[index]}">{{ getRowErrorData(rowError.dataTexts[index]) }}</td></tr></tbody></table></div></div></div><div ng-if="currentStep == 2"><div class="col-xs-12"><div class="mini-box"><span class="box-icon bg-info"><i class="fa fa-info"></i></span><div class="box-info"><p class="size-h2">OK</p><p class="text-muted">Data is imported</p></div></div></div></div><hr><div class="row"><div class="col-xs-12 text-right"><button class="btn btn-warning" ng-if="canBack()" ng-click="backStep()">{{ \'import.back\' | translate }}</button> <button class="btn btn-primary" ng-if="canNext()" ng-disabled="isNextDisabled()" ng-click="nextStep()">{{ \'import.next\' | translate }}</button> <button class="btn btn-success" ng-if="isFinish()" ng-click="finish()">{{ \'import.finish\' | translate }}</button></div></div></section></basic-view>'),$templateCache.put("views/business/import/import-product.html",'<basic-view class="import-view"><div class="row title-bar"><div class="col-sm-12"><h3>{{ title | translate }}</h3></div></div><section class="panel panel-default wrapper"><div class="wizard"><div class="row"><div class="col-xs-3" ng-repeat="step in steps"><div class="wizard-element" ng-class="{done: isDoneStep($index), current: isCurrentStep($index)}">{{ ($index + 1) }}.&nbsp;{{ step.name | translate }}</div></div></div></div><hr><form name="form"><div ng-if="currentStep == 0"><div class="row"><div class="col-xs-12"><label>{{ \'import.step.upload.file\' | translate }}</label><single-file ng-model="global.excel" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" required></single-file></div><div class="col-xs-12"><a class="btn btn-tumblr" ng-href="{{ getTemplateLink() }}" style="margin-top: 15px"><span class="fa fa-file-excel-o"></span> {{ \'import.download.template\' | translate }}</a></div></div></div><div ng-if="currentStep == 1"><div class="row"><div class="col-xs-12" ng-if="global.confirm.rowDatas == null || global.confirm.rowDatas.length == 0"><div class="mini-box"><span class="box-icon bg-success"><i class="fa fa-thumbs-o-up"></i></span><div class="box-info"><p class="size-h2">{{ global.confirm.total }}</p><p class="text-muted">{{ \'import.record.to.import\' | translate }}</p></div></div></div><div class="col-xs-12" ng-if="global.confirm.rowDatas.length > 0"><div class="mini-box"><span class="box-icon bg-danger"><i class="fa fa-exclamation-triangle"></i></span><div class="box-info"><p class="size-h2">{{ global.confirm.rowDatas.length }}&nbsp;/&nbsp;{{ global.confirm.total }}</p><p class="text-muted">{{ \'import.record.to.import.error\' | translate }}</p></div></div><table class="table table-bordered table-middle text-center table-striped"><thead><tr><th rowspan="2" class="text-center">{{ \'import.row.in.excel\' | translate }}</th><th colspan="6" class="text-center">{{ \'import.error\' | translate }}</th></tr><tr><th class="text-center">{{ \'code\' | translate }}</th><th class="text-center">{{ \'name\' | translate }}</th><th class="text-center">{{ \'product.category\' | translate }}</th><th class="text-center">{{ \'uom.short\' | translate }}</th><th class="text-center">{{ \'product.price\' | translate }}</th><th class="text-center">{{ \'product.productivity\' | translate }} &nbsp; ({{ getProductivityUnit() }})</th></tr></thead><tbody><tr ng-repeat="rowError in global.confirm.rowDatas"><td>{{ rowError.rowNumber }}</td><td ng-class="{\'color-danger\' : rowError.errors[0]}">{{ getRowErrorData(rowError.dataTexts[0]) }}</td><td ng-class="{\'color-danger\' : rowError.errors[1]}">{{ getRowErrorData(rowError.dataTexts[1]) }}</td><td ng-class="{\'color-danger\' : rowError.errors[2]}">{{ getRowErrorData(rowError.dataTexts[2]) }}</td><td ng-class="{\'color-danger\' : rowError.errors[3]}">{{ getRowErrorData(rowError.dataTexts[3]) }}</td><td ng-class="{\'color-danger\' : rowError.errors[4]}">{{ getRowErrorData(rowError.dataTexts[4]) }}</td><td ng-class="{\'color-danger\' : rowError.errors[5]}">{{ getRowErrorData(rowError.dataTexts[5]) }}</td></tr></tbody></table></div></div></div><div ng-if="currentStep == 2"><div class="row"><div class="col-xs-12"><table class="table table-bordered table-middle text-center table-striped"><thead><tr><th class="text-center">{{ \'import.row.in.excel\' | translate }}</th><th class="text-center">{{ \'code\' | translate }}</th><th class="text-center">{{ \'name\' | translate }}</th><th class="text-center">{{ \'product.category\' | translate }}</th><th class="text-center">{{ \'uom.short\' | translate }}</th><th class="text-center">{{ \'product.price\' | translate }}</th><th class="text-center" style="width: 100px">{{ \'product.photo\' | translate }}</th></tr></thead><tbody><tr ng-repeat="row in global.data.rowDatas"><td>{{ row.rowNumber }}</td><td>{{ row.dataTexts[0] }}</td><td>{{ row.dataTexts[1] }}</td><td>{{ row.dataTexts[2] }}</td><td>{{ row.dataTexts[3] }}</td><td>{{ row.dataTexts[4] }}</td><td><single-image class="mini-display" ng-model="global.photos[$index]" size-type="standard" required></single-image></td></tr></tbody></table></div></div></div><div ng-if="currentStep == 3"><div class="col-xs-12"><h4>{{ \'distributor\' | translate}}:&nbsp;{{ global.distributorName }}</h4><hr></div><div class="col-xs-12"><div class="mini-box"><span class="box-icon bg-info"><i class="fa fa-info"></i></span><div class="box-info"><p class="size-h2">{{ global.result.success }}&nbsp;/&nbsp;{{ global.result.total }}</p><p class="text-muted">{{ \'import.record.has.imported\' | translate }}</p></div></div></div></div></form><hr><div class="row"><div class="col-xs-12 text-right"><button class="btn btn-warning" ng-if="canBack()" ng-click="backStep()">{{ \'import.back\' | translate }}</button> <button class="btn btn-primary" ng-if="canNext()" ng-disabled="isNextDisabled()" ng-click="nextStep()">{{ \'import.next\' | translate }}</button> <button class="btn btn-success" ng-if="isFinish()" ng-click="finish()">{{ \'import.finish\' | translate }}</button></div></div></section></basic-view>'),
$templateCache.put("views/business/inventory/inventory-detail.html",'<category-detail class="inventory-detail"><form name="form"><section class="panel panel-default wrapper"><div class="max-w-md margin-auto" ng-if="isDraft()"><div class="row"><div class="col-xs-12"><div class="date-time-picker"><div class="form-group"><label>{{ \'inventory.time\' | translate }}</label><div class="input-group ui-datepicker"><input type="text" class="form-control" ng-class="{\'ng-invalid\': date.date == null}" datepicker-popup="{{ dateFormat }}" ng-model="date.date" ng-change="changeStatus.markAsChanged()" is-open="date.opened" datepicker-options="dateOptions" close-text="{{ \'close\' | translate }}"> <span class="input-group-addon" ng-click="open($event, date)"><i class="fa fa-calendar"></i></span></div></div><div class="time-picker-container"><timepicker ng-model="date.time" ng-change="changeStatus.markAsChanged()" show-meridian="false"></timepicker></div></div></div></div></div><div class="row" ng-if="!isDraft()"><div class="col-xs-12"><h4>{{ \'inventory.time\' | translate }}:&nbsp;{{ getIsoTime() | isoDateTimeWithoutSecond }}</h4></div></div></section><section class="panel panel-default"><div class="row"><div class="col-xs-12"><table class="table table-middle no-margin"><thead><tr><th colspan="2" style="border-right: 1px solid #ddd">{{ \'product\' | translate }}</th><th class="text-center w-sm info">{{ \'quantity\' | translate }}</th></tr></thead><tbody><tr ng-repeat="product in products"><td class="text-center danger" colspan="2" style="border-right: 1px solid #ddd" ng-if="product.isCategory"><strong>{{ product.name }}</strong></td><td class="info" ng-if="product.isCategory"></td><td class="product-photo" ng-if="!product.isCategory"><img ng-src="{{getPhotoLink(product.photo)}}" alt class="img-circle img64_64"></td><td ng-if="!product.isCategory" style="border-right: 1px solid #ddd"><div><strong>{{ product.name }}</strong></div><div>{{ product.code }}</div></td><td class="info" ng-if="!product.isCategory"><input class="form-control" ng-model="product.quantity" fcsa-number="{ min: 0, max: 1000000000000, maxDecimals: 0}" ng-change="changeStatus.markAsChanged()" required ng-if="isDraft()"><div class="text-right" ng-if="!isDraft()">{{ product.quantity | number:0 }}</div></td></tr></tbody></table></div></div></section></form></category-detail>'),$templateCache.put("views/business/inventory/inventory-list.html",'<basic-view><div class="category-list"><!--HEADER--><div class="row title-bar"><div class="col-xs-6"><h3>{{ title | translate }}</h3></div><div class="col-xs-6 title-btn-bar"><button type="button" class="btn btn-info" ng-click="refresh()"><span class="fa fa-refresh"></span></button> <button type="button" class="btn btn-success" ng-click="goToImport()"><span class="fa fa-file-excel-o"></span></button> <button type="button" class="btn btn-primary" ng-click="createRecord()"><span class="fa fa-plus"></span></button></div></div><section class="panel panel-default table-dynamic"><!--TABLE--><table class="table table-middle table-border-top" ng-if="!isEmpty()"><thead class="hidden-xs"><tr><th>{{ \'time\' | translate }}</th><th class="col-action"></th></tr></thead><tbody><!--HAS DATA--><tr ng-repeat="record in records"><td class="col-data"><div class="text-ellipsis">{{ record.time | isoDateTimeWithoutSecond }}</div></td><!--ACTION ON GRID--><td class="text-right no-padder col-action"><button class="btn" ng-click="deleteRecord(record)" ng-disabled="!record.draft" confirm="{{ \'confirm.dialog.are.you.sure.delete\' | translate }}" confirm-title="{{ \'confirm.dialog.title\' | translate }}" confirm-ok="{{ \'confirm.dialog.ok\' | translate }}" confirm-cancel="{{ \'confirm.dialog.cancel\' | translate }}" confirm-settings="{ size: \'sm\' }"><span class="fa fa-lg fa-remove text-danger"></span></button> <button class="btn" ng-click="enableRecord(record)" ng-disabled="!record.draft" confirm="{{ \'confirm.dialog.are.you.sure.enable\' | translate }}" confirm-title="{{ \'confirm.dialog.title\' | translate }}" confirm-ok="{{ \'confirm.dialog.ok\' | translate }}" confirm-cancel="{{ \'confirm.dialog.cancel\' | translate }}" confirm-settings="{ size: \'sm\' }"><span class="fa fa-lg fa-check text-primary"></span></button> <button class="btn" ng-click="editRecord(record)" ng-disabled="!record.active"><span class="fa fa-lg fa-pencil text-info"></span></button></td></tr></tbody></table><!--NO DATA--><div class="row" ng-if="isEmpty()"><div class="col-xs-12"><div class="wrapper-sm">{{ \'no.data\' | translate }}</div></div></div><!--PAGING--><div class="wrapper-sm pagination-container"><div class="row"><div class="col-xs-12"><hr class="m-b-sm m-t-none m-l-n-sm m-r-n-sm"></div><div class="col-xs-12 text-right"><pagination class="pagination pagination-sm pagination-right m-n" boundary-links="true" total-items="pagingData.count" max-size="pagingData.pagingMaxSize" items-per-page="pagingData.itemsPerPage" ng-model="pagingData.currentPage" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" ng-change="pageChange()"></pagination></div></div></div></section></div></basic-view>'),$templateCache.put("views/business/price-list/distributor-price-list.html",'<basic-view><div class="row title-bar"><div class="col-xs-6"><h3>{{ title | translate }}</h3></div><div class="col-xs-6 title-btn-bar"><button type="button" class="btn btn-success" ng-click="goToImport()"><span class="fa fa-file-excel-o"></span></button> <button class="btn btn-warning" ng-click="refresh()" ng-if="changeStatus.isChanged"><span class="fa fa-remove"></span></button> <button class="btn btn-success" ng-click="save()" ng-if="changeStatus.isChanged"><span class="fa fa-save"></span></button></div></div><section class="panel panel-default"><form name="form"><div class="virtual-table"><div class="row virtual-table-header"><div class="col-xs-4 virtual-table-col">{{ \'name\' | translate }}</div><div class="col-xs-4 virtual-table-col">{{ \'price.list.company.price\' | translate }}</div><div class="col-xs-4 virtual-table-col">{{ \'price.list.distributor.price\' | translate }}</div></div><div class="virtual-table-body"><div ng-repeat="data in datas"><div class="row virtual-table-row"><div class="col-xs-4 virtual-table-col"><strong>{{ data.name }}</strong></div></div><div class="row virtual-table-row has-form-control" ng-repeat="product in data.products"><div class="col-xs-4 virtual-table-col child-1"><span>{{ product.name }}</span></div><div class="col-xs-4 virtual-table-col">{{ product.price | number:0 }}</div><div class="col-xs-4 virtual-table-col"><input class="form-control" ng-model="product.distributorPrice" ng-change="changeStatus.markAsChanged()" fcsa-number="{ min: 1, max: 1000000000, maxDecimals: 0}"></div></div></div><div class="row virtual-table-row" ng-if="isEmpty()"><div class="col-xs-4 virtual-table-col">{{ \'no.data\' | translate }}</div></div></div></div></form></section></basic-view>'),$templateCache.put("views/business/product/product-detail.html",'<category-detail><section class="panel panel-default wrapper"><form name="form"><div class="row"><div class="col-md-3 col-sm-12"><div class="form-group"><label>{{ \'product.photo\' | translate }} *</label><single-image ng-model="record.photo" ng-change="changeStatus.markAsChanged()" size-type="standard" required></single-image></div></div><div class="col-md-9 col-sm-12"><div class="row"><div class="col-sm-6 col-xs-12"><div class="form-group"><label>{{ \'code\' | translate }} *</label><input type="text" class="form-control" ng-model="record.code" ng-change="changeStatus.markAsChanged()" ng-maxlength="30" ng-pattern="/^\\S+$/" ng-readonly="!isDraft()" required autofocus></div></div><div class="col-sm-6 col-xs-12"><div class="form-group"><label>{{ \'name\' | translate }} *</label><input type="text" class="form-control" ng-model="record.name" ng-change="changeStatus.markAsChanged()" ng-maxlength="50" ng-readonly="!isDraft()" required></div></div><div class="col-sm-6 col-xs-12"><div class="form-group"><label>{{ \'product.category\' | translate }} *</label><name-category-combobox ng-model="record.productCategoryId" ng-change="changeStatus.markAsChanged()" datas="productCategories" ng-readonly="!isDraft()" readonly-name="record.productCategory.name" required></name-category-combobox></div></div><div class="col-sm-6 col-xs-12"><div class="form-group"><label>{{ \'uom\' | translate }} *</label><name-category-combobox ng-model="record.uomId" ng-change="changeStatus.markAsChanged()" datas="uoms" ng-readonly="!isDraft()" readonly-name="record.uom.name" required></name-category-combobox></div></div><div class="col-sm-6 col-xs-12"><div class="form-group"><label>{{ \'product.price\' | translate }} *</label><input class="form-control" ng-model="record.price" ng-change="changeStatus.markAsChanged()" fcsa-number="{ min: 1, max: 1000000000, maxDecimals: 0}" required></div></div><div class="col-sm-6 col-xs-12"><div class="form-group"><label>{{ \'product.productivity\' | translate }}&nbsp;({{ getProductivityUnit() }}) *</label><input class="form-control" ng-model="record.productivity" ng-change="changeStatus.markAsChanged()" fcsa-number="{ min: 1, max: 1000000, maxDecimals: 2}" required></div></div><div class="col-xs-12"><div class="form-group"><label>{{ \'product.description\' | translate }}</label><textarea name="" id="" class="form-control" rows="4" ng-model="record.description" ng-change="changeStatus.markAsChanged()" ng-maxlength="1000"></textarea></div></div></div></div></div></form></section></category-detail>'),$templateCache.put("views/business/product/promotion-detail.html",'<category-detail class="promotion" ng-class="{ \'detail-mode\': isEditPromotionTypeMode() }"><!--HEADER--><section id="promotion-header" class="panel panel-default wrapper"><form name="form"><div class="row"><div class="col-xs-12"><div class="form-group"><label>{{ \'name\' | translate }} *</label><input type="text" class="form-control" ng-model="record.name" ng-change="changeStatus.markAsChanged()" ng-readonly="!isDraft()" ng-maxlength="100" required autofocus></div></div><div class="col-sm-6"><div class="form-group"><label>{{ \'start.date\' | translate }} *</label><div class="input-group ui-datepicker w-full"><input type="text" class="form-control" datepicker-popup="{{ dateFormat }}" ng-model="startDate.date" ng-change="changeStatus.markAsChanged()" is-open="startDate.opened" datepicker-options="dateOptions" close-text="{{ \'close\' | translate }}" ng-readonly="!isDraft()" required> <span class="input-group-addon" ng-click="open($event, startDate)" ng-if="isDraft()"><i class="fa fa-calendar"></i></span></div></div></div><div class="col-sm-6"><div class="form-group"><label>{{ \'end.date\' | translate }} *</label><div class="input-group ui-datepicker w-full"><input type="text" class="form-control" datepicker-popup="{{ dateFormat }}" ng-model="endDate.date" ng-change="changeStatus.markAsChanged()" is-open="endDate.opened" datepicker-options="dateOptions" close-text="{{ \'close\' | translate }}" ng-readonly="!isDraft()" required> <span class="input-group-addon" ng-click="open($event, endDate)" ng-if="isDraft()"><i class="fa fa-calendar"></i></span></div></div></div><div class="col-xs-12"><div class="form-group"><label>{{ \'promotion.apply.for\' | translate }} *</label><input type="text" class="form-control" ng-model="record.applyFor" ng-change="changeStatus.markAsChanged()" ng-readonly="!isDraft()" ng-maxlength="100" required></div></div><div class="col-xs-12"><div class="form-group"><label>{{ \'promotion.description\' | translate }} *</label><textarea name="" id="" class="form-control" rows="4" ng-model="record.description" ng-change="changeStatus.markAsChanged()" ng-readonly="!isDraft()" ng-maxlength="1000" required></textarea></div></div><div class="col-xs-12"><label>{{ \'promotion.detail\' | translate }} *</label><table class="table table-responsive promotion-detail" ng-class="{ \'ng-invalid\': !hasPromotionTypeApplied() }"><tbody><tr ng-repeat="promotionType in promotionTypes | orderBy:sortPromotionType" ng-if="isDraft() || isPromotionTypeApplied(promotionType)"><td><div ng-class="{ \'font-bold text-primary\' : isPromotionTypeApplied(promotionType)}">{{ promotionType.name }}</div><ul class="no-margin visible-xs"><li ng-repeat="detail in promotionType.details" ng-bind-html="getPromotionDetailDisplay(promotionType.type, detail)"></li></ul></td><td class="hidden-xs"><ul class="no-margin"><li ng-repeat="detail in promotionType.details" ng-bind-html="getPromotionDetailDisplay(promotionType.type, detail)"></li></ul></td><td class="text-right no-padder col-action" ng-if="isDraft()"><button class="btn" ng-click="clearPromotionType(promotionType)"><span class="fa fa-lg fa-remove text-danger"></span></button> <button class="btn" ng-click="editPromotionType(promotionType)"><span class="fa fa-lg fa-pencil text-info"></span></button></td></tr></tbody></table></div></div></form></section><!--DETAIL--><div id="promotion-detail"><div class="row title-bar"><div class="col-xs-12 col-sm-9"><h3>{{ currentPromotionType.name | translate }}</h3></div><div class="col-xs-12 col-sm-3 title-btn-bar"><button class="btn btn-warning" ng-click="cancelPromotionTypeEdit()"><span class="fa fa-arrow-left"></span></button> <button class="btn btn-primary" ng-click="applyPromotionTypeEdit()"><span class="fa fa-check"></span></button></div></div><section class="panel panel-default"><form name="form2"><table class="table table-middle no-margin"><thead><tr><th colspan="3" class="text-center">{{ \'promotion.type.condition\' | translate }}</th><th colspan="{{getNumberRewardColumn()}}" class="text-center col-reward">{{ \'promotion.type.reward\' | translate }}</th></tr><tr class="hidden-xs"><td colspan="2">{{ \'promotion.type.condition.product\' | translate }}</td><td class="text-center">{{ \'promotion.type.condition.quantity\' | translate }}</td><td class="text-center col-reward" ng-if="isDisplayRewardProduct()">{{ \'promotion.type.reward.product\' | translate }}</td><td class="text-center col-reward" ng-if="isDisplayRewardQuantity()">{{ \'promotion.type.reward.quantity\' | translate }}</td><td class="text-center col-reward" ng-if="isDisplayRewardPercentage()">%</td></tr></thead><tbody><tr ng-repeat="detail in currentPromtionTypeDetails"><td class="product-photo"><img ng-src="{{getPhotoLink(detail.condition.product.photo)}}" alt class="img-circle img64_64"></td><td><strong>{{ detail.condition.product.name }}</strong><div>{{ detail.condition.product.code }}</div></td><td class="w-sm"><input class="form-control" ng-model="detail.condition.quantity" fcsa-number="{ min: 1, max: 1000000, maxDecimals: 0}" ng-change="markAsChanged()"></td><td ng-if="isDisplayRewardProduct()" class="col-reward w-md"><div class="row padder" ng-if="isDetailUsed(detail)"><div class="col-sm-10 no-padder" ng-if="!detail.textMode"><name-code-category-combobox ng-model="detail.reward.productId" datas="products" required></name-code-category-combobox></div><div class="col-sm-10 no-padder" ng-if="detail.textMode"><input class="form-control" ng-model="detail.reward.productText" ng-if="detail.textMode" required></div><div class="col-sm-2 no-padder"><button class="btn btn-success" ng-click="changeProductMode(detail)"><span class="glyphicon glyphicon-barcode" ng-if="!detail.textMode"></span> <span class="glyphicon glyphicon-font" ng-if="detail.textMode"></span></button></div></div></td><td ng-if="isDisplayRewardQuantity()" class="col-reward w-sm"><input class="form-control" ng-model="detail.reward.quantity" ng-change="markAsChanged()" ng-if="isDetailUsed(detail)" fcsa-number="{ min: 1, maxDecimals: 0}" required></td><td ng-if="isDisplayRewardPercentage()" class="col-reward w-sm"><input class="form-control" ng-model="detail.reward.percentage" ng-change="markAsChanged()" ng-if="isDetailUsed(detail)" fcsa-number="{ min: 1, max: 100, maxDecimals: 2}" required></td></tr></tbody></table></form></section></div></category-detail>'),$templateCache.put("views/business/report/inventory/inventory-report-distributor.html",'<basic-view class="inventory-detail"><div class="row title-bar"><div class="col-xs-6"><h3>{{ title | translate }}</h3></div><div class="col-xs-6 title-btn-bar"><button id="back" class="btn btn-warning" ng-click="back()" ng-if="isUseDistributorFilter()"><span class="fa fa-arrow-left"></span></button> <button type="button" class="btn btn-success" ng-click="export()"><span class="fa fa-file-excel-o"></span></button> <button id="refresh" class="btn btn-info" ng-click="refresh()"><span class="fa fa-refresh"></span></button></div></div><section class="panel panel-default"><div class="wrapper-sm"><div class="row"><div class="col-xs-12 m-b-xs"><strong>{{ \'distributor\' | translate }}:&nbsp;</strong> {{ record.name }}</div><div class="col-xs-12"><strong>{{ \'last.inventory.update.time\' | translate }}:&nbsp;</strong> {{ getLastInventoryUpdateTime() }}</div></div></div></section><section class="panel panel-default table-dynamic"><div class="row"><div class="col-xs-12"><table class="table table-middle no-margin"><thead><tr><th colspan="2" style="border-right: 1px solid #ddd">{{ \'product\' | translate }}</th><th class="text-center w-sm info">{{ \'inventory.quantity\' | translate }}</th><th class="text-center w-sm">{{ \'sold.quantity\' | translate }}</th><th class="text-center w-sm info">{{ \'available.quantity\' | translate }}</th></tr></thead><tbody><tr ng-repeat="product in products"><td colspan="2" class="text-center danger" style="border-right: 1px solid #ddd" ng-if="product.isCategory"><strong>{{ product.name }}</strong></td><td class="info" ng-if="product.isCategory"></td><td ng-if="product.isCategory"></td><td class="info" ng-if="product.isCategory"></td><td class="product-photo" ng-if="!product.isCategory"><img ng-src="{{getPhotoLink(product.photo)}}" alt class="img-circle img64_64"></td><td ng-if="!product.isCategory" style="border-right: 1px solid #ddd"><div><strong>{{ product.name }}</strong></div><div>{{ product.code }}</div></td><td class="info" ng-if="!product.isCategory"><div class="text-right">{{ getQuantityDisplay(product.inventoryResult.inventoryQuantity) }}</div></td><td ng-if="!product.isCategory"><div class="text-right">{{ getQuantityDisplay(product.inventoryResult.soldQuantity) }}</div></td><td class="info" ng-if="!product.isCategory"><div class="text-right">{{ getQuantityDisplay(product.inventoryResult.availableQuantity) }}</div></td></tr></tbody></table></div></div></section></basic-view>'),$templateCache.put("views/business/report/inventory/inventory-report-product.html",'<basic-view><div class="row title-bar"><div class="col-xs-6"><h3>{{ title | translate }}</h3></div><div class="col-xs-6 title-btn-bar"><button id="back" class="btn btn-warning" ng-click="back()"><span class="fa fa-arrow-left"></span></button> <button type="button" class="btn btn-success" ng-click="export()"><span class="fa fa-file-excel-o"></span></button> <button id="refresh" class="btn btn-info" ng-click="refresh()"><span class="fa fa-refresh"></span></button></div></div><section class="panel panel-default"><div class="wrapper-sm"><div class="row"><div class="col-xs-12"><strong>{{ \'product\' | translate }}:&nbsp;</strong> {{ record.name }}</div></div></div></section><section class="panel panel-default table-dynamic"><div class="row"><div class="col-xs-12"><table class="table table-middle no-margin"><thead><tr><th rowspan="2" style="border-right: 1px solid #ddd">{{ \'distributor\' | translate }}</th><th colspan="2" class="text-center w-sm info" style="border-right: 1px solid #ddd">{{ \'last.inventory.update\' | translate }}</th><th rowspan="2" class="text-center w-sm" style="border-right: 1px solid #ddd">{{ \'sold.quantity\' | translate }}</th><th rowspan="2" class="text-center w-sm info">{{ \'available.quantity\' | translate }}</th></tr><tr><th class="text-center w-md info" style="border-right: 1px solid #ddd">{{ \'time\' | translate }}</th><th class="text-center w-sm info" style="border-right: 1px solid #ddd">{{ \'quantity\' | translate }}</th></tr></thead><tbody><tr ng-repeat="distributor in record.distributors"><td style="border-right: 1px solid #ddd"><div>{{ distributor.name }}</div></td><td class="info" style="border-right: 1px solid #ddd"><div class="text-left">{{ getLastInventoryUpdateTime(distributor) }}</div></td><td class="info" style="border-right: 1px solid #ddd"><div class="text-right">{{ getQuantityDisplay(distributor.inventoryResult.inventoryQuantity) }}</div></td><td style="border-right: 1px solid #ddd"><div class="text-right">{{ getQuantityDisplay(distributor.inventoryResult.soldQuantity) }}</div></td><td class="info"><div class="text-right">{{ getQuantityDisplay(distributor.inventoryResult.availableQuantity) }}</div></td></tr></tbody></table></div></div></section></basic-view>'),$templateCache.put("views/business/report/inventory/inventory-report.html",'<basic-view><div class="row title-bar"><div class="col-xs-12"><h3>{{ title | translate }}</h3></div></div><section class="panel panel-default wrapper"><form name="form"><div class="max-w-md margin-auto"><div class="row"><div class="col-sm-12"><div class="form-group"><label>{{ \'inventory.report.type\' | translate }}</label><div class="row m-n"><div class="col-xs-6 no-padder"><label class="ui-radio"><input name="radio1" type="radio" ng-model="filter.reportType" value="distributor"> <span>{{ \'inventory.report.by.distributor\' | translate }}</span></label></div><div class="col-xs-6 no-padder"><label class="ui-radio"><input name="radio1" type="radio" ng-model="filter.reportType" value="product"> <span>{{ \'inventory.report.by.product\' | translate }}</span></label></div></div></div></div><div class="col-xs-12" ng-if="isDisplayDistributor()"><div class="form-group"><label>{{ \'distributor\' | translate }}</label><name-category-combobox placeholder="{{ \'please.select.distributor\' | translate }}" ng-model="filter.distributorId" datas="distributors" required></name-category-combobox></div></div><div class="col-xs-12" ng-if="isDisplayProduct()"><div class="form-group"><label>{{ \'product\' | translate }}</label><name-category-combobox placeholder="{{ \'please.select.product\' | translate }}" ng-model="filter.productId" datas="products" required></name-category-combobox></div></div><div class="col-xs-12 text-right"><button class="btn btn-primary" ng-click="goToReport()">{{ \'report\' | translate }}</button></div></div></div></form></section></basic-view>'),$templateCache.put("views/business/report/performance/performance-report-salesman.html",'<basic-view class="page-profile salesman-performance"><div class="row title-bar"><div class="col-xs-9"><h3>{{ title | translate }}&nbsp;-&nbsp;{{ getMonthDisplay() }}</h3></div><div class="col-xs-3 title-btn-bar"><button id="back" class="btn btn-warning" ng-click="back()"><span class="fa fa-arrow-left"></span></button> <button id="refresh" class="btn btn-info" ng-click="refresh()"><span class="fa fa-refresh"></span></button></div></div><div class="row"><div class="col-md-6"><div class="panel panel-profile"><div class="panel-heading text-center bg-info"><h3 class="ng-binding">{{ record.fullname }}</h3><p>{{ record.distributor.name }}</p></div><div class="list-justified-container"><ul class="list-justified text-center"><li><p class="size-h3"><strong>{{ record.nbOrder.actual | number:0 }}</strong> <span ng-if="record.nbOrder.hasPlan">/&nbsp;{{ record.nbOrder.plan | number:0 }}</span></p><p class="text-muted">{{ \'order\' | translate }} <span ng-if="record.nbOrder.hasPlan"><strong>({{ record.nbOrder.percentage | number:0 }}%)</strong></span></p></li><!--<li>--><!--<p class="size-h3">--><!--<strong>{{ record.quantity.actual | bigNumber }}</strong>--><!--<span ng-if="record.quantity.hasPlan">/&nbsp;{{ record.quantity.plan | bigNumber }}</span>--><!--</p>--><!--<p class="text-muted">--><!--{{ \'quantity\' | translate }}--><!--<span ng-if="record.quantity.hasPlan">--><!--<strong>({{ record.quantity.percentage | number:0 }}%)</strong>--><!--</span>--><!--</p>--><!--</li>--><li><p class="size-h3"><strong>{{ record.productivity.actual | number:0 }}</strong> <span ng-if="record.productivity.hasPlan">/&nbsp;{{ record.productivity.plan | number:0 }}</span></p><p class="text-muted">{{ \'productivity\' | translate }}&nbsp;({{ getProductivityUnit() }}) <span ng-if="record.productivity.hasPlan"><strong>({{ record.productivity.percentage | number:0 }}%)</strong></span></p></li></ul></div></div></div><div class="col-md-6"><div class="panel panel-box"><div class="panel-top bg-success"><div class="divider divider"></div><i class="fa fa-motorcycle size-h1"></i><div class="divider divider"></div></div><div class="list-justified-container"><ul class="list-justified text-center"><li><p class="size-h3"><strong>{{ record.nbVisit.actual | number:0 }}</strong> <span ng-if="record.nbVisit.hasPlan">/&nbsp;{{ record.nbVisit.plan | number:0 }}</span></p><p class="text-muted">{{ \'visit\' | translate }} <span ng-if="record.nbVisit.hasPlan"><strong>({{ record.nbVisit.percentage | number:0 }}%)</strong></span></p></li><li><p class="size-h3">{{ record.nbVisitErrorPosition | number:0 }}</p><p class="text-muted">{{ \'performance.visit.error.position\' | translate }}</p></li><li><p class="size-h3">{{ record.nbVisitHasOrder | number:0 }}</p><p class="text-muted">{{ \'performance.visit.has.order\' | translate }}</p></li></ul></div></div></div><div class="col-lg-12"><div class="row"><div class="col-md-6 col-lg-4"><div class="panel mini-box"><span class="box-icon bg-info"><i class="fa fa-usd"></i></span><div class="box-info"><p class="size-h2"><strong>{{ record.revenue.actual | bigNumber }}</strong> <span ng-if="record.revenue.hasPlan">/&nbsp;{{ record.revenue.plan | bigNumber }}</span></p><p class="text-muted">{{ \'revenue\' | translate }} <span ng-if="record.revenue.hasPlan"><strong>({{ record.revenue.percentage | number:0 }}%)</strong></span></p></div></div></div><div class="col-md-6 col-lg-4"><div class="panel mini-box"><span class="box-icon bg-danger"><i class="fa fa-file-text-o"></i></span><div class="box-info"><p class="size-h2"><strong>{{ record.revenueByOrder.actual | bigNumber }}</strong> <span ng-if="record.revenueByOrder.hasPlan">/&nbsp;{{ record.revenueByOrder.plan | bigNumber }}</span></p><p class="text-muted">{{ \'revenue.by.order\' | translate }} <span ng-if="record.revenueByOrder.hasPlan"><strong>({{ record.revenueByOrder.percentage | number:0 }}%)</strong></span></p></div></div></div><div class="col-md-6 col-lg-4"><div class="panel mini-box"><span class="box-icon bg-success"><i class="fa fa-barcode"></i></span><div class="box-info"><p class="size-h2"><strong>{{ record.skuByOrder.actual | bigNumber }}</strong> <span ng-if="record.skuByOrder.hasPlan">/&nbsp;{{ record.skuByOrder.plan | bigNumber }}</span></p><p class="text-muted">{{ \'sku.by.order\' | translate }} <span ng-if="record.skuByOrder.hasPlan"><strong>({{ record.skuByOrder.percentage | number:0 }}%)</strong></span></p></div></div></div><div class="col-md-6 col-lg-4"><div class="panel mini-box"><span class="box-icon bg-primary"><i class="fa fa-cubes"></i></span><div class="box-info"><p class="size-h2"><strong>{{ record.productivityByOrder.actual | bigNumber }}</strong> <span ng-if="record.productivityByOrder.hasPlan">/&nbsp;{{ record.productivityByOrder.plan | bigNumber }}</span></p><p class="text-muted">{{ \'productivity.by.order\' | translate }}&nbsp;({{ getProductivityUnit() }}) <span ng-if="record.productivityByOrder.hasPlan"><strong>({{ record.productivityByOrder.percentage | number:0 }}%)</strong></span></p></div></div></div><div class="col-md-6 col-lg-4"><div class="panel mini-box"><span class="box-icon bg-warning"><i class="fa fa-group"></i></span><div class="box-info"><p class="size-h2"><strong>{{ record.newCustomer.actual | bigNumber }}</strong> <span ng-if="record.newCustomer.hasPlan">/&nbsp;{{ record.newCustomer.plan | bigNumber }}</span></p><p class="text-muted">{{ \'new.customer\' | translate }} <span ng-if="record.newCustomer.hasPlan"><strong>({{ record.newCustomer.percentage | number:0 }}%)</strong></span></p></div></div></div></div></div><div class="col-md-12" ng-if="isDisplayChart()"><div class="panel panel-default"><div class="panel-heading"><strong><span class="glyphicon glyphicon-th"></span> {{ \'performance.sales.daily\' | translate }}</strong></div><div class="panel-body"><div class="chart-container"><div data-flot-chart data-data="chart.data" data-options="chart.options" class="chart-default" ng-if="isDisplayChart()"></div></div></div></div></div><div class="col-md-12"><div class="panel panel-default"><div class="panel-heading"><strong><span class="glyphicon glyphicon-th"></span> {{ \'performance.sales.product\' | translate }}</strong></div><table class="table"><thead><tr><th>{{ \'product.category\' | translate }}</th><th class="text-right">{{ \'quantity\' | translate }}</th><th class="w-xxs"></th></tr></thead><tbody><tr ng-repeat="productCategorySalesQuantity in record.productCategoriesSalesQuantity"><td><strong>{{ productCategorySalesQuantity.name }}</strong></td><td class="text-right"><strong class="animate-fade-up" ng-if="!isProductCategoryOpened(productCategorySalesQuantity)">{{ productCategorySalesQuantity.quantity }}</strong><table class="table no-margin animate-fade-up" ng-if="isProductCategoryOpened(productCategorySalesQuantity)"><tbody><tr ng-repeat="productSalesQuantity in productCategorySalesQuantity.productsSalesQuantity"><td>{{ productSalesQuantity.name }}</td><td class="text-right">{{ productSalesQuantity.quantity }}</td></tr><tr><td><strong>{{ \'total\' | translate }}</strong></td><td class="text-right"><strong>{{ productCategorySalesQuantity.quantity }}</strong></td></tr></tbody></table></td><td class="text-right no-padder col-action"><button class="btn" ng-click="clickOnProductCategory(productCategorySalesQuantity)"><span class="fa fa-lg fa-caret-right text-info" ng-if="!isProductCategoryOpened(productCategorySalesQuantity)"></span> <span class="fa fa-lg fa-caret-down text-info" ng-if="isProductCategoryOpened(productCategorySalesQuantity)"></span></button></td></tr></tbody></table></div></div></div></basic-view>'),$templateCache.put("views/business/report/performance/performance-report.html",'<basic-view><div class="row title-bar"><div class="col-xs-12"><h3>{{ title | translate }}</h3></div></div><section class="panel panel-default wrapper"><form name="form"><div class="max-w-md margin-auto"><div class="row"><div class="col-xs-12"><div class="form-group"><label>{{ \'month\' | translate }}</label><div class="input-group ui-datepicker"><input type="text" class="form-control" datepicker-mode="\'month\'" datepicker-popup="MM-yyyy" ng-model="date.date" is-open="date.opened" datepicker-options="{startingDay: 1 , minMode:\'month\'}" close-text="{{ \'close\' | translate }}" required> <span class="input-group-addon" ng-click="open($event, date)"><i class="fa fa-calendar"></i></span></div></div></div><div class="col-xs-12" ng-if="isUseDistributorFilter()"><div class="form-group"><label>{{ \'distributor\' | translate }}</label><name-category-combobox placeholder="{{ \'please.select.distributor\' | translate }}" ng-model="filter.distributorId" datas="distributors" ng-change="changeDistributor()" required></name-category-combobox></div></div><div class="col-xs-12" ng-if="isDisplaySalesman()"><div class="form-group"><label>{{ \'salesman\' | translate }}</label><user-combobox placeholder="{{ \'please.select.salesman\' | translate }}" ng-model="filter.salesmanId" datas="salesmen" required></user-combobox></div></div><div class="col-xs-12 text-right"><button class="btn btn-primary" ng-click="goToReport()">{{ \'report\' | translate }}</button></div></div></div></form></section></basic-view>'),$templateCache.put("views/business/report/sales/sales-report-daily.html",'<category-detail class="sales-report-detail"><section class="panel panel-default" ng-if="isDisplayChart()"><div class="panel-body"><div class="chart-container"><div data-flot-chart data-data="chart.data" data-options="chart.options" class="chart-default" ng-if="isDisplayChart()"></div></div></div></section><section class="panel panel-default"><div class="panel-body"><table class="table table-middle table-striped"><thead><tr><th>{{ \'date\' | translate }}</th><th class="text-right">{{ \'revenue\' | translate }}</th><th class="text-right">{{ \'order\' | translate }}</th><th class="text-right">{{ \'customer\' | translate }}</th><th class="text-right">{{ \'salesman\' | translate }}</th></tr></thead><tbody><tr ng-repeat="record in records"><td>{{ record.date | isoDate }}</td><td class="text-right">{{ record.salesResult.revenue | number : 0 }}</td><td class="text-right">{{ record.salesResult.nbOrder | number : 0 }}</td><td class="text-right">{{ record.salesResult.nbCustomer | number : 0 }}</td><td class="text-right">{{ record.salesResult.nbSalesman | number : 0 }}</td></tr><tr><td><strong>{{ \'total\' | translate }}</strong></td><td class="text-right"><strong>{{ total.revenue | number : 0 }}</strong></td><td class="text-right"><strong>{{ total.nbOrder | number : 0 }}</strong></td><td class="text-right"></td><td class="text-right"></td><td class="text-right"></td></tr></tbody></table></div></section></category-detail>'),
$templateCache.put("views/business/report/sales/sales-report-distributor.html",'<category-detail class="sales-report-detail"><section class="panel panel-default" ng-if="isDisplayChart()"><div class="panel-body"><div class="chart-container chart-long-label"><div data-flot-chart data-data="chart.data" data-options="chart.options" class="chart-default" ng-if="isDisplayChart()"></div></div></div></section><section class="panel panel-default"><div class="panel-body"><table class="table table-middle table-striped"><thead><tr><th>{{ \'distributor\' | translate }}</th><th class="text-right">{{ \'revenue\' | translate }}</th><th class="text-right">{{ \'order\' | translate }}</th><th class="text-right">{{ \'customer\' | translate }}</th><th class="text-right">{{ \'salesman\' | translate }}</th></tr></thead><tbody><tr ng-repeat="record in records"><td>{{ record.name }}</td><td class="text-right">{{ record.salesResult.revenue | number : 0 }}</td><td class="text-right">{{ record.salesResult.nbOrder | number : 0 }}</td><td class="text-right">{{ record.salesResult.nbCustomer | number : 0 }}</td><td class="text-right">{{ record.salesResult.nbSalesman | number : 0 }}</td></tr><tr><td><strong>{{ \'total\' | translate }}</strong></td><td class="text-right"><strong>{{ total.revenue | number : 0 }}</strong></td><td class="text-right"><strong>{{ total.nbOrder | number : 0 }}</strong></td><td class="text-right"></td><td class="text-right"></td></tr></tbody></table></div></section></category-detail>'),$templateCache.put("views/business/report/sales/sales-report-product.html",'<category-detail class="sales-report-detail"><section class="panel panel-default" ng-if="isDisplayChart()"><div class="panel-body"><div class="chart-container chart-long-label"><div data-flot-chart data-data="chart.data" data-options="chart.options" class="chart-default"></div></div></div></section><section class="panel panel-default"><div class="panel-body"><table class="table table-middle table-striped"><thead><tr><th>{{ \'product\' | translate }}</th><th class="text-right">{{ \'revenue\' | translate }}</th><th class="text-right">{{ \'order\' | translate }}</th></tr></thead><tbody><tr ng-repeat="record in records"><td>{{ record.name }}</td><td class="text-right">{{ record.salesResult.revenue | number : 0 }}</td><td class="text-right">{{ record.salesResult.nbOrder | number : 0 }}</td></tr><tr><td><strong>{{ \'total\' | translate }}</strong></td><td class="text-right"><strong>{{ total.revenue | number : 0 }}</strong></td><td class="text-right"><strong>{{ total.nbOrder | number : 0 }}</strong></td></tr></tbody></table></div></section></category-detail>'),$templateCache.put("views/business/report/sales/sales-report-salesman.html",'<category-detail class="sales-report-detail"><section class="panel panel-default" ng-if="isDisplayChart()"><div class="panel-body"><div class="chart-container chart-long-label"><div data-flot-chart data-data="chart.data" data-options="chart.options" class="chart-default" ng-if="isDisplayChart()"></div></div></div></section><section class="panel panel-default"><div class="panel-body"><table class="table table-middle table-striped"><thead><tr><th>{{ \'salesman\' | translate }}</th><th class="text-right">{{ \'revenue\' | translate }}</th><th class="text-right">{{ \'order\' | translate }}</th></tr></thead><tbody><tr ng-repeat="record in records"><td>{{ record.fullname }}</td><td class="text-right">{{ record.salesResult.revenue | number : 0 }}</td><td class="text-right">{{ record.salesResult.nbOrder | number : 0 }}</td></tr><tr><td><strong>{{ \'total\' | translate }}</strong></td><td class="text-right"><strong>{{ total.revenue | number : 0 }}</strong></td><td class="text-right"><strong>{{ total.nbOrder | number : 0 }}</strong></td></tr></tbody></table></div></section></category-detail>'),$templateCache.put("views/business/report/sales/sales-report.html",'<basic-view><div class="row title-bar"><div class="col-xs-12"><h3>{{ title | translate }}</h3></div></div><section class="panel panel-default wrapper"><form name="form"><div class="max-w-md margin-auto"><div class="row"><div class="col-xs-12"><div class="form-group"><label>{{ \'month\' | translate }}</label><div class="input-group ui-datepicker"><input type="text" class="form-control" datepicker-mode="\'month\'" datepicker-popup="MM-yyyy" ng-model="date.date" is-open="date.opened" datepicker-options="{startingDay: 1 , minMode:\'month\'}" close-text="{{ \'close\' | translate }}" required> <span class="input-group-addon" ng-click="open($event, date)"><i class="fa fa-calendar"></i></span></div></div></div><div class="col-sm-12"><div class="form-group"><label>{{ \'sales.report.type\' | translate }}</label><div class="row m-n"><div class="col-sm-3 col-xs-6 no-padder"><label class="ui-radio"><input name="radio1" type="radio" ng-model="filter.reportType" value="daily"> <span>{{ \'sales.report.daily\' | translate }}</span></label></div><div class="col-sm-3 col-xs-6 no-padder" ng-if="isUseDistributorFilter()"><label class="ui-radio"><input name="radio1" type="radio" ng-model="filter.reportType" value="distributor"> <span>{{ \'sales.report.by.distributor\' | translate }}</span></label></div><div class="col-sm-3 col-xs-6 no-padder"><label class="ui-radio"><input name="radio1" type="radio" ng-model="filter.reportType" value="product"> <span>{{ \'sales.report.by.product\' | translate }}</span></label></div><div class="col-sm-3 col-xs-6 no-padder"><label class="ui-radio"><input name="radio1" type="radio" ng-model="filter.reportType" value="salesman"> <span>{{ \'sales.report.by.salesman\' | translate }}</span></label></div></div></div></div><div class="col-xs-12" ng-if="isDisplayDistributor()"><div class="form-group"><label>{{ \'distributor\' | translate }}</label><name-category-combobox placeholder="{{ \'please.select.distributor\' | translate }}" ng-model="filter.distributorId" datas="distributors" required></name-category-combobox></div></div><div class="col-xs-12" ng-if="isDisplayDistributorAll()"><div class="form-group"><label>{{ \'distributor\' | translate }}</label><name-category-combobox ng-model="filter.distributorWithAllId" datas="distributorsWithAll"></name-category-combobox></div></div><div class="col-xs-12" ng-if="isDisplayProductCategory()"><div class="form-group"><label>{{ \'product.category\' | translate }}</label><name-category-combobox ng-model="filter.productCategoryId" datas="productCategories" required></name-category-combobox></div></div><div class="col-xs-12 text-right"><button class="btn btn-primary" ng-click="goToReport()">{{ \'report\' | translate }}</button></div></div></div></form></section></basic-view>'),$templateCache.put("views/business/report/survey/survey-report-detail.html",'<basic-view><div><div class="row title-bar"><div class="col-xs-9"><h3>{{ record.name }}</h3></div><div class="col-xs-3 title-btn-bar"><button class="btn btn-warning" ng-click="back()"><span class="fa fa-arrow-left"></span></button></div></div><div class="row"><div class="col-sm-12 col-md-6 col-lg-4" ng-repeat="question in record.questions track by $index"><section class="panel panel-default"><div class="panel-heading" style="min-height: 51px"><h3 class="panel-title">{{ question.name }}</h3></div><div class="panel-body"><div flot-chart data="question.data" options="question.option" style="width: 100%; height: 150px"></div></div></section></div></div></div></basic-view>'),$templateCache.put("views/business/report/survey/survey-report.html",'<basic-view><div><div class="row title-bar"><div class="col-xs-9"><h3>{{ title | translate }}</h3></div><div class="col-xs-3 title-btn-bar"><button type="button" class="btn btn-info" ng-click="reloadData()"><span class="fa fa-refresh"></span></button></div></div><section class="panel panel-default table-dynamic"><table class="table table-middle"><thead class="hidden-xs"><tr><th>{{ \'name\' | translate }}</th><th class="text-center">{{ \'start.date\' | translate }}</th><th class="text-center">{{ \'end.date\' | translate }}</th><th class="text-center">{{ \'status\' | translate }}</th><th class="w-sm"></th></tr></thead><tbody><tr ng-repeat="record in records"><td>{{ record.name }}</td><td class="text-center">{{ record.startDate | isoDate }}</td><td class="text-center">{{ record.endDate | isoDate }}</td><td class="text-center"><span class="label label-danger" ng-if="record.dateStatus == 0">{{ \'survey.report.not.process\' | translate }}</span> <span class="label label-warning" ng-if="record.dateStatus == 1">{{ \'survey.report.status.processing\' | translate }}</span> <span class="label label-info" ng-if="record.dateStatus == 2">{{ \'survey.report.status.processed\' | translate }}</span></td><td class="text-right no-padder col-action"><button class="btn" ng-click="export(record)"><span class="fa fa-lg fa-file-excel-o text-primary"></span></button> <button class="btn" ng-click="goToReport(record)"><span class="fa fa-lg fa-pie-chart text-info"></span></button></td></tr><tr ng-if="isEmpty()"><td colspan="{{ 2 + columns.length }}">{{ \'no.data\' | translate }}</td></tr></tbody></table><div class="wrapper-sm pagination-container"><div class="row"><div class="col-xs-12"><hr class="m-b-sm m-t-none m-l-n-sm m-r-n-sm"></div><div class="col-xs-12 text-right"><pagination class="pagination pagination-sm pagination-right m-n" boundary-links="true" total-items="pagingData.count" max-size="pagingData.pagingMaxSize" items-per-page="pagingData.itemsPerPage" ng-model="pagingData.currentPage" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" ng-change="pageChange()"></pagination></div></div></div></section></div></basic-view>'),$templateCache.put("views/business/report/visit/visit-report-daily.html",'<category-detail class="sales-report-detail"><section class="panel panel-default" ng-if="isDisplayChart()"><div class="panel-body"><div class="chart-container"><div data-flot-chart data-data="chart.data" data-options="chart.options" class="chart-default" ng-if="isDisplayChart()"></div></div></div></section><section class="panel panel-default"><div class="panel-body"><table class="table table-middle table-striped"><thead><tr><th>{{ \'date\' | translate }}</th><th class="text-right">{{ \'visit\' | translate }}</th><th class="text-right">{{ \'visit.error.duration\' | translate }}</th><th class="text-right">{{ \'visit.error.position\' | translate }}</th><th class="text-right">{{ \'customer\' | translate }}</th><th class="text-right">{{ \'salesman\' | translate }}</th></tr></thead><tbody><tr ng-repeat="record in records"><td>{{ record.date | isoDate }}</td><td class="text-right">{{ record.visitResult.nbVisit | number : 0 }}</td><td class="text-right">{{ record.visitResult.nbVisitErrorDuration | number : 0 }}</td><td class="text-right">{{ record.visitResult.nbVisitErrorPosition | number : 0 }}</td><td class="text-right">{{ record.visitResult.nbCustomer | number : 0 }}</td><td class="text-right">{{ record.visitResult.nbSalesman | number : 0 }}</td></tr><tr><td><strong>{{ \'total\' | translate }}</strong></td><td class="text-right"><strong>{{ total.nbVisit | number : 0 }}</strong></td><td class="text-right"><strong>{{ total.nbVisitErrorDuration | number : 0 }}</strong></td><td class="text-right"><strong>{{ total.nbVisitErrorPosition | number : 0 }}</strong></td><td class="text-right"></td><td class="text-right"></td><td class="text-right"></td></tr></tbody></table></div></section></category-detail>'),$templateCache.put("views/business/report/visit/visit-report-distributor.html",'<category-detail class="sales-report-detail"><section class="panel panel-default" ng-if="isDisplayChart()"><div class="panel-body"><div class="chart-container chart-long-label"><div data-flot-chart data-data="chart.data" data-options="chart.options" class="chart-default"></div></div></div></section><section class="panel panel-default"><div class="panel-body"><table class="table table-middle table-striped"><thead><tr><th>{{ \'distributor\' | translate }}</th><th class="text-right">{{ \'visit\' | translate }}</th><th class="text-right">{{ \'visit.error.duration\' | translate }}</th><th class="text-right">{{ \'visit.error.position\' | translate }}</th><th class="text-right">{{ \'customer\' | translate }}</th><th class="text-right">{{ \'salesman\' | translate }}</th></tr></thead><tbody><tr ng-repeat="record in records"><td>{{ record.name }}</td><td class="text-right">{{ record.visitResult.nbVisit | number : 0 }}</td><td class="text-right">{{ record.visitResult.nbVisitErrorDuration | number : 0 }}</td><td class="text-right">{{ record.visitResult.nbVisitErrorPosition | number : 0 }}</td><td class="text-right">{{ record.visitResult.nbCustomer | number : 0 }}</td><td class="text-right">{{ record.visitResult.nbSalesman | number : 0 }}</td></tr><tr><td><strong>{{ \'total\' | translate }}</strong></td><td class="text-right"><strong>{{ total.nbVisit | number : 0 }}</strong></td><td class="text-right"><strong>{{ total.nbVisitErrorDuration | number : 0 }}</strong></td><td class="text-right"><strong>{{ total.nbVisitErrorPosition | number : 0 }}</strong></td><td class="text-right"></td><td class="text-right"></td></tr></tbody></table></div></section></category-detail>'),$templateCache.put("views/business/report/visit/visit-report-salesman.html",'<category-detail class="sales-report-detail"><section class="panel panel-default" ng-if="isDisplayChart()"><div class="panel-body"><div class="chart-container chart-long-label"><div data-flot-chart data-data="chart.data" data-options="chart.options" class="chart-default"></div></div></div></section><section class="panel panel-default"><div class="panel-body"><table class="table table-middle table-striped"><thead><tr><th>{{ \'salesman\' | translate }}</th><th class="text-right">{{ \'visit\' | translate }}</th><th class="text-right">{{ \'visit.error.duration\' | translate }}</th><th class="text-right">{{ \'visit.error.position\' | translate }}</th></tr></thead><tbody><tr ng-repeat="record in records"><td>{{ record.fullname }}</td><td class="text-right">{{ record.visitResult.nbVisit | number : 0 }}</td><td class="text-right">{{ record.visitResult.nbVisitErrorDuration | number : 0 }}</td><td class="text-right">{{ record.visitResult.nbVisitErrorPosition | number : 0 }}</td></tr><tr><td><strong>{{ \'total\' | translate }}</strong></td><td class="text-right"><strong>{{ total.nbVisit | number : 0 }}</strong></td><td class="text-right"><strong>{{ total.nbVisitErrorDuration | number : 0 }}</strong></td><td class="text-right"><strong>{{ total.nbVisitErrorPosition | number : 0 }}</strong></td></tr></tbody></table></div></section></category-detail>'),$templateCache.put("views/business/report/visit/visit-report.html",'<basic-view><div class="row title-bar"><div class="col-xs-12"><h3>{{ title | translate }}</h3></div></div><section class="panel panel-default wrapper"><form name="form"><div class="max-w-md margin-auto"><div class="row"><div class="col-xs-12"><div class="form-group"><label>{{ \'month\' | translate }}</label><div class="input-group ui-datepicker"><input type="text" class="form-control" datepicker-mode="\'month\'" datepicker-popup="MM-yyyy" ng-model="date.date" is-open="date.opened" datepicker-options="{startingDay: 1 , minMode:\'month\'}" close-text="{{ \'close\' | translate }}" required> <span class="input-group-addon" ng-click="open($event, date)"><i class="fa fa-calendar"></i></span></div></div></div><div class="col-sm-12"><div class="form-group"><label>{{ \'visit.report.type\' | translate }}</label><div class="row m-n"><div class="col-sm-4 col-xs-6 no-padder"><label class="ui-radio"><input name="radio1" type="radio" ng-model="filter.reportType" value="daily"> <span>{{ \'visit.report.daily\' | translate }}</span></label></div><div class="col-sm-4 col-xs-6 no-padder" ng-if="isUseDistributorFilter()"><label class="ui-radio"><input name="radio1" type="radio" ng-model="filter.reportType" value="distributor"> <span>{{ \'visit.report.by.distributor\' | translate }}</span></label></div><div class="col-sm-4 col-xs-6 no-padder"><label class="ui-radio"><input name="radio1" type="radio" ng-model="filter.reportType" value="salesman"> <span>{{ \'visit.report.by.salesman\' | translate }}</span></label></div></div></div></div><div class="col-xs-12" ng-if="isDisplayDistributor()"><div class="form-group"><label>{{ \'distributor\' | translate }}</label><name-category-combobox placeholder="{{ \'please.select.distributor\' | translate }}" ng-model="filter.distributorId" datas="distributors" required></name-category-combobox></div></div><div class="col-xs-12" ng-if="isDisplayDistributorAll()"><div class="form-group"><label>{{ \'distributor\' | translate }}</label><name-category-combobox ng-model="filter.distributorWithAllId" datas="distributorsWithAll"></name-category-combobox></div></div><div class="col-xs-12 text-right"><button class="btn btn-primary" ng-click="goToReport()">{{ \'report\' | translate }}</button></div></div></div></form></section></basic-view>'),$templateCache.put("views/business/schedule/customer-schedule-single.html",'<basic-view class="customer-schedule"><div class="row title-bar"><div class="col-xs-6"><h3>{{ title | translate }}</h3></div><div class="col-xs-6 title-btn-bar"><button class="btn btn-warning" ng-click="back()" ng-if="!changeStatus.isChanged"><span class="fa fa-arrow-left"></span></button> <button class="btn btn-info" ng-click="refresh()" ng-if="changeStatus.isChanged"><span class="fa fa-refresh"></span></button> <button class="btn btn-success" ng-click="save()" ng-if="changeStatus.isChanged"><span class="fa fa-save"></span></button></div></div><section class="panel panel-default"><table class="table table-middle"><thead><tr><th class="customer">{{ \'customer\' | translate }}</th><th class="route">{{ \'route\' | translate }}</th><th class="schedule-item day monday">{{ \'monday.short\' | translate }}</th><th class="schedule-item day">{{ \'tuesday.short\' | translate }}</th><th class="schedule-item day">{{ \'wednesday.short\' | translate }}</th><th class="schedule-item day">{{ \'thursday.short\' | translate }}</th><th class="schedule-item day">{{ \'friday.short\' | translate }}</th><th class="schedule-item day">{{ \'saturday.short\' | translate }}</th><th class="schedule-item day">{{ \'sunday.short\' | translate }}</th><th class="schedule-item week" ng-class="{ \'first-week\' : $first }" ng-repeat="week in weeks">{{ week.header }}</th></tr></thead><tbody><tr ng-class="{ \'no-schedule\' : record.schedule.routeId == null }"><td class="customer">{{ record.name }}</td><td class="route"><name-category-combobox ng-model="record.schedule.routeId" ng-change="editRoute(record)" datas="routes"></name-category-combobox></td><td class="schedule-item day monday"><div class="row"><div class="col-xs-12 text-center"><i-check ng-model="record.schedule.item.monday" ng-change="changeStatus.markAsChanged()"></i-check></div></div></td><td class="schedule-item day"><div class="row"><div class="col-xs-12 text-center"><i-check ng-model="record.schedule.item.tuesday" ng-change="changeStatus.markAsChanged()"></i-check></div></div></td><td class="schedule-item day"><div class="row"><div class="col-xs-12 text-center"><i-check ng-model="record.schedule.item.wednesday" ng-change="changeStatus.markAsChanged()"></i-check></div></div></td><td class="schedule-item day"><div class="row"><div class="col-xs-12 text-center"><i-check ng-model="record.schedule.item.thursday" ng-change="changeStatus.markAsChanged()"></i-check></div></div></td><td class="schedule-item day"><div class="row"><div class="col-xs-12 text-center"><i-check ng-model="record.schedule.item.friday" ng-change="changeStatus.markAsChanged()"></i-check></div></div></td><td class="schedule-item day"><div class="row"><div class="col-xs-12 text-center"><i-check ng-model="record.schedule.item.saturday" ng-change="changeStatus.markAsChanged()"></i-check></div></div></td><td class="schedule-item day"><div class="row"><div class="col-xs-12 text-center"><i-check ng-model="record.schedule.item.sunday" ng-change="changeStatus.markAsChanged()"></i-check></div></div></td><td class="schedule-item week" ng-class="{ \'first-week\' : $first }" ng-repeat="week in weeks"><div class="row"><div class="col-xs-12 text-center"><i-check ng-model="record.schedule.item.weeksConverted[week.index - 1].selected" ng-change="changeStatus.markAsChanged()"></i-check></div></div></td></tr></tbody></table></section></basic-view>'),$templateCache.put("views/business/schedule/customer-schedule.html",'<basic-view class="customer-schedule" ng-class="{ \'must-select-distributor\': mustSelectDistributor() }"><div class="row title-bar"><div class="col-xs-6"><h3>{{ title | translate }}</h3></div><div class="col-xs-6 title-btn-bar"><button class="btn btn-warning" ng-click="refresh()" ng-if="changeStatus.isChanged"><span class="fa fa-remove"></span></button> <button type="button" class="btn btn-success" ng-click="goToImport()"><span class="fa fa-file-excel-o"></span></button> <button class="btn btn-success" ng-click="save()" ng-if="changeStatus.isChanged"><span class="fa fa-save"></span></button></div></div><section class="panel panel-default"><div class="wrapper-sm no-padder-bottom"><div class="row"><div class="col-sm-6 col-xs-12 m-b-sm" ng-if="isUseDistributorFilter()"><label>{{ \'distributor\' | translate }}</label><name-category-combobox ng-model="filter.distributorId" datas="distributors" ng-change="distributorFilterChange()" ng-readonly="changeStatus.isChanged" placeholder="{{ \'please.select.distributor\' | translate }}"></name-category-combobox></div><div class="col-sm-6 col-xs-12 m-b-sm hide-when-must-select-distributor"><label>{{ \'route\' | translate }}</label><name-category-combobox ng-model="filter.routeId" datas="routesFilter" ng-change="filterChange()" ng-readonly="changeStatus.isChanged"></name-category-combobox></div><div class="col-sm-6 col-xs-12 m-b-sm hide-when-must-select-distributor"><label>{{ \'customer\' | translate }}</label><search-box ng-model="filter.searchText" ng-change="searchFilterChange()" ng-disabled="changeStatus.isChanged" placeholder="{{ \'search\' | translate }}"></search-box></div><div class="col-sm-3 col-xs-12 m-b-sm hide-when-must-select-distributor"><label>{{ \'customer.schedule.day.of.week\' | translate }}</label><name-category-combobox ng-model="filter.day" datas="dayOfWeeks" ng-change="filterChange()" ng-readonly="changeStatus.isChanged"></name-category-combobox></div><div class="col-sm-3 col-xs-12 m-b-sm hide-when-must-select-distributor"><label>{{ \'customer.schedule.items.per.page\' | translate }}</label><name-category-combobox ng-model="filter.itemsPerPage" datas="itemsPerPageOptions" ng-change="filterChange()" ng-readonly="changeStatus.isChanged"></name-category-combobox></div></div></div><table class="table table-middle table-border-top hide-when-must-select-distributor"><thead><tr><th class="customer">{{ \'customer\' | translate }}</th><th class="route">{{ \'route\' | translate }}</th><th class="schedule-item day monday">{{ \'monday.short\' | translate }}</th><th class="schedule-item day">{{ \'tuesday.short\' | translate }}</th><th class="schedule-item day">{{ \'wednesday.short\' | translate }}</th><th class="schedule-item day">{{ \'thursday.short\' | translate }}</th><th class="schedule-item day">{{ \'friday.short\' | translate }}</th><th class="schedule-item day">{{ \'saturday.short\' | translate }}</th><th class="schedule-item day">{{ \'sunday.short\' | translate }}</th><th class="schedule-item week" ng-class="{ \'first-week\' : $first }" ng-repeat="week in weeks">{{ week.header }}</th></tr></thead><tbody><tr ng-repeat="record in records" ng-class="{ \'no-schedule\' : record.schedule.routeId == null }"><td class="customer">{{ record.name }}</td><td class="route"><name-category-combobox ng-model="record.schedule.routeId" ng-change="editRoute(record)" datas="routes"></name-category-combobox></td><td class="schedule-item day monday"><div class="row"><div class="col-xs-12 text-center"><i-check ng-model="record.schedule.item.monday" ng-change="changeStatus.markAsChanged()"></i-check></div></div></td><td class="schedule-item day"><div class="row"><div class="col-xs-12 text-center"><i-check ng-model="record.schedule.item.tuesday" ng-change="changeStatus.markAsChanged()"></i-check></div></div></td><td class="schedule-item day"><div class="row"><div class="col-xs-12 text-center"><i-check ng-model="record.schedule.item.wednesday" ng-change="changeStatus.markAsChanged()"></i-check></div></div></td><td class="schedule-item day"><div class="row"><div class="col-xs-12 text-center"><i-check ng-model="record.schedule.item.thursday" ng-change="changeStatus.markAsChanged()"></i-check></div></div></td><td class="schedule-item day"><div class="row"><div class="col-xs-12 text-center"><i-check ng-model="record.schedule.item.friday" ng-change="changeStatus.markAsChanged()"></i-check></div></div></td><td class="schedule-item day"><div class="row"><div class="col-xs-12 text-center"><i-check ng-model="record.schedule.item.saturday" ng-change="changeStatus.markAsChanged()"></i-check></div></div></td><td class="schedule-item day"><div class="row"><div class="col-xs-12 text-center"><i-check ng-model="record.schedule.item.sunday" ng-change="changeStatus.markAsChanged()"></i-check></div></div></td><td class="schedule-item week" ng-class="{ \'first-week\' : $first }" ng-repeat="week in weeks"><div class="row"><div class="col-xs-12 text-center"><i-check ng-model="record.schedule.item.weeksConverted[week.index - 1].selected" ng-change="changeStatus.markAsChanged()"></i-check></div></div></td></tr><tr ng-if="isEmpty()"><td colspan="{{ 9 + weeks.length }}">{{ \'no.data\' | translate }}</td></tr></tbody></table><div class="wrapper-sm pagination-container hide-when-must-select-distributor" ng-hide="changeStatus.isChanged"><div class="row"><div class="col-xs-12"><hr class="m-b-sm m-t-none m-l-n-sm m-r-n-sm"></div><div class="col-xs-12 text-right"><pagination class="pagination pagination-sm pagination-right m-n" boundary-links="true" total-items="pagingData.count" max-size="pagingData.pagingMaxSize" items-per-page="pagingData.itemsPerPage" ng-model="pagingData.currentPage" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" ng-change="pageChange()"></pagination></div></div></div></section></basic-view>'),$templateCache.put("views/business/schedule/route-detail.html",'<category-detail><section class="panel panel-default wrapper"><form name="form"><div class="max-w-md margin-auto"><div class="row"><div class="col-xs-12" ng-if="isUseDistributorFilter()"><div class="form-group"><label>{{ \'distributor\' | translate }} *</label><name-category-combobox ng-model="record.distributorId" datas="distributors" ng-change="changeDistributor()" ng-readonly="!isDraft()" readonly-name="record.distributor.name" required></name-category-combobox></div></div><div class="col-xs-12"><div class="form-group"><label>{{ \'name\' | translate }} *</label><input type="text" class="form-control" ng-model="record.name" ng-change="changeStatus.markAsChanged()" ng-maxlength="50" required autofocus></div></div><div class="col-xs-12" ng-hide="isDraft()"><div class="form-group"><label>{{ \'salesman\' | translate }}</label><user-combobox ng-model="record.salesmanId" datas="salesmen" ng-change="changeStatus.markAsChanged()"></user-combobox></div></div></div></div></form></section></category-detail>'),$templateCache.put("views/business/super-admin/client-detail.html",'<category-detail class="no-enable use-map calendar-config"><form name="form"><div class="row"><div class="col-sm-6"><section class="panel panel-default"><div class="panel-heading"><strong>{{ \'client.info\' | translate }}</strong></div><div class="panel-body"><div class="row"><div class="col-lg-6"><div class="form-group"><label>{{ \'name\' | translate }} *</label><input type="text" class="form-control" ng-model="record.name" ng-change="changeStatus.markAsChanged()" required autofocus></div></div><div class="col-lg-6"><div class="form-group"><label>{{ \'code\' | translate }} *</label><input type="text" class="form-control" ng-model="record.code" ng-change="changeStatus.markAsChanged()" required></div></div><div class="col-lg-12 m-b" ng-if="isEdit()"><button class="btn btn-primary w-full" ng-click="createSampleMasterData()">{{ \'Create Sample Master Data\' | translate }}</button></div><div class="col-lg-12 m-b" ng-if="isEdit()"><button class="btn btn-primary w-full" ng-click="goToImport()">{{ \'Import Master Data\' | translate }}</button></div><div class="col-lg-12" ng-if="isEdit()"><button class="btn btn-primary w-full" ng-click="generateVisitAndOrder()">{{ \'Generate Sample Visit And Order\' | translate }}</button></div></div></div></section><section class="panel panel-default"><div class="panel-heading"><strong>{{ \'module\' | translate }}</strong></div><div class="panel-body"><div class="row"><div class="col-xs-12"><table class="table table-bordered table-responsive table-middle"><tbody><tr><td>{{ \'promotion\' | translate }}</td><td class="col-checkbox"><i-check ng-model="record.clientConfig.usePromotion" ng-change="changeStatus.markAsChanged()"></i-check></td></tr><tr><td>{{ \'survey\' | translate }}</td><td class="col-checkbox"><i-check ng-model="record.clientConfig.useSurvey" ng-change="changeStatus.markAsChanged()"></i-check></td></tr><tr><td>{{ \'inventory\' | translate }}</td><td class="col-checkbox"><i-check ng-model="record.clientConfig.useInventory" ng-change="changeStatus.markAsChanged()"></i-check></td></tr><tr><td>{{ \'check.in\' | translate }}</td><td class="col-checkbox"><i-check ng-model="record.clientConfig.useCheckIn" ng-change="changeStatus.markAsChanged()"></i-check></td></tr><tr><td>{{ \'exchange.return\' | translate }}</td><td class="col-checkbox"><i-check ng-model="record.clientConfig.useExchangeReturn" ng-change="changeStatus.markAsChanged()"></i-check></td></tr></tbody></table></div><div class="col-xs-12" ng-if="record.clientConfig.useInventory"><div class="form-group"><label>{{ \'client.config.number.day.inventory.expire\' | translate }} *</label><input class="form-control" ng-model="record.clientConfig.numberDayInventoryExpire" ng-change="changeStatus.markAsChanged()" fcsa-number="{ min: 1, maxDecimals: 0}" required></div></div></div></div></section></div><div class="col-sm-6"><section class="panel panel-default"><div class="panel-heading"><strong>{{ \'client.config\' | translate }}</strong></div><div class="panel-body"><div class="row"><div class="col-xs-12"><div class="form-group"><label>{{ \'client.config.visit.duration.kpi.minute\' | translate }} *</label><input class="form-control" ng-model="record.clientConfig.visitDurationKPIinMinute" ng-change="changeStatus.markAsChanged()" fcsa-number="{ min: 1, maxDecimals: 0}" required></div></div><div class="col-xs-12"><div class="form-group"><label>{{ \'client.config.visit.distance.kpi.km\' | translate }} *</label><input class="form-control" ng-model="record.clientConfig.visitDistanceKPI" ng-change="changeStatus.markAsChanged()" fcsa-number="{ min: 0.1, maxDecimals: 2}" required></div></div><div class="col-xs-12"><div class="form-group"><label>{{ \'client.config.productivity.unit\' | translate }} *</label><input type="text" class="form-control" ng-model="record.clientConfig.productivityUnit" ng-change="changeStatus.markAsChanged()" required></div></div><div class="col-xs-12"><div class="form-group"><label>{{ \'client.config.can.edit.customer.location\' | translate }} *</label><div class="switch-form-control no-select"><label class="switch"><input type="checkbox" checked="checked" ng-model="record.clientConfig.canEditCustomerLocation" ng-change="changeStatus.markAsChanged()"> <i></i></label></div></div></div><div class="col-xs-12"><label>{{ \'client.config.default.location\' | translate }} *</label><location-selector ng-model="record.clientConfig.location" ng-change="changeStatus.markAsChanged()" required></location-selector></div></div></div></section></div><div class="col-sm-12"><section class="panel panel-default"><div class="panel-heading"><strong>{{ \'calendar.config\' | translate }}</strong></div><div class="panel-body"><div class="row"><div class="col-sm-6"><table class="table table-bordered table-responsive table-middle"><thead><tr><th colspan="2">{{ \'calendar.config.working.days\' | translate }}</th></tr></thead><tbody><tr><td>{{ \'monday\' | translate }}</td><td class="col-checkbox"><i-check ng-model="record.calendarConfig.monday" ng-change="changeStatus.markAsChanged()"></i-check></td></tr><tr><td>{{ \'tuesday\' | translate }}</td><td class="col-checkbox"><i-check ng-model="record.calendarConfig.tuesday" ng-change="changeStatus.markAsChanged()"></i-check></td></tr><tr><td>{{ \'wednesday\' | translate }}</td><td class="col-checkbox"><i-check ng-model="record.calendarConfig.wednesday" ng-change="changeStatus.markAsChanged()"></i-check></td></tr><tr><td>{{ \'thursday\' | translate }}</td><td class="col-checkbox"><i-check ng-model="record.calendarConfig.thursday" ng-change="changeStatus.markAsChanged()"></i-check></td></tr><tr><td>{{ \'friday\' | translate }}</td><td class="col-checkbox"><i-check ng-model="record.calendarConfig.friday" ng-change="changeStatus.markAsChanged()"></i-check></td></tr><tr><td>{{ \'saturday\' | translate }}</td><td class="col-checkbox"><i-check ng-model="record.calendarConfig.saturday" ng-change="changeStatus.markAsChanged()"></i-check></td></tr><tr><td>{{ \'sunday\' | translate }}</td><td class="col-checkbox"><i-check ng-model="record.calendarConfig.sunday" ng-change="changeStatus.markAsChanged()"></i-check></td></tr></tbody></table></div><div class="col-sm-6"><table class="table table-bordered table-responsive table-middle"><thead><tr><th>{{ \'calendar.config.holidays\' | translate }}</th><th class="col-checkbox"><a href="javascript:void(0)" class="btn-icon btn-icon-xs btn-primary" ng-click="addHoliday()"><i class="fa fa-plus"></i></a></th></tr></thead><tbody><tr><td colspan="2" ng-if="holidaysEmpty()">{{ \'no.data\' | translate }}</td></tr><tr ng-repeat="holidayDate in record.calendarConfig.holidayDates"><td><div class="input-group ui-datepicker"><input type="text" class="form-control" datepicker-popup="{{ dateFormat }}" ng-model="holidayDate.date" ng-change="changeStatus.markAsChanged()" is-open="holidayDate.opened" datepicker-options="dateOptions" close-text="{{ \'close\' | translate }}" required> <span class="input-group-addon" ng-click="open($event, holidayDate)"><i class="fa fa-calendar"></i></span></div></td><td><a href="javascript:void(0)" class="btn-icon btn-icon-xs btn-danger" ng-click="removeHoliday(holidayDate)"><i class="fa fa-remove"></i></a></td></tr></tbody></table></div></div></div></section></div></div></form></category-detail>'),
$templateCache.put("views/business/super-admin/system-action.html",'<basic-view><section class="panel panel-default wrapper"><form name="form"><div class="max-w-md margin-auto"><div class="row"><div class="col-xs-12 m-b"><button class="btn btn-primary w-full" ng-click="resetCache()">{{ \'reset.cache\' | translate }}</button></div><div class="col-xs-12"><button class="btn btn-primary w-full" ng-click="generateBigData()">Generate Big Data</button></div></div></div></form></section></basic-view>'),$templateCache.put("views/business/super-admin/system-config.html",'<category-detail class="no-back no-enable"><section class="panel panel-default wrapper"><form name="form"><div class="row"><div class="col-md-3 col-sm-12"><div class="form-group"><label>{{ \'system.config.default.product.photo\' | translate }} *</label><single-image ng-model="record.productPhoto" size-type="standard" ng-change="changeStatus.markAsChanged()" required></single-image></div></div><div class="col-md-9 col-sm-12"><div class="row"><div class="col-sm-6 col-xs-12"><div class="form-group"><label>{{ \'system.config.default.date.format\' | translate }} *</label><input type="text" class="form-control" ng-model="record.dateFormat" ng-change="changeStatus.markAsChanged()" required autofocus></div></div></div><div class="row"><div class="col-sm-6 col-xs-12"><div class="form-group"><label>{{ \'system.config.first.date.week\' | translate }} *</label><input class="form-control" ng-model="record.firstDayOfWeek" ng-change="changeStatus.markAsChanged()" fcsa-number="{ min: 0, max: 6, maxDecimals: 0}" required></div></div><div class="col-sm-6 col-xs-12"><div class="form-group"><label>{{ \'system.config.minimal.days.in.first.week\' | translate }} *</label><input class="form-control" ng-model="record.minimalDaysInFirstWeek" ng-change="changeStatus.markAsChanged()" fcsa-number="{ min: 1, max: 7, maxDecimals: 0}" required></div></div><div class="col-sm-6 col-xs-12"><div class="form-group"><label>{{ \'system.config.complex.schedule\' | translate }} *</label><div class="switch-form-control no-select"><label class="switch"><input type="checkbox" checked="checked" ng-model="record.complexSchedule" ng-change="changeStatus.markAsChanged()"> <i></i></label></div></div></div><div class="col-sm-6 col-xs-12"><div class="form-group"><label>{{ \'system.config.number.week.of.frequency\' | translate }} *</label><input class="form-control" ng-model="record.numberWeekOfFrequency" ng-change="changeStatus.markAsChanged()" fcsa-number="{ min: 1, max: 4, maxDecimals: 0}" required></div></div><div class="col-sm-6 col-xs-12"><div class="form-group"><label>{{ \'system.config.order.date.type\' | translate }} *</label><name-category-combobox ng-model="record.orderDateType" datas="orderDateTypes" ng-change="changeStatus.markAsChanged()()" required></name-category-combobox></div></div><div class="col-sm-6 col-xs-12"><div class="form-group"><label>{{ \'system.config.number.day.order.pending.expire\' | translate }} *</label><input class="form-control" ng-model="record.numberDayOrderPendingExpire" ng-change="changeStatus.markAsChanged()" fcsa-number="{ min: 0, maxDecimals: 0}" required></div></div><!--<div class="col-xs-12">--><!--<div class="form-group">--><!--<label> {{ \'system.config.import.customer.template\' | translate }} * </label>--><!--<single-file--><!--ng-model="record.importCustomerTemplate"--><!--ng-change="changeStatus.markAsChanged()"--><!--accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"--><!--required>--><!--</single-file>--><!--</div>--><!--</div>--><!--<div class="col-xs-12">--><!--<div class="form-group">--><!--<label> {{ \'system.config.import.product.template\' | translate }} * </label>--><!--<single-file--><!--ng-model="record.importProductTemplate"--><!--ng-change="changeStatus.markAsChanged()"--><!--accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"--><!--required>--><!--</single-file>--><!--</div>--><!--</div>--><div class="col-xs-12"><label>{{ \'system.config.default.location\' | translate }} *</label><location-selector ng-model="record.location" ng-change="changeStatus.markAsChanged()" required></location-selector></div></div></div></div></form></section></category-detail>'),$templateCache.put("views/business/survey/survey-detail.html",'<category-detail class="survey" ng-class="{ \'detail-mode\': isDetailMode() }"><section id="survey-header" class="panel panel-default wrapper"><form name="form"><div class="row"><div class="col-xs-12"><div class="form-group"><label>{{ \'name\' | translate }} *</label><input type="text" class="form-control" ng-model="record.name" ng-change="changeStatus.markAsChanged()" ng-readonly="!isDraft()" ng-maxlength="100" required autofocus></div></div><div class="col-sm-6"><div class="form-group"><label>{{ \'start.date\' | translate }} *</label><div class="input-group ui-datepicker w-full"><input type="text" class="form-control" datepicker-popup="{{ dateFormat }}" ng-model="startDate.date" ng-change="changeStatus.markAsChanged()" is-open="startDate.opened" datepicker-options="dateOptions" close-text="{{ \'close\' | translate }}" ng-readonly="!isDraft()" required> <span class="input-group-addon" ng-click="open($event, startDate)" ng-if="isDraft()"><i class="fa fa-calendar"></i></span></div></div></div><div class="col-sm-6"><div class="form-group"><label>{{ \'end.date\' | translate }} *</label><div class="input-group ui-datepicker w-full"><input type="text" class="form-control" datepicker-popup="{{ dateFormat }}" ng-model="endDate.date" ng-change="changeStatus.markAsChanged()" is-open="endDate.opened" datepicker-options="dateOptions" close-text="{{ \'close\' | translate }}" ng-readonly="!isDraft()" required> <span class="input-group-addon" ng-click="open($event, endDate)" ng-if="isDraft()"><i class="fa fa-calendar"></i></span></div></div></div><div class="col-xs-12"><button class="btn btn-primary btn-sm" ng-click="addNewQuestion()" ng-if="isDraft()"><span class="fa fa-plus"></span> <strong>{{ \'survey.add.question\' | translate }}</strong></button><label ng-if="!isDraft()">{{ \'survey.question\' | translate }}</label><table class="table questions" ng-class="{ \'ng-invalid\': !hasQuestion() }"><tbody><tr ng-if="!hasQuestion()"><td class="text-danger"><strong>{{ \'survey.no.question\' | translate }}</strong></td></tr><tr ng-repeat="question in record.questions"><td><strong>{{ question.name }}</strong><ol><li ng-repeat="option in question.options">{{ option.name }}</li></ol></td><td class="text-right no-padder col-action" ng-if="isDraft()"><button class="btn" ng-click="removeQuestion($index)"><span class="fa fa-lg fa-remove text-danger"></span></button> <button class="btn" ng-click="editQuestion($index)"><span class="fa fa-lg fa-pencil text-info"></span></button></td></tr></tbody></table></div></div></form></section><!--EDITING PANEL--><div id="survey-detail"><div class="row title-bar"><div class="col-xs-7"><h3>{{ \'survey.question\' | translate }}</h3></div><div class="col-xs-5 title-btn-bar"><button class="btn btn-warning" ng-click="exitDetailMode()"><span class="fa fa-arrow-left"></span></button> <button class="btn btn-primary" ng-click="applyEdit()"><span class="fa fa-check"></span></button></div></div><section class="panel panel-default wrapper"><form name="form2"><div class="row"><div class="col-xs-12"><div class="form-group"><label>{{ \'name\' | translate }} *</label><input type="text" class="form-control" ng-model="currentEdit.question.name" ng-maxlength="100" required></div></div><div class="col-xs-12 m-b"><label>{{ \'survey.multiple.choice\' | translate }}:&nbsp</label><i-check ng-model="currentEdit.question.multipleChoice"></i-check></div><div class="col-xs-12"><button class="btn btn-primary btn-sm" ng-click="addNewOption()"><span class="fa fa-plus"></span> <strong>{{ \'survey.add.option\' | translate }}</strong></button><table class="table options" ng-class="{ \'ng-invalid\': !hasOption() }"><tbody><tr ng-if="!hasOption()"><td class="text-danger"><strong>{{ \'survey.no.option\' | translate }}</strong></td></tr><tr ng-repeat="option in currentEdit.question.options"><td><div class="input-group"><input type="text" class="form-control" ng-model="option.name" ng-maxlength="100" required> <span class="input-group-btn"><button class="btn btn-danger" type="button" ng-click="removeOption(option)"><i class="fa fa-remove"></i></button></span></div></td></tr></tbody></table></div></div></form></section></div></category-detail>'),$templateCache.put("views/business/system/calendar-config.html",'<category-detail class="calendar-config no-back no-enable"><section class="panel panel-default wrapper"><form name="form"><div class="row"><div class="col-sm-6"><table class="table table-bordered table-responsive table-middle"><thead><tr><th colspan="2">{{ \'calendar.config.working.days\' | translate }}</th></tr></thead><tbody><tr><td>{{ \'monday\' | translate }}</td><td class="col-checkbox"><i-check ng-model="record.monday" ng-change="changeStatus.markAsChanged()"></i-check></td></tr><tr><td>{{ \'tuesday\' | translate }}</td><td class="col-checkbox"><i-check ng-model="record.tuesday" ng-change="changeStatus.markAsChanged()"></i-check></td></tr><tr><td>{{ \'wednesday\' | translate }}</td><td class="col-checkbox"><i-check ng-model="record.wednesday" ng-change="changeStatus.markAsChanged()"></i-check></td></tr><tr><td>{{ \'thursday\' | translate }}</td><td class="col-checkbox"><i-check ng-model="record.thursday" ng-change="changeStatus.markAsChanged()"></i-check></td></tr><tr><td>{{ \'friday\' | translate }}</td><td class="col-checkbox"><i-check ng-model="record.friday" ng-change="changeStatus.markAsChanged()"></i-check></td></tr><tr><td>{{ \'saturday\' | translate }}</td><td class="col-checkbox"><i-check ng-model="record.saturday" ng-change="changeStatus.markAsChanged()"></i-check></td></tr><tr><td>{{ \'sunday\' | translate }}</td><td class="col-checkbox"><i-check ng-model="record.sunday" ng-change="changeStatus.markAsChanged()"></i-check></td></tr></tbody></table></div><div class="col-sm-6"><table class="table table-bordered table-responsive table-middle"><thead><tr><th>{{ \'calendar.config.holidays\' | translate }}</th><th class="col-checkbox"><a href="javascript:void(0)" class="btn-icon btn-icon-xs btn-primary" ng-click="addHoliday()"><i class="fa fa-plus"></i></a></th></tr></thead><tbody><tr><td colspan="2" ng-if="holidaysEmpty()">{{ \'no.data\' | translate }}</td></tr><tr ng-repeat="holidayDate in record.holidayDates"><td><div class="input-group ui-datepicker"><input type="text" class="form-control" datepicker-popup="{{ dateFormat }}" ng-model="holidayDate.date" ng-change="changeStatus.markAsChanged()" is-open="holidayDate.opened" datepicker-options="dateOptions" close-text="{{ \'close\' | translate }}" required> <span class="input-group-addon" ng-click="open($event, holidayDate)"><i class="fa fa-calendar"></i></span></div></td><td><a href="javascript:void(0)" class="btn-icon btn-icon-xs btn-danger" ng-click="removeHoliday(holidayDate)"><i class="fa fa-remove"></i></a></td></tr></tbody></table></div></div></form></section></category-detail>'),$templateCache.put("views/business/system/client-action.html",'<basic-view><section class="panel panel-default wrapper"><form name="form"><div class="max-w-md margin-auto"><div class="row"><div class="col-xs-12"><button class="btn btn-primary w-full" ng-click="resetCache()">{{ \'reset.cache\' | translate }}</button></div></div></div></form></section></basic-view>'),$templateCache.put("views/business/system/client-config.html",'<category-detail class="no-back no-enable"><section class="panel panel-default wrapper"><form name="form"><div class="max-w-md margin-auto"><div class="row"><div class="col-xs-12"><div class="form-group"><label>{{ \'client.config.visit.duration.kpi.minute\' | translate }} *</label><input class="form-control" ng-model="record.visitDurationKPIinMinute" ng-change="changeStatus.markAsChanged()" fcsa-number="{ min: 1, maxDecimals: 0}" required autofocus></div></div><div class="col-xs-12"><div class="form-group"><label>{{ \'client.config.visit.distance.kpi.km\' | translate }} *</label><input class="form-control" ng-model="record.visitDistanceKPI" ng-change="changeStatus.markAsChanged()" fcsa-number="{ min: 0.01, maxDecimals: 2}" required></div></div><div class="col-xs-12"><div class="form-group"><label>{{ \'client.config.productivity.unit\' | translate }} *</label><input type="text" class="form-control" ng-model="record.productivityUnit" ng-change="changeStatus.markAsChanged()" required></div></div><div class="col-xs-12"><div class="form-group"><label>{{ \'client.config.can.edit.customer.location\' | translate }} *</label><div class="switch-form-control no-select"><label class="switch"><input type="checkbox" checked="checked" ng-model="record.canEditCustomerLocation" ng-change="changeStatus.markAsChanged()"> <i></i></label></div></div></div></div></div></form></section></category-detail>'),$templateCache.put("views/business/system/distributor-detail.html",'<category-detail><section class="panel panel-default wrapper"><form name="form"><div class="max-w-md margin-auto"><div class="row"><div class="col-xs-12"><div class="form-group"><label>{{ \'name\' | translate }} *</label><input type="text" class="form-control" ng-model="record.name" ng-change="changeStatus.markAsChanged()" ng-maxlength="30" ng-readonly="!isDraft()" required autofocus></div></div><div class="col-xs-12"><div class="form-group"><label>{{ \'supervisor\' | translate }} *</label><user-combobox ng-model="record.supervisorId" datas="supervisors" ng-change="changeStatus.markAsChanged()" readonly-name="record.supervisor.fullname" required></user-combobox></div></div></div></div></form></section></category-detail>'),$templateCache.put("views/business/system/user-detail.html",'<category-detail><section class="panel panel-default wrapper"><form name="form"><div class="max-w-md margin-auto"><div class="row"><div class="col-xs-12"><div class="form-group"><label>{{ \'role\' | translate }} *</label><name-category-combobox ng-model="record.role" datas="roles" ng-change="changeStatus.markAsChanged()" ng-readonly="!isDraft()" readonly-name="roleName" required></name-category-combobox></div></div><div class="col-xs-12"><div class="form-group"><label>{{ \'fullname\' | translate }} *</label><input type="text" class="form-control" ng-model="record.fullname" ng-change="changeStatus.markAsChanged()" ng-readonly="!isDraft()" ng-maxlength="50" required></div></div><div class="col-xs-12"><div class="form-group"><label>{{ \'username\' | translate }} *</label><div class="input-group"><span class="input-group-addon"><strong>{{ clientCode }}</strong></span> <input type="text" class="form-control" ng-model="record.username" ng-change="changeStatus.markAsChanged()" ng-readonly="!isDraft()" ng-maxlength="20" required></div></div></div><div class="col-xs-12"><div class="form-group" ng-if="useDistributor()"><label>{{ \'distributor\' | translate }} *</label><name-category-combobox ng-model="record.distributorId" datas="distributors" ng-change="changeStatus.markAsChanged()" ng-readonly="!isDraft()" readonly-name="record.distributor.name" required></name-category-combobox></div></div><div class="col-xs-12" ng-if="!isDraft()"><button class="btn btn-primary w-full" ng-click="resetPassword()">{{ \'reset.password\' | translate }}</button></div><div class="col-xs-12 m-t" ng-if="!isDraft() && record.role == \'OBS\'"><button class="btn btn-success w-full" ng-click="goToObserverDistributors()">{{ \'user.observer.distributors\' | translate }}</button></div></div></div></form></section></category-detail>'),$templateCache.put("views/business/system/user-observer-distributors.html",'<basic-view><div class="row title-bar"><div class="col-xs-6"><h3>{{ title | translate }}</h3></div><div class="col-xs-6 title-btn-bar"><button class="btn btn-warning" ng-click="back()"><span class="fa fa-arrow-left"></span></button> <button class="btn btn-info" ng-click="refresh()" ng-if="changeStatus.isChanged"><span class="fa fa-refresh"></span></button> <button class="btn btn-success" ng-click="save()" ng-if="changeStatus.isChanged"><span class="fa fa-save"></span></button></div></div><!--<div class="row no-margin" style="border-left: 1px solid black; border-top: 1px solid black; background: #f3f3f3;">--><!--<div class="col-lg-3 no-padder" ng-repeat="record in records"--><!--style="border-right: 1px solid black; border-bottom: 1px solid black">--><!--<div class="wrapper-sm">--><!--{{ record.name }}--><!--<i-check class="pull-right" ng-model="record.selected" ng-change="changeStatus.markAsChanged()"></i-check>--><!--</div>--><!--</div>--><!--</div>--><section class="panel panel-default table-dynamic"><!--FILTER--><div class="wrapper-sm"><div class="row"><div class="col-xs-12"><search-box ng-model="searchText" placeholder="{{ \'search\' | translate }}"></search-box></div></div></div></section><div><div class="row" style="margin-left: -5px; margin-right: -5px" ng-if="!lessThan20()"><div class="col-sm-6 col-xs-12" ng-class="{\'col-lg-3 col-md-4\': moreThan20()}" style="padding-left: 5px; padding-right: 5px" ng-repeat="record in records | propsFilter: {name: searchText}"><section class="panel panel-default" style="margin-bottom: 10px"><div class="wrapper-sm">{{ record.name }}<i-check class="pull-right" ng-model="record.selected" ng-change="changeStatus.markAsChanged()"></i-check></div></section></div></div></div></basic-view>'),$templateCache.put("views/business/system/user.html",'<basic-view><div class="category-list"><!--HEADER--><div class="row title-bar"><div class="col-xs-6"><h3>{{ title | translate }}</h3></div><div class="col-xs-6 title-btn-bar"><button type="button" class="btn btn-info" ng-click="refresh()"><span class="fa fa-refresh"></span></button> <button type="button" class="btn btn-primary" ng-click="createRecord()"><span class="fa fa-plus"></span></button></div></div><section class="panel panel-default table-dynamic"><!--FILTER--><div class="wrapper-sm no-padder-bottom"><div class="row"><div class="col-sm-6 col-xs-12 m-b-sm"><label>{{ \'role\' | translate }}</label><name-category-combobox ng-model="filter.role" datas="roles" ng-change="roleFilterChange()"></name-category-combobox></div><div class="col-sm-6 col-xs-12 m-b-sm"><div class="w-full wrapper-sm m-b-xs hidden-xs"></div><search-box ng-model="filter.searchText" ng-change="searchFilterChange()" placeholder="{{ \'search\' | translate }}"></search-box></div><div class="col-sm-6 col-xs-12 m-b-sm" ng-show="isUseDistributorFilter()"><label>{{ \'distributor\' | translate }}</label><name-category-combobox ng-model="filter.distributorId" datas="distributors" ng-change="distributorFilterChange()"></name-category-combobox></div></div></div><!--TABLE--><table class="table table-middle table-border-top"><thead class="hidden-xs"><tr><th ng-repeat="column in columns">{{ column.header | translate }}</th><th class="col-action"></th></tr></thead><tbody><!--HAS DATA--><tr ng-repeat="record in records"><!--XS SCREEN--><td class="col-data visible-xs" ng-class="{\'strike\': !record.active}"><div><strong>{{ getPropertyValue(columns[0], record) }}</strong></div><div ng-repeat="column in columns" ng-if="$index > 0">{{ getPropertyValue(column, record) }}</div></td><!--SM MD LG SCREEN--><td ng-repeat="column in columns" class="col-data hidden-xs" ng-class="{\'strike\': !record.active}"><div class="text-ellipsis">{{ getPropertyValue(column, record) }}</div></td><!--ACTION ON GRID--><td class="text-right no-padder col-action"><button class="btn" ng-click="deleteRecord(record)" ng-disabled="!record.draft" ng-if="useDeleteButton" confirm="{{ \'confirm.dialog.are.you.sure.delete\' | translate }}" confirm-title="{{ \'confirm.dialog.title\' | translate }}" confirm-ok="{{ \'confirm.dialog.ok\' | translate }}" confirm-cancel="{{ \'confirm.dialog.cancel\' | translate }}" confirm-settings="{ size: \'sm\' }"><span class="fa fa-lg fa-remove text-danger"></span></button> <button class="btn" ng-click="enableRecord(record)" ng-disabled="!record.draft" ng-if="useEnableButton" confirm="{{ \'confirm.dialog.are.you.sure.enable\' | translate }}" confirm-title="{{ \'confirm.dialog.title\' | translate }}" confirm-ok="{{ \'confirm.dialog.ok\' | translate }}" confirm-cancel="{{ \'confirm.dialog.cancel\' | translate }}" confirm-settings="{ size: \'sm\' }"><span class="fa fa-lg fa-check text-primary"></span></button> <button class="btn" ng-click="changeActiveState(record)" ng-disabled="record.draft" ng-if="useActivateButton"><span class="fa fa-lg text-warning" ng-class="record.active ? \'fa-check-square-o\' : \'fa-square-o\'"></span></button> <button class="btn" ng-click="editRecord(record)" ng-disabled="!record.active"><span class="fa fa-lg fa-pencil text-info"></span></button></td></tr><!--NO DATA--><tr ng-if="isEmpty()"><td colspan="{{ 2 + columns.length }}">{{ \'no.data\' | translate }}</td></tr></tbody></table><!--PAGING--><div class="wrapper-sm pagination-container"><div class="row"><div class="col-xs-12"><hr class="m-b-sm m-t-none m-l-n-sm m-r-n-sm"></div><div class="col-xs-12 text-right"><pagination class="pagination pagination-sm pagination-right m-n" boundary-links="true" total-items="pagingData.count" max-size="pagingData.pagingMaxSize" items-per-page="pagingData.itemsPerPage" ng-model="pagingData.currentPage" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" ng-change="pageChange()"></pagination></div></div></div></section></div></basic-view>'),$templateCache.put("views/business/target/target-detail.html",'<basic-view><div class="category-detail page-profile max-w-md margin-auto" ng-class="{ \'new\': isNew(), \'edit\': isEdit(), \'draft\': isDraft(), \'changed\': isChanged() }"><div class="row title-bar"><div class="col-xs-6"><h3>{{ title | translate }}</h3></div><div class="col-xs-6 title-btn-bar"><button id="back" class="btn btn-warning" ng-click="back()"><span class="fa fa-arrow-left"></span></button> <button id="refresh" class="btn btn-info" ng-click="refresh()"><span class="fa fa-refresh"></span></button> <button id="enable" class="btn btn-primary" ng-click="enable()"><span class="fa fa-check"></span></button> <button id="save" class="btn btn-success" ng-click="save()"><span class="fa fa-save"></span></button></div></div><form name="form"><div class="row"><div class="col-lg-12"><div class="panel panel-profile"><div class="panel-heading text-center bg-info"><h3 class="ng-binding">{{ \'salesman\' | translate }}:&nbsp;{{ record.salesman.fullname }}</h3><p>{{ \'month\' | translate }}:&nbsp;{{ getMonthDisplay() }}</p></div><div class="wrapper-sm"><div class="form-group"><label>{{ \'revenue\' | translate }} *</label><input class="form-control" ng-model="record.revenue" ng-change="changeStatus.markAsChanged()" fcsa-number="{ min: 0, maxDecimals: 0}" required></div><div class="form-group"><label>{{ \'productivity\' | translate }}&nbsp;({{ getProductivityUnit() }}) *</label><input class="form-control" ng-model="record.productivity" ng-change="changeStatus.markAsChanged()" fcsa-number="{ min: 0, maxDecimals: 0}" required></div><!--<div class="form-group">--><!--<label> {{ \'quantity\' | translate }} * </label>--><!--<input class="form-control" ng-model="record.quantity"--><!--ng-change="changeStatus.markAsChanged()"--><!--fcsa-number="{ min: 0, maxDecimals: 0}"--><!--required/>--><!--</div>--><div class="form-group"><label>{{ \'order\' | translate }} *</label><input class="form-control" ng-model="record.nbOrder" ng-change="changeStatus.markAsChanged()" fcsa-number="{ min: 0, maxDecimals: 0}" required></div><div class="form-group"><label>{{ \'revenue.by.order\' | translate }} *</label><input class="form-control" ng-model="record.revenueByOrder" ng-change="changeStatus.markAsChanged()" fcsa-number="{ min: 0, maxDecimals: 0}" required></div><div class="form-group"><label>{{ \'sku.by.order\' | translate }} *</label><input class="form-control" ng-model="record.skuByOrder" ng-change="changeStatus.markAsChanged()" fcsa-number="{ min: 0, maxDecimals: 1}" required></div><div class="form-group"><label>{{ \'productivity.by.order\' | translate }}&nbsp;({{ getProductivityUnit() }}) *</label><input class="form-control" ng-model="record.productivityByOrder" ng-change="changeStatus.markAsChanged()" fcsa-number="{ min: 0, maxDecimals: 1}" required></div><div class="form-group"><label>{{ \'new.customer\' | translate }} *</label><input class="form-control" ng-model="record.newCustomer" ng-change="changeStatus.markAsChanged()" fcsa-number="{ min: 0, maxDecimals: 0}" required></div></div></div></div></div></form></div></basic-view>'),$templateCache.put("views/business/target/target.html",'<basic-view><div><div class="row title-bar"><div class="col-xs-9"><h3>{{ title | translate }}</h3></div><div class="col-xs-3 title-btn-bar"><button type="button" class="btn btn-info" ng-click="refresh()"><span class="fa fa-refresh"></span></button></div></div><section class="panel panel-default table-dynamic"><div class="wrapper-sm no-padder-bottom"><div class="row"><div class="col-sm-6 col-xs-12 m-b-sm"><label>{{ \'month\' | translate }}</label><div class="input-group ui-datepicker"><input type="text" class="form-control" datepicker-mode="\'month\'" datepicker-popup="MM-yyyy" ng-model="date.date" ng-change="dateChange()" is-open="date.opened" datepicker-options="{startingDay: 1 , minMode:\'month\'}" close-text="{{ \'close\' | translate }}" required> <span class="input-group-addon" ng-click="open($event, date)"><i class="fa fa-calendar"></i></span></div></div></div></div><table class="table table-middle table-border-top"><thead class="hidden-xs"><tr><th>{{ \'salesman\' | translate }}</th><th class="w-xs text-right">{{ \'revenue\' | translate }}</th><th class="w-xxs"></th></tr></thead><tbody><tr ng-repeat="record in records"><td>{{ record.salesman.fullname }}</td><td class="text-right">{{ record.revenue }}</td><td class="text-right no-padder col-action"><button class="btn" ng-click="goToDetail(record)"><span class="fa fa-2x fa-angle-right"></span></button></td></tr><tr ng-if="isEmpty()"><td colspan="{{ 2 + columns.length }}">{{ \'no.data\' | translate }}</td></tr></tbody></table></section></div></basic-view>'),$templateCache.put("views/business/van-sales/van-sales.html",'<basic-view><div class="row title-bar"><div class="col-xs-6"><h3>{{ title | translate }}</h3></div><div class="col-xs-6 title-btn-bar"><button class="btn btn-warning" ng-click="refresh()" ng-if="changeStatus.isChanged"><span class="fa fa-remove"></span></button> <button class="btn btn-success" ng-click="save()" ng-if="changeStatus.isChanged"><span class="fa fa-save"></span></button></div></div><section class="panel panel-default"><table class="table table-middle"><thead><tr><th>{{ \'fullname\' | translate }}</th><th>{{ \'username\' | translate }}</th><th class="text-right">{{ \'van.sales\' | translate }}</th></tr></thead><tbody><tr ng-repeat="record in records"><td>{{ record.fullname }}</td><td>{{ record.username }}</td><td class="text-right"><i-check ng-model="record.vanSales" ng-change="changeStatus.markAsChanged()"></i-check></td></tr></tbody></table></section></basic-view>'),$templateCache.put("views/business/visit-photo/visit-photo.html",'<basic-view class="visit-photo" ng-class="{ \'must-select-distributor\': mustSelectDistributor() }"><div class="row title-bar"><div class="col-xs-9"><h3>{{ title | translate }}</h3></div><div class="col-xs-3 title-btn-bar"><button type="button" class="btn btn-info" ng-click="refresh()"><span class="fa fa-refresh"></span></button></div></div><section class="panel panel-default table-dynamic"><div style="position: relative; padding: 10px 10px 0px 10px"><div class="row"><div class="col-md-6 col-sm-12 col-xs-12 m-b-sm" ng-show="isUseDistributorFilter()"><label>{{ \'distributor\' | translate }} *</label><name-category-combobox ng-model="filter.distributorId" datas="distributors" ng-change="changeDistributor()" placeholder="{{ \'please.select.distributor\' | translate }}" required></name-category-combobox></div><div class="col-md-3 col-sm-6 col-xs-12 m-b-sm"><label>{{ \'from.date\' | translate }} *</label><div class="input-group ui-datepicker"><input type="text" class="form-control" datepicker-popup="{{ dateFormat }}" ng-model="fromDate.date" is-open="fromDate.opened" datepicker-options="dateOptions" close-text="{{ \'close\' | translate }}" required> <span class="input-group-addon" ng-click="open($event, fromDate)"><i class="fa fa-calendar"></i></span></div></div><div class="col-md-3 col-sm-6 col-xs-12 m-b-sm"><label>{{ \'to.date\' | translate }} *</label><div class="input-group ui-datepicker"><input type="text" class="form-control" datepicker-popup="{{ dateFormat }}" ng-model="toDate.date" is-open="toDate.opened" datepicker-options="dateOptions" close-text="{{ \'close\' | translate }}" required> <span class="input-group-addon" ng-click="open($event, toDate)"><i class="fa fa-calendar"></i></span></div></div><div class="col-md-6 col-sm-12 col-xs-12 m-b-sm hide-when-must-select-distributor"><label>{{ \'salesman\' | translate }} *</label><user-combobox ng-model="filter.salesmanId" datas="salesmen" placeholder="{{ \'please.select.salesman\' | translate }}" required></user-combobox></div><div class="col-md-6 col-sm-12 col-xs-12 m-b-sm"><div style="width: 100%; height: 34px"></div></div></div><button class="btn btn-primary" style="position: absolute; bottom: 10px; right: 10px" ng-click="search()">{{ \'search\' | translate }}</button></div></section><section class="panel panel-default table-dynamic"><div class="row"><div class="col-xs-12"><div class="wrapper-sm" style="position: relative"><h5 ng-if="isEmpty()">{{\'no.data\' | translate }}</h5><button class="btn btn-success" style="position: absolute; top: 10px; right: 10px" ng-click="download()" ng-if="!isEmpty()"><span class="fa fa-download"></span> &nbsp;{{ \'download\' | translate }}</button><div ng-repeat="date in dates"><h4 class="m-l-sm m-r-sm">{{ date }}</h4><hr class="m-t-none m-b-none m-l-sm m-r-sm"><div class="visit-photo-thumbnail" ng-repeat="record in map[date]"><img alt ng-src="{{ getPhoto(record) }}"> <button type="button" class="btn" ng-click="zoomPhoto(record)"><span class="fa fa-3x fa-search-plus"></span></button><p class="text-ellipsis no-margin">{{ record.customer.name }}</p><a ng-href="{{ getVisitLink(record) }}" class="color-success">{{ \'detail\' | translate }}</a></div></div><div class="thumbnail-container"></div></div></div></div></section></basic-view>'),$templateCache.put("views/business/visit-today/visit-detail.html",'<basic-view class="visit-detail use-map"><div class="row title-bar"><div class="col-xs-9"><h3>{{ title | translate }}</h3></div><div class="col-xs-3 title-btn-bar"><button class="btn btn-warning" ng-click="back()"><span class="fa fa-arrow-left"></span></button></div></div><div class="row"><!--LEFT--><div class="col-lg-6"><div class="row"><!--CUSTOMER INFO--><div class="col-xs-12 customer-info"><div class="row"><div class="col-lg-12"><div class="panel panel-profile"><div class="panel-heading bg-primary clearfix"><h3>{{ record.customer.name }}</h3><p>{{ record.customer.code }}</p></div><div class="panel-body"><ul class="list-unstyled list-info"><li><span class="icon glyphicon glyphicon-tag"></span><label>{{ \'customer.type\' | translate }}</label>{{ record.customer.customerType.name }}</li><li><span class="icon glyphicon glyphicon-inbox"></span><label>{{ \'area\' | translate }}</label>{{ record.customer.area.name }}</li></ul></div></div></div></div></div><!--MAP--><div class="col-xs-12"><section class="panel panel-default"><div class="panel-heading"><strong><span class="glyphicon glyphicon-map-marker"></span> {{ \'map\' | translate }}</strong></div><div class="panel-body"><div ng-include=" \'map.html\' "></div></div></section></div></div></div><!--RIGHT--><div class="col-lg-6"><div class="row"><!--VISIT INFO--><div class="col-xs-12"><div class="panel panel-default visit-info"><div class="panel-heading"><strong><span class="glyphicon glyphicon-th"></span> {{ \'visit.detail.visit.info\' | translate }}</strong></div><ul class="list-group"><li class="list-group-item" ng-if="isClosed()"><span class="badge badge-danger" ng-if="isClosed()">{{ \'visit.status.closed\' | translate }}</span> <i class="fa fa-info"></i> {{ \'visit.status\' | translate }}</li><li class="list-group-item"><span class="badge">{{ record.salesman.fullname }}</span> <i class="fa fa-user"></i> {{ \'salesman\' | translate }}</li><!--TIME--><li class="list-group-item"><span class="badge" ng-class="{\'badge-warning\': record.errorDuration, \'badge-success\': !record.errorDuration }">{{ getTimeDisplay() }}</span> <i class="fa fa-clock-o"></i> {{ \'visit.time\' | translate }}</li><!--distance--><li class="list-group-item"><span class="badge" ng-class="{ \'badge-danger\': isErrorDistance(record), \'badge-success\': !isErrorDistance(record) }">{{ getDistanceDisplay() }}</span> <i class="fa fa-location-arrow"></i> {{ \'visit.distance\' | translate }}</li><!--order--><li class="list-group-item"><span class="badge" ng-class="{ \'badge-warning\': !record.hasOrder, \'badge-info\': record.hasOrder }">{{ getOrderDisplay() }}</span> <i class="fa fa-shopping-cart"></i> {{ \'order\' | translate }}</li></ul></div></div><div class="col-xs-12" ng-if="hasFeedback()"><div class="panel panel-default"><div class="panel-heading"><strong><span class="glyphicon glyphicon-comment"></span> {{ \'feedback\' | translate }}</strong></div><div class="panel-body"><div class="media" ng-repeat="feddback in record.feedbacks"><div class="media-body"><h4 class="media-heading">{{ \'#\' + ($index + 1) }}</h4><p>{{ feddback }}</p></div></div></div></div></div><div class="col-xs-12" ng-if="hasPhoto()"><div class="panel panel-default"><div class="panel-heading"><strong><span class="glyphicon glyphicon-camera"></span> {{ \'visit.photo\' | translate }}</strong></div><div class="panel-body"><div class="thumbnail"><img alt ng-src="{{ getPhoto() }}"></div></div></div></div></div></div></div><div class="row" ng-if="hasOrder()"><div class="col-lg-12"><div class="panel panel-default order-info"><div class="panel-heading"><div class="row"><div class="col-xs-9 title"><strong><span class="glyphicon glyphicon-shopping-cart"></span> {{ \'order\' | translate }}</strong></div><div class="col-xs-3 text-right"><button class="btn btn-dark" ng-click="printOrder()"><span class="fa fa-print"></span></button></div></div></div><div class="panel-body"><order id="order" data="record"></order></div></div></div></div></basic-view>'),
$templateCache.put("views/business/visit-today/visit-today-map.html",'<basic-view class="use-map" ng-class="{ \'must-select-distributor\': mustSelectDistributor() }"><div class="row title-bar"><div class="col-xs-9"><h3>{{ title | translate }}</h3></div><div class="col-xs-3 title-btn-bar"><button type="button" class="btn btn-info" ng-click="refresh()"><span class="fa fa-refresh"></span></button></div></div><section class="panel panel-default table-dynamic"><div class="wrapper-sm no-padder-bottom"><div class="row"><div class="col-sm-6 col-xs-12 m-b-sm"><label>{{ \'distributor\' | translate }}</label><name-category-combobox ng-model="filter.distributorId" datas="distributors" ng-change="distributorFilterChange()" ng-readonly="changeStatus.isChanged" placeholder="{{ \'please.select.distributor\' | translate }}"></name-category-combobox></div><div class="col-sm-6 col-xs-12 m-b-sm hide-when-must-select-distributor"><label>{{ \'salesman\' | translate }}</label><user-combobox ng-model="filter.salesmanId" datas="salesmen" ng-change="filterChange()" ng-readonly="changeStatus.isChanged" placeholder="{{ \'please.select.salesman\' | translate }}"></user-combobox></div></div></div><div ng-include=" \'map.html\' "></div></section></basic-view>'),$templateCache.put("views/business/visit-today/visit-today.html",'<basic-view class="visit-today" ng-class="{ \'must-select-distributor\': mustSelectDistributor() }"><div class="row title-bar"><div class="col-xs-9"><h3>{{ title | translate }}</h3></div><div class="col-xs-3 title-btn-bar"><button type="button" class="btn btn-info" ng-click="refresh()"><span class="fa fa-refresh"></span></button></div></div><div class="row hide-when-must-select-distributor"><div class="col-sm-4"><div class="panel mini-box"><span class="box-icon bg-success"><i class="fa fa-street-view"></i></span><div class="box-info"><p class="size-h2">{{ summary.visit.actual | number:0 }} &nbsp;/&nbsp; {{ summary.visit.plan | number:0 }}</p><p class="text-muted"><span class="ng-scope">{{ \'visit\' | translate }}</span></p></div></div></div><div class="col-sm-4"><div class="panel mini-box"><span class="box-icon bg-danger"><i class="fa fa-map-marker"></i></span><div class="box-info"><p class="size-h2">{{ summary.visitErrorPosition.actual | number:0 }}</p><p class="text-muted"><span class="ng-scope">{{ \'visit.error.position\' | translate }}</span></p></div></div></div><div class="col-sm-4"><div class="panel mini-box"><span class="box-icon bg-warning"><i class="fa fa-clock-o"></i></span><div class="box-info"><p class="size-h2">{{ summary.visitErrorDuration.actual | number:0 }}</p><p class="text-muted"><span class="ng-scope">{{ \'visit.error.duration\' | translate }}</span></p></div></div></div></div><section class="panel panel-default table-dynamic"><div class="wrapper-sm no-padder-bottom"><div class="row"><div class="col-sm-6 col-xs-12 m-b-sm"><label>{{ \'distributor\' | translate }}</label><name-category-combobox ng-model="filter.distributorId" datas="distributors" ng-change="distributorFilterChange()" ng-readonly="changeStatus.isChanged" placeholder="{{ \'please.select.distributor\' | translate }}"></name-category-combobox></div><div class="col-sm-6 col-xs-12 m-b-sm hide-when-must-select-distributor"><label>{{ \'salesman\' | translate }}</label><user-combobox ng-model="filter.salesmanId" datas="salesmen" ng-change="filterChange()" ng-readonly="changeStatus.isChanged"></user-combobox></div></div></div><table class="table table-middle hide-when-must-select-distributor"><thead class="hidden-xs"><tr><th>{{ \'customer\' | translate }}</th><th>{{ \'salesman\' | translate }}</th><th class="w-sm text-center">{{ \'visit.time\' | translate }}</th><th class="w-sm text-center">{{ \'visit.distance\' | translate }}</th><th class="w-sm text-center">{{ \'order\' | translate }}</th><th class="w-sm text-center">{{ \'visit.status\' | translate }}</th><th class="w-xxs"></th></tr></thead><tbody><tr ng-repeat="record in records"><td>{{ record.customer.name }}</td><td>{{ record.salesman.fullname }}</td><td class="text-center"><div><span class="color-success" ng-if="!record.errorDuration"><i class="fa fa-thumbs-up"></i></span> <span class="color-danger" ng-if="record.errorDuration"><i class="fa fa-warning"></i></span> {{ getDurationDisplay(record.duration) }}</div>{{ getStartEndDisplay(record) }}</td><td class="text-center"><div ng-if="isDistanceNormal(record) || isDistanceTooFar(record)"><span class="color-success" ng-if="isDistanceNormal(record)"><i class="fa fa-thumbs-up"></i></span> <span class="color-danger" ng-if="isDistanceTooFar(record)"><i class="fa fa-warning"></i></span> {{ getDistanceDisplay(record.distance) }}</div><span class="label label-danger" ng-if="isLocationSalesmanUndefined(record)">{{ \'visit.salesman.location.undefined\' | translate }}</span> <span class="label label-danger" ng-if="isLocationCustomerUndefined(record)">{{ \'visit.customer.location.undefined\' | translate }}</span></td><td class="text-center"><div class="has-distance" ng-if="!isNoOrder(record)"><span class="color-success" ng-if="isOrderApproved(record)"><i class="fa fa-check"></i></span> <span class="color-info" ng-if="isOrderPending(record)"><i class="fa fa-clock-o"></i></span> <span class="color-danger" ng-if="isOrderRejected(record)"><i class="fa fa-ban"></i></span> {{ record.grandTotal | number }}</div><span class="label label-warning" ng-if="isNoOrder(record)">{{ \'visit.no.order\' | translate }}</span></td><td class="text-center"><div class="status-container text-left"><img class="status-icon closed" src="images/visit-closed.svg" ng-if="record.closed"> <span class="status-icon color-success" ng-if="!record.closed && record.photo != null"><i class="fa fa-camera-retro"></i></span> <span class="status-icon color-primary" ng-if="record.vanSales"><i class="fa fa-truck"></i></span></div></td><td class="text-right no-padder col-action"><button class="btn" ng-click="goToDetail(record)"><span class="fa fa-2x fa-angle-right"></span></button></td></tr><tr ng-if="isEmpty()"><td colspan="6">{{ \'no.data\' | translate }}</td></tr></tbody></table><div class="wrapper-sm pagination-container hide-when-must-select-distributor"><div class="row"><div class="col-xs-12"><hr class="m-b-sm m-t-none m-l-n-sm m-r-n-sm"></div><div class="col-xs-12 text-right"><pagination class="pagination pagination-sm pagination-right m-n" boundary-links="true" total-items="pagingData.count" max-size="pagingData.pagingMaxSize" items-per-page="pagingData.itemsPerPage" ng-model="pagingData.currentPage" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" ng-change="pageChange()"></pagination></div></div></div></section></basic-view>'),$templateCache.put("views/common/bad-request.html",'<div class="wrapper-lg text-center"><img style="max-width: 100%" src="images/error-img.png" title="error"><h1>{{ \'error.occurred\' | translate }}</h1><button class="btn btn-w-md btn-gap-v btn-primary" ng-click="refresh()">{{ \'reload.data\' | translate }}</button></div>'),$templateCache.put("views/common/category-list.html",'<basic-view><div class="category-list"><!--HEADER--><div class="row title-bar"><div class="col-xs-6"><h3>{{ title | translate }}</h3></div><div class="col-xs-6 title-btn-bar"><button type="button" class="btn btn-info" ng-click="refresh()"><span class="fa fa-refresh"></span></button> <button type="button" class="btn btn-success" ng-if="isDisplayImportBtn()" ng-click="goToImport()"><span class="fa fa-file-excel-o"></span></button> <button type="button" class="btn btn-primary" ng-click="createRecord()"><span class="fa fa-plus"></span></button></div></div><section class="panel panel-default table-dynamic"><!--FILTER--><div class="wrapper-sm no-padder-bottom"><div class="row"><div class="col-sm-6 col-xs-12 m-b-sm" ng-show="isUseDistributorFilter()"><label>{{ \'distributor\' | translate }}</label><name-category-combobox ng-model="filter.distributorId" datas="distributors" ng-change="distributorFilterChange()"></name-category-combobox></div><div class="col-sm-6 col-xs-12 m-b-sm"><div class="w-full wrapper-xs m-t-xs hidden-xs" ng-show="isUseDistributorFilter()"></div><search-box ng-class="{\'m-t-sm\' : isUseDistributorFilter()}" ng-model="filter.searchText" ng-change="searchFilterChange()" placeholder="{{ \'search\' | translate }}"></search-box></div></div></div><!--TABLE--><table class="table table-middle table-border-top"><thead class="hidden-xs"><tr><th ng-repeat="column in columns">{{ column.header | translate }}</th><th class="col-action"></th></tr></thead><tbody><!--HAS DATA--><tr ng-repeat="record in records"><!--XS SCREEN--><td class="col-data visible-xs" ng-class="{\'strike\': !record.active}"><div><strong>{{ getPropertyValue(columns[0], record) }}</strong></div><div ng-repeat="column in columns" ng-if="$index > 0">{{ getPropertyValue(column, record) }}</div></td><!--SM MD LG SCREEN--><td ng-repeat="column in columns" class="col-data hidden-xs" ng-class="{\'strike\': !record.active}"><div class="text-ellipsis">{{ getPropertyValue(column, record) }}</div></td><!--ACTION ON GRID--><td class="text-right no-padder col-action"><button class="btn" ng-click="deleteRecord(record)" ng-disabled="!record.draft" ng-if="useDeleteButton" confirm="{{ \'confirm.dialog.are.you.sure.delete\' | translate }}" confirm-title="{{ \'confirm.dialog.title\' | translate }}" confirm-ok="{{ \'confirm.dialog.ok\' | translate }}" confirm-cancel="{{ \'confirm.dialog.cancel\' | translate }}" confirm-settings="{ size: \'sm\' }"><span class="fa fa-lg fa-remove text-danger"></span></button> <button class="btn" ng-click="enableRecord(record)" ng-disabled="!record.draft" ng-if="useEnableButton" confirm="{{ \'confirm.dialog.are.you.sure.enable\' | translate }}" confirm-title="{{ \'confirm.dialog.title\' | translate }}" confirm-ok="{{ \'confirm.dialog.ok\' | translate }}" confirm-cancel="{{ \'confirm.dialog.cancel\' | translate }}" confirm-settings="{ size: \'sm\' }"><span class="fa fa-lg fa-check text-primary"></span></button> <button class="btn" ng-click="changeActiveState(record)" ng-disabled="record.draft" ng-if="useActivateButton"><span class="fa fa-lg text-warning" ng-class="record.active ? \'fa-check-square-o\' : \'fa-square-o\'"></span></button> <button class="btn" ng-click="editRecord(record)" ng-disabled="!record.active"><span class="fa fa-lg fa-pencil text-info"></span></button></td></tr><!--NO DATA--><tr ng-if="isEmpty()"><td colspan="{{ 2 + columns.length }}">{{ \'no.data\' | translate }}</td></tr></tbody></table><!--PAGING--><div class="wrapper-sm pagination-container"><div class="row"><div class="col-xs-12"><hr class="m-b-sm m-t-none m-l-n-sm m-r-n-sm"></div><div class="col-xs-12 text-right"><pagination class="pagination pagination-sm pagination-right m-n" boundary-links="true" total-items="pagingData.count" max-size="pagingData.pagingMaxSize" items-per-page="pagingData.itemsPerPage" ng-model="pagingData.currentPage" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" ng-change="pageChange()"></pagination></div></div></div></section></div></basic-view>'),$templateCache.put("views/common/category-popup.html",'<div class="modal-header"><h3 class="modal-title">{{ title | translate }}</h3></div><div class="modal-body"><form name="form"><div class="form-group" ng-if="isUseDistributorFilter()"><label>{{ \'distributor\' | translate }}</label><name-category-combobox ng-model="record.distributorId" datas="distributors" ng-change="changeStatus.markAsChanged()" ng-readonly="!isDraft()" readonly-name="record.distributor.name" required></name-category-combobox></div><div class="form-group"><label>{{ \'name\' | translate }}</label><input type="text" class="form-control" ng-model="record.name" ng-change="changeStatus.markAsChanged()" ng-maxlength="30" required autofocus ng-readonly="!isDraft()"></div><div class="form-group" ng-if="useCode"><label>{{ \'code\' | translate }}</label><input type="text" class="form-control" ng-model="record.code" ng-change="changeStatus.markAsChanged()" ng-maxlength="10" ng-pattern="/^\\S+$/" required ng-readonly="!isDraft()"></div></form></div><div class="modal-footer"><button class="btn btn-primary" ng-click="enable()" ng-if="(isDraft() && isEdit()) || (isNew() && changeStatus.isChanged)"><span class="fa fa-check"></span></button> <button class="btn btn-success" ng-click="save()" ng-if="isDraft() && changeStatus.isChanged"><span class="fa fa-save"></span></button> <button class="btn btn-warning" ng-click="cancel()"><span class="fa fa-close"></span></button></div>'),$templateCache.put("views/common/photo-popup.html",'<div class="photo-popup"><div class="modal-body pos-rlt"><button class="background-button" ng-click="cancel()"></button><div class="photo-container"><img alt ng-src="{{ photoLink }}"> <button class="close-btn btn btn-primary" ng-click="cancel()"></button></div></div><div class="modal-footer" ng-if="isDisplayFooter()"><p class="modal-title" ng-if="isDisplayTitle()">{{ title }}</p><p class="no no-margin" ng-if="isDisplaySubTitle()">{{ subTitle }}</p></div></div>'),$templateCache.put("views/directive/basic-view.html",'<div class="page basic-view" ng-class="{ \'empty\': isEmpty(), \'one-page\': isOnePage() }"><div id="basic-view-error" ng-if="isError()" ng-include="\'views/common/bad-request.html\'"></div><div id="basic-view-loading" ng-if="isLoading()"><div class="loader"></div></div><div id="basic-view-content"><ng-transclude></ng-transclude></div></div>'),$templateCache.put("views/directive/category-detail.html",'<basic-view ng-class="{ \'use-map\': useMap }"><div class="category-detail" ng-class="{ \'new\': isNew(), \'edit\': isEdit(), \'draft\': isDraft(), \'changed\': isChanged() }"><div class="row title-bar"><div class="col-xs-6"><h3>{{ title | translate }}</h3></div><div class="col-xs-6 title-btn-bar"><button id="back" class="btn btn-warning" ng-click="back()"><span class="fa fa-arrow-left"></span></button> <button id="refresh" class="btn btn-info" ng-click="refresh()"><span class="fa fa-refresh"></span></button> <button id="enable" class="btn btn-primary" ng-click="enable()"><span class="fa fa-check"></span></button> <button id="save" class="btn btn-success" ng-click="save()"><span class="fa fa-save"></span></button></div></div><ng-transclude></ng-transclude></div></basic-view>'),$templateCache.put("views/directive/i-check.html",'<div class="icheckbox" ng-class="{\'checked\': isChecked()}"><button ng-click="click()" ng-disabled="ngDisabled"></button></div>'),$templateCache.put("views/directive/location-selector.html",'<div class="location-selector"><div class="row m-b-xs"><div class="col-sm-6 col-xs-12"><div class="input-group w-full"><span class="input-group-addon w-xs">{{ \'latitude\' | translate }}</span><div class="form-control">{{ location.latitude }}</div></div></div><div class="col-sm-6 col-xs-12"><div class="input-group w-full"><span class="input-group-addon w-xs">{{ \'longitude\' | translate }}</span><div class="form-control">{{ location.longitude }}</div></div></div></div><div class="row"><div class="col-sm-12"><div ng-include=" \'map.html\' "></div></div></div></div>'),$templateCache.put("views/directive/name-category-combobox.html",'<div class="name-category-combobox"><ui-select class="" ng-model="container.selectedId" on-select="onSelect($item, $model)"><ui-select-match placeholder="{{ getPlaceholder() }}">{{ $select.selected.name }}</ui-select-match><ui-select-choices repeat="data.id as data in datas | filter: { name: $select.search }"><div>{{ data.name }}</div></ui-select-choices></ui-select><div class="form-control name-category-combobox-readonly" readonly="readonly">{{ getReadonlyName() }}</div></div>'),$templateCache.put("views/directive/name-code-category-combobox.html",'<div class="name-category-combobox"><ui-select class="" ng-model="container.selectedId" on-select="onSelect($item, $model)"><ui-select-match placeholder="{{ getPlaceholder() }}">{{ $select.selected.name }}</ui-select-match><ui-select-choices repeat="data.id as data in datas | propsFilter: { name: $select.search, code: $select.search }"><div>{{ data.name }}</div><small>{{ data.code }}</small></ui-select-choices></ui-select><div class="form-control name-category-combobox-readonly" readonly="readonly">{{ getReadonlyName() }}</div></div>'),$templateCache.put("views/directive/order.html",'<div class="order"><div class="row"><div class="col-xs-6"><p class="size-h2 m-n">DMS PLUS</p><p class="text-muted m-n">Viettel ICT</p></div><div class="col-xs-6 text-right"><p class="size-h2 m-n">{{ data.code }}</p><p class="text-muted m-n">{{ data.createdTime | isoDateTime }}</p></div></div><hr><div class="row"><div class="col-xs-6"><div class="text-left inline"><strong>{{ \'distributor\' | translate }}:</strong> &nbsp;<br><strong>{{ \'customer\' | translate }}:</strong> &nbsp;<br></div><div class="text-left inline">{{ data.distributor.name }}<br>{{ data.customer.name }}<br></div></div><div class="col-xs-6 text-right"><div class="text-left inline"><strong>{{ \'salesman\' | translate }}:</strong> &nbsp;<br><strong>{{ \'order.delivery\' | translate }}:</strong> &nbsp;<br></div><div class="text-left inline">{{ data.createdBy.fullname }}<br>{{ getDeliveryDisplay() }}<br></div></div></div><div class="divider divider-md"></div><table class="table table-bordered table-striped order-detail"><thead><tr class="bg-dark"><th class="text-center index">#</th><th class="text-center product-code">{{ \'code\' | translate }}</th><th class="product-name">{{ \'product\' | translate }}</th><th class="text-center uom">{{ \'uom.short\' | translate }}</th><th class="text-center product-price">{{ \'product.price\' | translate }}</th><th class="text-center quantity">{{ \'quantity\' | translate }}</th><th class="text-center amount">{{ \'order.amount\' | translate }}</th></tr></thead><tbody><tr ng-repeat="detail in data.details"><td class="text-center">{{ $index + 1 }}</td><td class="text-center">{{ detail.product.code }}</td><td>{{ detail.product.name }}</td><td class="text-center">{{ detail.product.uom.name }}</td><td class="text-center">{{ detail.product.price | number }}</td><td class="text-center">{{ detail.quantity | number }}</td><td class="text-right">{{ detail.amount | number }}</td></tr></tbody></table><div class="row"><div class="col-xs-6"><div ng-if="hasPromotion()"><p class="size-h3">{{ \'promotion\' | translate }}</p><ul><li ng-repeat="promotionProductReward in getPromotionProductRewards() track by $index">{{ promotionProductReward.product.name }} x {{ promotionProductReward.quantity }}</li></ul></div></div><div class="col-xs-4 order-sum text-right"><ul class="list-unstyled"><li>{{ \'order.subtotal\' | translate }}:</li><li>{{ \'promotion\' | translate }}:</li><li>{{ \'order.discount\' | translate }}:</li><li><strong>{{ \'order.grand.total\' | translate }}:</strong></li></ul></div><div class="col-xs-2 order-sum text-right"><ul class="list-unstyled"><li>{{ data.subTotal | number }}</li><li>{{ data.promotionAmt | number }}</li><li>{{ data.discountAmt | number }}</li><li><strong>{{ data.grandTotal | number }}</strong></li></ul></div></div></div>'),$templateCache.put("views/directive/search-box.html",'<div class="input-group"><input type="text" ng-disabled="ngDisabled" ng-class="{\'form-control\':textChanged(), \'form-control input-danger\':!textChanged()}" ng-model="searchText" enter-pressed="onEnter()" ng-blur="onBlur()" placeholder="{{ placeholder }}"> <span class="input-group-btn"><button class="btn btn-primary" type="button" ng-click="performSearch()" ng-if="textChanged()" ng-disabled="ngDisabled"><i class="fa fa-search"></i></button> <button class="btn btn-danger" type="button" ng-click="clearText()" ng-if="!textChanged()" ng-disabled="ngDisabled"><i class="fa fa-close"></i></button></span></div>'),$templateCache.put("views/directive/single-file.html",'<div class="single-file"><div class="input-group"><div class="form-control file-name-wrapper">{{ getFileName() }}</div><span class="input-group-btn"><div class="btn btn-primary"><span class="fa fa-paperclip"></span></div></span></div><input type="file" nv-file-select="" uploader="uploader" ng-attr-accept="{{ getAccepts() }}"></div>'),$templateCache.put("views/directive/single-image.html",'<div class="single-image"><div ng-if="getFile() == null"><span class="fa fa-camera"></span></div><div ng-if="getFile() != null"><img ng-src="{{ getLink() }}"></div><div class="hover-layer"><span class="fa fa-paperclip"></span> <input type="file" nv-file-select="" uploader="uploader"></div></div>'),$templateCache.put("views/directive/user-combobox.html",'<div class="name-category-combobox"><ui-select class="" ng-model="container.selectedId" on-select="onSelect($item, $model)"><ui-select-match placeholder="{{ getPlaceholder() }}">{{ $select.selected.fullname }}</ui-select-match><ui-select-choices repeat="data.id as data in datas | filter: { fullname: $select.search }"><div>{{ data.fullname }}</div></ui-select-choices></ui-select><div class="form-control name-category-combobox-readonly" readonly="readonly">{{ getReadonlyName() }}</div></div>'),$templateCache.put("views/pages/404-bk.html",'<div class="page-err"><div class="err-container"><div class="text-center"><div class="err-status"><h1>404</h1></div><div class="err-message"><h2>Page not found</h2></div><div class="err-body"><a href="#/" class="btn btn-lg btn-goback"><span class="glyphicon glyphicon-home"></span> <span class="space"></span> Go Back to Home Page</a></div></div></div><div class="footer text-center">Copyright 2014 {{main.brand}}</div></div>'),$templateCache.put("views/pages/404.html",'<div class="error-page"><div id="container"><div class="overlay"></div><div class="item-title"><div id="message"><p>ERROR 404</p><p>NOT FOUND</p><p>You may have mis-typed the URL.</p><p>Or the page has been removed.</p><p>Actually, there is nothing to see here...</p><p>Click on the links below to do something, Thanks!</p></div><div class="link-bottom"><a class="link-icon" href="#/"><i class="fa fa-home"></i> Home</a> <a class="link-icon" href="mailto:someone@example.com"><i class="fa fa-envelope"></i> Write us</a></div></div></div></div>'),$templateCache.put("views/pages/500-bk.html",'<div class="page-err"><div class="err-container"><div class="text-center"><div class="err-status"><h1>500</h1></div><div class="err-message"><h2>Server goes wrong</h2></div><div class="err-body"><a href="#/" class="btn btn-lg btn-goback"><span class="glyphicon glyphicon-home"></span> <span class="space"></span> Go Back to Home Page</a></div></div></div><div class="footer text-center">Copyright 2014 {{main.brand}}</div></div>'),$templateCache.put("views/pages/500.html",'<div class="error-page"><div id="container"><div class="overlay"></div><div class="item-title"><div id="message"><p>ERROR 500</p><p>INTERNAL SERVER ERROR</p><p>Something went wrong.</p><p>An unexpected error occurred.</p><p>And your request couldn\'t be handled...</p><p>Click on the links below to do something, Thanks!</p></div><div class="link-bottom"><a class="link-icon" href="#/"><i class="fa fa-home"></i> Home</a> <a class="link-icon" href="mailto:someone@example.com"><i class="fa fa-envelope"></i> Write us</a></div></div></div></div>'),$templateCache.put("views/pages/550-bk.html",'<div class="page-err"><div class="err-container"><div class="text-center"><div class="err-status"><h1>550</h1></div><div class="err-message"><h2>{{ \'permission.denied\' | translate }}</h2></div><div class="err-body"><button class="btn btn-lg btn-goback" ng-click="logout()"><span class="glyphicon glyphicon-log-out"></span> <span class="space"></span> {{ \'logout\' | translate }}</button></div></div></div><div class="footer text-center">Copyright 2014 {{main.brand}}</div></div>'),$templateCache.put("views/pages/550.html",'<div class="error-page"><div id="container"><div class="overlay"></div><div class="item-title"><div id="message"><p>ERROR 550</p><p>PERMISSION DENIED</p><p>Access is denied.</p><p>You do not have permission to view this page.</p><p>Click on the links below to do something, Thanks!</p></div><div class="link-bottom"><a class="link-icon" href="#/"><i class="fa fa-home"></i> Home</a> <a class="link-icon" href="mailto:someone@example.com"><i class="fa fa-envelope"></i> Write us</a> <a class="link-icon" href="javascript:;" ng-click="logout()"><i class="fa fa-sign-out"></i> Logout</a></div></div></div></div>'),$templateCache.put("views/system/change-password.html",'<basic-view class="customer-approval use-map"><div><div class="row title-bar"><div class="col-xs-8"><h3>{{ \'change.password.title\' | translate }}</h3></div></div><div class="row"><div class="col-lg-12"><section class="panel panel-default"><div class="panel-body"><form name="form"><div style="max-width: 400px; margin: auto"><div class="row"><div class="col-sm-12"><div class="form-group"><label>{{ \'change.password.old.password\' | translate }} *</label><input type="password" class="form-control" ng-model="record.oldPassword" ng-trim="false" required autofocus></div></div><div class="col-sm-12"><div class="form-group"><label>{{ \'change.password.new.password.1\' | translate }} *</label><input type="password" class="form-control" ng-model="record.newPassword" ng-maxlength="30" ng-minlength="6" required autofocus></div></div><div class="col-sm-12"><div class="form-group"><label>{{ \'change.password.new.password.2\' | translate }} *</label><input type="password" class="form-control" ng-model="record.newPassword2" compare-to="record.newPassword" ng-maxlength="30" ng-minlength="6" required></div></div><div class="col-sm-12"><button type="button" class="btn btn-success pull-right" ng-click="save()"><span class="fa fa-save"></span> {{ \'save\' | translate }}</button></div></div></div></form></div></section></div></div></div></basic-view>'),$templateCache.put("views/system/logged-out-dialog.html","<div class=\"modal-header\"><h3>{{ 'ng-idle.timed-out' | translate }}</h3></div><div class=\"modal-body\"><p>{{ 'ng-idle.redirecting' | translate }}</p></div>"),$templateCache.put("views/system/logout-warning-dialog.html",'<div class="modal-header"><h3>{{ \'ng-idle.do-something\' | translate }}</h3></div><div class="modal-body"><progressbar max="max" value="countdown" animate="true" class="progress-striped active">{{ \'ng-idle.countdown\' | translate:{\'countdown\': countdown} }}</progressbar></div>')}]);